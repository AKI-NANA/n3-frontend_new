承知いたしました。Geminiが先行して作成したHTS階層システム再構築のためのSQLとスクリプト骨子、および分類キーワード自動生成ツールのスクリプトとスキーマを統合し、Claudeに一連の作業を依頼する最終的な開発指示書を作成します。この指示書は、データ基盤の修復とAI分類精度の向上という2つの重要な目標を達成するためのものです。💻 Claudeへの最終統合指示書（HTS基盤再構築とキーワード生成）1. 🎯 依頼の目的とスコープあなたは、以下の2つの主要タスクをプロジェクトに統合・実装します。HTS階層データ基盤の修復と日本語対応: HTS階層テーブル（4種）のデータ整合性を確保し、日本語検索・表示を可能にします。分類キーワード自動生成ツールの実装: 高性能LLM（Gemini）を活用し、関税分類の検出精度を向上させるためのキーワードDBを構築します。2. 📂 ファイルの格納と適用（最優先）以下のファイルをプロジェクトに格納し、必要なマイグレーションを実行してください。ファイルパス修正/新規目的database/migrations/005_add_hts_japanese_descriptions.sql🆕 新規HTSテーブル全てに日本語カラムを追加します。→ すぐにDBに適用してください。database/migrations/006_create_keyword_to_hs_code.sql🆕 新規キーワード格納用テーブル（keyword_to_hs_code）を作成します。→ すぐにDBに適用してください。lib/hts/htsUtils.ts🆕 新規HTSコードパース、日英説明文取得ヘルパーロジックを追加します。scripts/hts/translateDescriptions.ts🆕 新規翻訳用のデータ抽出・インポートスクリプトの骨子です。scripts/generateKeywords.ts🆕 新規LLMキーワード自動生成ツールのコアスクリプト骨子です。app/api/hts/search/route.ts🔄 修正日英両対応の検索ロジックを統合します。3. 🛠️ HTSデータ基盤の修復と日本語対応HTS階層データが不完全であることを前提として、データ全面再構築から開始します。A. 🔴 HTSデータの全面再インポートの実行（最重要）データソースの入手: USITCなどの信頼できるソースから、関税率データを含む完全なHTS階層データを入手してください。インポートスクリプトの作成: scripts/hts/reimportHtsData.tsのような新規スクリプトを作成し、以下の手順で階層的インポートロジックを完成させ、実行してください。lib/hts/htsUtils.tsのparseHTSCodeを利用し、HTSコードを解析。Chapters $\to$ Headings $\to$ Subheadings $\to$ Detailsの順序で、外部キー（ID）を参照しながらDBにデータを挿入します。インポート後、関税率データがhts_codes_detailsテーブルに正しく格納されていることを確認してください。B. 🇯🇵 日本語翻訳データの実行と反映翻訳CSVの生成と翻訳: scripts/hts/translateDescriptions.tsのexportForTranslation関数を利用して英語説明文を抽出し、Claude DesktopまたはLLM APIで日本語翻訳を実行します。翻訳結果の反映: scripts/hts/translateDescriptions.tsのimportTranslations関数を利用し、翻訳結果をDBの**description_jaカラムにバッチ更新**してください。C. 🖥️ UI/ロジックの統合UI言語切り替え: HTS選定モーダル等に言語切り替えボタンを実装し、lib/hts/htsUtils.tsのgetDescription関数を通じて、日本語データが優先的に表示されるようにUIロジックを統合します。検索機能の統合: /api/hts/search/route.tsのロジックをUIの検索インプットに連携し、日本語キーワードでの検索を可能にします。4. 🤖 分類キーワード自動生成ツールの実装ファイルパス: scripts/generateKeywords.tsA. 実行準備とインプット取得環境変数: 実行前に、GEMINI_API_KEYとSUPABASE_SERVICE_ROLE_KEYを環境変数に設定してください。DBインプットの取得: スクリプト内のdummyHsData部分を、hts_codes_subheadingsテーブルから全件取得した4,000件以上の6桁HSコードリスト（hs_code, description_ja, description_enを含む）に置き換えてください。B. ツールの実行非同期処理の管理: processAllHsCodes関数を実行し、MAX_CONCURRENT_REQUESTSと指数バックオフメカニズムが正しく機能していることを確認しながら、全てのHSコードに対してLLM APIリクエストを実行してください。データ格納: 処理完了後に出力されたSQL INSERTファイル（またはCSV）の内容を確認し、keyword_to_hs_codeテーブルにデータを挿入（またはCOPYコマンドでインポート）してください。⚠️ 最終検証全ての作業完了後、以下のテストケースがパスすることを確認してください。データ整合性: Chapter 95（玩具）を辿ると、Full Codeまで全ての階層が正しく表示され、関税率が表示されること。日本語検索: 「おもちゃ」や「集積回路」といった日本語キーワードでHTSコードがヒットすること。キーワードDB: keyword_to_hs_codeテーブルに、4,000件以上のHSコードに対応する日本語/英語のキーワードが格納されていること。