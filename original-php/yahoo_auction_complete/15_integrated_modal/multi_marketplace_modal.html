<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>複数モール統合編集システム</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #667eea;
            --secondary: #764ba2;
            --success: #28a745;
            --warning: #ffc107;
            --error: #dc3545;
            --info: #17a2b8;
            --background: #f8f9fa;
            --card-bg: rgba(255, 255, 255, 0.95);
            --text-primary: #2c3e50;
            --text-secondary: #6c757d;
            --border-color: #dee2e6;
            --border-radius: 12px;
            --shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
            
            /* モール別カラー */
            --ebay-color: #0064d2;
            --shopee-color: #ee4d2d;
            --shopify-color: #95bf47;
            --coupang-color: #ff6600;
            --amazon-color: #ff9900;
            --amazon-jp-color: #232f3e;
            
            /* データ状態色 */
            --data-complete: #28a745;
            --data-partial: #ffc107;
            --data-missing: #dc3545;
            --data-processing: #17a2b8;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            min-height: 100vh;
            padding: 20px;
        }

        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
            color: white;
        }

        .demo-button {
            background: white;
            color: var(--primary);
            padding: 1rem 2rem;
            border: none;
            border-radius: 8px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            margin: 0.5rem;
        }

        .demo-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 25px rgba(0, 0, 0, 0.15);
        }

        /* モーダルスタイル */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            backdrop-filter: blur(5px);
            z-index: 10000;
        }

        .modal-content {
            position: relative;
            width: 98%;
            height: 98%;
            max-width: 1900px;
            margin: 1% auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .modal-header {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 70px;
            flex-shrink: 0;
        }

        .modal-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin: 0;
        }

        .product-info {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .product-thumbnail {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }

        .modal-close {
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem;
            cursor: pointer;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.3s ease;
        }

        .modal-close:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .modal-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* モール選択ヘッダー */
        .marketplace-selector {
            background: #f8f9fa;
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            flex-shrink: 0;
            overflow-x: auto;
        }

        .marketplace-btn {
            padding: 0.5rem 1rem;
            border: 2px solid transparent;
            background: white;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.85rem;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .marketplace-btn.ebay { border-color: var(--ebay-color); color: var(--ebay-color); }
        .marketplace-btn.shopee { border-color: var(--shopee-color); color: var(--shopee-color); }
        .marketplace-btn.shopify { border-color: var(--shopify-color); color: var(--shopify-color); }
        .marketplace-btn.coupang { border-color: var(--coupang-color); color: var(--coupang-color); }
        .marketplace-btn.amazon { border-color: var(--amazon-color); color: var(--amazon-color); }
        .marketplace-btn.amazon-jp { border-color: var(--amazon-jp-color); color: var(--amazon-jp-color); }

        .marketplace-btn.active.ebay { background: var(--ebay-color); color: white; }
        .marketplace-btn.active.shopee { background: var(--shopee-color); color: white; }
        .marketplace-btn.active.shopify { background: var(--shopify-color); color: white; }
        .marketplace-btn.active.coupang { background: var(--coupang-color); color: white; }
        .marketplace-btn.active.amazon { background: var(--amazon-color); color: white; }
        .marketplace-btn.active.amazon-jp { background: var(--amazon-jp-color); color: white; }

        .marketplace-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* タブナビゲーション */
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid var(--border-color);
            overflow-x: auto;
            flex-shrink: 0;
        }

        .tab-link {
            padding: 0.75rem 1rem;
            text-decoration: none;
            color: var(--text-secondary);
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            font-weight: 500;
            white-space: nowrap;
            cursor: pointer;
            font-size: 0.85rem;
            min-width: 100px;
            text-align: center;
        }

        .tab-link:hover {
            color: var(--primary);
            background: rgba(102, 126, 234, 0.1);
        }

        .tab-link.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
            background: white;
        }

        .tab-content-container {
            flex: 1;
            overflow: hidden;
        }

        .tab-pane {
            display: none;
            height: 100%;
            overflow-y: auto;
            padding: 1.5rem;
        }

        .tab-pane.active {
            display: block;
        }

        /* ステータスカードシステム */
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .status-card {
            background: white;
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            border-left: 4px solid var(--primary);
            transition: transform 0.3s ease;
        }

        .status-card:hover {
            transform: translateY(-2px);
        }

        .status-card.complete { border-left-color: var(--data-complete); }
        .status-card.partial { border-left-color: var(--data-partial); }
        .status-card.missing { border-left-color: var(--data-missing); }
        .status-card.processing { border-left-color: var(--data-processing); }

        .status-card h4 {
            font-size: 0.9rem;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .status-value {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .status-indicator {
            padding: 0.2rem 0.5rem;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .indicator-complete { background: #d4edda; color: #155724; }
        .indicator-partial { background: #fff3cd; color: #856404; }
        .indicator-missing { background: #f8d7da; color: #721c24; }
        .indicator-processing { background: #d1ecf1; color: #0c5460; }

        /* データ表示システム */
        .data-section {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1rem;
        }

        .section-header {
            font-size: 1rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 0.4rem 0;
            border-bottom: 1px solid #e9ecef;
        }

        .data-row:last-child {
            border-bottom: none;
        }

        .data-label {
            font-weight: 500;
            color: var(--text-secondary);
            font-size: 0.85rem;
        }

        .data-value {
            font-weight: 600;
            color: var(--text-primary);
            font-size: 0.85rem;
        }

        /* フォーム要素 */
        .form-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .form-row {
            margin-bottom: 1rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 0.4rem;
            font-size: 0.85rem;
        }

        .form-input, .form-textarea, .form-select {
            width: 100%;
            padding: 0.6rem;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            font-size: 0.85rem;
            transition: border-color 0.3s ease;
        }

        .form-input:focus, .form-textarea:focus, .form-select:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .char-counter {
            font-size: 0.75rem;
            color: var(--text-secondary);
            text-align: right;
            margin-top: 0.25rem;
        }

        /* 画像管理 */
        .images-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 1rem;
        }

        .image-item {
            position: relative;
            background: white;
            border-radius: 6px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .image-item:hover {
            transform: scale(1.05);
        }

        .image-item.selected {
            border-color: var(--success);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

        .image-item img {
            width: 100%;
            height: 80px;
            object-fit: cover;
        }

        .image-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.8));
            color: white;
            padding: 0.25rem;
            font-size: 0.7rem;
            text-align: center;
        }

        /* モール固有フィールド */
        .marketplace-fields {
            display: none;
        }

        .marketplace-fields.active {
            display: block;
        }

        .marketplace-header {
            background: white;
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border: 2px solid #e9ecef;
        }

        .marketplace-header.ebay { border-color: var(--ebay-color); }
        .marketplace-header.shopee { border-color: var(--shopee-color); }
        .marketplace-header.shopify { border-color: var(--shopify-color); }
        .marketplace-header.coupang { border-color: var(--coupang-color); }
        .marketplace-header.amazon { border-color: var(--amazon-color); }
        .marketplace-header.amazon-jp { border-color: var(--amazon-jp-color); }

        /* Shopee国選択 */
        .shopee-countries {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .country-btn {
            padding: 0.4rem 0.8rem;
            border: 1px solid var(--shopee-color);
            background: white;
            color: var(--shopee-color);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.8rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .country-btn.active {
            background: var(--shopee-color);
            color: white;
        }

        /* フッター */
        .modal-footer {
            background: #f8f9fa;
            padding: 1rem 2rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 1rem;
            flex-wrap: wrap;
            flex-shrink: 0;
        }

        .btn {
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.4rem;
            font-size: 0.85rem;
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: var(--text-primary);
        }

        .btn-secondary {
            background: var(--text-secondary);
            color: white;
        }

        .btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        /* 未実装バッジ */
        .not-implemented {
            position: relative;
        }

        .not-implemented::after {
            content: '未実装';
            position: absolute;
            top: -8px;
            right: -8px;
            background: var(--warning);
            color: var(--text-primary);
            font-size: 0.6rem;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            font-weight: 600;
        }

        /* レスポンシブ対応 */
        @media (max-width: 1400px) {
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .status-grid {
                grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            }
        }

        @media (max-width: 768px) {
            .modal-content {
                width: 99%;
                height: 99%;
                margin: 0.5% auto;
            }
            
            .marketplace-selector {
                padding: 0.5rem;
            }
            
            .marketplace-btn {
                padding: 0.4rem 0.8rem;
                font-size: 0.75rem;
            }
            
            .tabs {
                font-size: 0.75rem;
            }
            
            .tab-link {
                min-width: 80px;
                padding: 0.5rem;
            }
            
            .status-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="demo-container">
        <h1><i class="fas fa-globe"></i> 複数モール統合編集システム</h1>
        <p style="margin: 1rem 0;">eBay, Shopee, Shopify, Coupang, Amazon対応</p>
        <button class="demo-button" onclick="openMultiMarketplaceModal()">
            <i class="fas fa-rocket"></i> 統合モーダルを開く
        </button>
    </div>

    <!-- 複数モール対応統合モーダル -->
    <div id="multi-marketplace-modal" class="modal-overlay">
        <div class="modal-content">
            <header class="modal-header">
                <div class="product-info">
                    <img src="https://placehold.co/50x50/667eea/ffffff?text=商品" alt="商品" class="product-thumbnail">
                    <div>
                        <h2 class="modal-title">
                            <i class="fas fa-edit"></i> ポケモンカード ピカチュウ プロモ 限定版
                        </h2>
                        <small>ID: yahoo_123456 | 取得日: 2025-01-15</small>
                    </div>
                </div>
                <button class="modal-close" onclick="closeMultiMarketplaceModal()">&times;</button>
            </header>

            <div class="modal-body">
                <!-- モール選択ヘッダー -->
                <div class="marketplace-selector">
                    <label style="font-weight: 600; color: var(--text-primary);">出品モール:</label>
                    <div class="marketplace-btn ebay active" onclick="switchMarketplace('ebay')">
                        <i class="fab fa-ebay"></i> eBay
                    </div>
                    <div class="marketplace-btn shopee not-implemented" onclick="switchMarketplace('shopee')">
                        <i class="fas fa-shopping-bag"></i> Shopee
                    </div>
                    <div class="marketplace-btn shopify not-implemented" onclick="switchMarketplace('shopify')">
                        <i class="fab fa-shopify"></i> Shopify
                    </div>
                    <div class="marketplace-btn coupang not-implemented" onclick="switchMarketplace('coupang')">
                        <i class="fas fa-store"></i> Coupang
                    </div>
                    <div class="marketplace-btn amazon not-implemented" onclick="switchMarketplace('amazon')">
                        <i class="fab fa-amazon"></i> Amazon海外
                    </div>
                    <div class="marketplace-btn amazon-jp not-implemented" onclick="switchMarketplace('amazon-jp')">
                        <i class="fab fa-amazon"></i> Amazon日本
                    </div>
                </div>

                <!-- タブナビゲーション -->
                <nav class="tabs">
                    <div class="tab-link active" onclick="switchTab(event, 'tab-overview')">
                        <i class="fas fa-chart-pie"></i><br>統合概要
                    </div>
                    <div class="tab-link" onclick="switchTab(event, 'tab-basic')">
                        <i class="fas fa-edit"></i><br>基本情報
                    </div>
                    <div class="tab-link" onclick="switchTab(event, 'tab-images')">
                        <i class="fas fa-images"></i><br>画像管理
                    </div>
                    <div class="tab-link" onclick="switchTab(event, 'tab-marketplace')">
                        <i class="fas fa-store"></i><br>モール設定
                    </div>
                    <div class="tab-link" onclick="switchTab(event, 'tab-pricing')">
                        <i class="fas fa-yen-sign"></i><br>価格・利益
                    </div>
                    <div class="tab-link" onclick="switchTab(event, 'tab-shipping')">
                        <i class="fas fa-shipping-fast"></i><br>送料・配送
                    </div>
                    <div class="tab-link" onclick="switchTab(event, 'tab-final')">
                        <i class="fas fa-check-circle"></i><br>最終確認
                    </div>
                </nav>

                <div class="tab-content-container">
                    <!-- 統合概要タブ -->
                    <section id="tab-overview" class="tab-pane active">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">
                            <i class="fas fa-dashboard"></i> 全モール統合状況
                        </h3>
                        
                        <div class="status-grid">
                            <div class="status-card complete">
                                <h4><i class="fas fa-database"></i> 基本データ</h4>
                                <div class="status-value" style="color: var(--data-complete);">完了</div>
                                <div class="status-indicator indicator-complete">取得済み</div>
                            </div>
                            
                            <div class="status-card complete">
                                <h4><i class="fas fa-images"></i> 画像</h4>
                                <div class="status-value" style="color: var(--data-complete);">8枚</div>
                                <div class="status-indicator indicator-complete">高品質</div>
                            </div>
                            
                            <div class="status-card partial">
                                <h4><i class="fab fa-ebay"></i> eBay</h4>
                                <div class="status-value" style="color: var(--data-complete);">準備完了</div>
                                <div class="status-indicator indicator-complete">実装済み</div>
                            </div>
                            
                            <div class="status-card missing">
                                <h4><i class="fas fa-shopping-bag"></i> Shopee</h4>
                                <div class="status-value" style="color: var(--data-missing);">未対応</div>
                                <div class="status-indicator indicator-missing">開発予定</div>
                            </div>
                            
                            <div class="status-card missing">
                                <h4><i class="fab fa-shopify"></i> Shopify</h4>
                                <div class="status-value" style="color: var(--data-missing);">未対応</div>
                                <div class="status-indicator indicator-missing">開発予定</div>
                            </div>
                            
                            <div class="status-card missing">
                                <h4><i class="fas fa-store"></i> Coupang</h4>
                                <div class="status-value" style="color: var(--data-missing);">未対応</div>
                                <div class="status-indicator indicator-missing">開発予定</div>
                            </div>
                            
                            <div class="status-card missing">
                                <h4><i class="fab fa-amazon"></i> Amazon</h4>
                                <div class="status-value" style="color: var(--data-missing);">未対応</div>
                                <div class="status-indicator indicator-missing">開発予定</div>
                            </div>
                        </div>

                        <!-- 対応状況詳細 -->
                        <div class="data-section">
                            <div class="section-header">
                                <i class="fas fa-info-circle"></i> モール別対応状況
                            </div>
                            
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                <div>
                                    <div class="data-row">
                                        <span class="data-label">eBay</span>
                                        <span class="data-value" style="color: var(--data-complete);">✓ 実装完了</span>
                                    </div>
                                    <div class="data-row">
                                        <span class="data-label">Shopee (SG)</span>
                                        <span class="data-value" style="color: var(--data-missing);">× 未実装</span>
                                    </div>
                                    <div class="data-row">
                                        <span class="data-label">Shopee (MY)</span>
                                        <span class="data-value" style="color: var(--data-missing);">× 未実装</span>
                                    </div>
                                    <div class="data-row">
                                        <span class="data-label">Shopee (TH)</span>
                                        <span class="data-value" style="color: var(--data-missing);">× 未実装</span>
                                    </div>
                                </div>
                                <div>
                                    <div class="data-row">
                                        <span class="data-label">Shopify</span>
                                        <span class="data-value" style="color: var(--data-missing);">× 未実装</span>
                                    </div>
                                    <div class="data-row">
                                        <span class="data-label">Coupang</span>
                                        <span class="data-value" style="color: var(--data-missing);">× 未実装</span>
                                    </div>
                                    <div class="data-row">
                                        <span class="data-label">Amazon海外</span>
                                        <span class="data-value" style="color: var(--data-missing);">× 未実装</span>
                                    </div>
                                    <div class="data-row">
                                        <span class="data-label">Amazon日本</span>
                                        <span class="data-value" style="color: var(--data-missing);">× 未実装</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- 基本情報編集タブ -->
                    <section id="tab-basic" class="tab-pane">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">
                            <i class="fas fa-edit"></i> 基本情報編集（全モール共通）
                        </h3>
                        
                        <div class="form-grid">
                            <div>
                                <div class="form-row">
                                    <label class="form-label">商品名（日本語）</label>
                                    <input type="text" class="form-input" value="ポケモンカード ピカチュウ プロモ 限定版">
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">商品名（英語）</label>
                                    <input type="text" class="form-input" value="Pokemon Card Pikachu Promo Limited Edition">
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">商品状態</label>
                                    <select class="form-select">
                                        <option value="new">新品</option>
                                        <option value="like_new">ほぼ新品</option>
                                        <option value="very_good" selected>とても良い</option>
                                        <option value="good">良い</option>
                                        <option value="acceptable">可</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div>
                                <div class="form-row">
                                    <label class="form-label">基本価格（円）</label>
                                    <input type="number" class="form-input" value="3500" step="1">
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">商品カテゴリー</label>
                                    <select class="form-select">
                                        <option>ホビー・玩具</option>
                                        <option selected>トレーディングカード</option>
                                        <option>コレクション</option>
                                    </select>
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">在庫数</label>
                                    <input type="number" class="form-input" value="1" min="1">
                                </div>
                            </div>
                        </div>

                        <!-- 商品詳細 -->
                        <div class="data-section">
                            <div class="section-header">
                                <i class="fas fa-clipboard-list"></i> 商品詳細情報
                            </div>
                            
                            <div class="form-row">
                                <label class="form-label">商品説明（日本語）</label>
                                <textarea class="form-textarea" rows="4">ポケモンカードのピカチュウプロモカードです。状態は良好で、コレクションとしてお楽しみいただけます。</textarea>
                            </div>
                            
                            <div class="form-row">
                                <label class="form-label">商品説明（英語）</label>
                                <textarea class="form-textarea" rows="4">Pokemon Card Pikachu Promo card. Good condition, perfect for collectors.</textarea>
                            </div>
                        </div>
                    </section>

                    <!-- 画像管理タブ -->
                    <section id="tab-images" class="tab-pane">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">
                            <i class="fas fa-images"></i> 画像管理（全モール共通）
                        </h3>
                        
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                            <div>
                                <h4 style="margin-bottom: 0.5rem;">Yahoo取得画像 (8枚)</h4>
                                <div class="images-grid" id="source-images">
                                    <div class="image-item" onclick="toggleImageSelection(this, 1)">
                                        <img src="https://placehold.co/100x80/4CAF50/ffffff?text=Main" alt="メイン画像">
                                        <div class="image-overlay">メイン画像<br>クリックで選択</div>
                                    </div>
                                    <div class="image-item" onclick="toggleImageSelection(this, 2)">
                                        <img src="https://placehold.co/100x80/2196F3/ffffff?text=Back" alt="裏面">
                                        <div class="image-overlay">裏面<br>クリックで選択</div>
                                    </div>
                                    <div class="image-item" onclick="toggleImageSelection(this, 3)">
                                        <img src="https://placehold.co/100x80/FF9800/ffffff?text=Side" alt="側面">
                                        <div class="image-overlay">側面<br>クリックで選択</div>
                                    </div>
                                    <div class="image-item" onclick="toggleImageSelection(this, 4)">
                                        <img src="https://placehold.co/100x80/9C27B0/ffffff?text=Detail" alt="詳細">
                                        <div class="image-overlay">詳細<br>クリックで選択</div>
                                    </div>
                                    <div class="image-item" onclick="toggleImageSelection(this, 5)">
                                        <img src="https://placehold.co/100x80/F44336/ffffff?text=Corner" alt="角">
                                        <div class="image-overlay">角の状態<br>クリックで選択</div>
                                    </div>
                                    <div class="image-item" onclick="toggleImageSelection(this, 6)">
                                        <img src="https://placehold.co/100x80/607D8B/ffffff?text=Cert" alt="認証">
                                        <div class="image-overlay">認証マーク<br>クリックで選択</div>
                                    </div>
                                    <div class="image-item" onclick="toggleImageSelection(this, 7)">
                                        <img src="https://placehold.co/100x80/795548/ffffff?text=Pack" alt="パッケージ">
                                        <div class="image-overlay">パッケージ<br>クリックで選択</div>
                                    </div>
                                    <div class="image-item" onclick="toggleImageSelection(this, 8)">
                                        <img src="https://placehold.co/100x80/009688/ffffff?text=Size" alt="サイズ比較">
                                        <div class="image-overlay">サイズ比較<br>クリックで選択</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div>
                                <h4 style="margin-bottom: 0.5rem;">選択済み画像 (<span id="selected-count">0</span>枚)</h4>
                                <div class="images-grid" id="selected-images">
                                    <div style="height: 80px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); border: 2px dashed var(--border-color); border-radius: 6px;">
                                        画像を選択してください
                                    </div>
                                </div>
                                
                                <div style="margin-top: 1rem; padding: 1rem; background: #f8f9fa; border-radius: 6px;">
                                    <h5 style="margin-bottom: 0.5rem;">画像最適化設定</h5>
                                    <label style="display: block; margin-bottom: 0.5rem;">
                                        <input type="checkbox" checked> 各モール推奨サイズに自動リサイズ
                                    </label>
                                    <label style="display: block; margin-bottom: 0.5rem;">
                                        <input type="checkbox" checked> 品質最適化（ファイルサイズ削減）
                                    </label>
                                    <label style="display: block;">
                                        <input type="checkbox"> ウォーターマーク追加
                                    </label>
                                </div>
                                
                                <div style="margin-top: 1rem;">
                                    <button class="btn btn-primary" onclick="selectAllImages()">
                                        <i class="fas fa-check-double"></i> 全選択
                                    </button>
                                    <button class="btn btn-secondary" onclick="clearAllImages()">
                                        <i class="fas fa-times"></i> 全クリア
                                    </button>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- モール設定タブ -->
                    <section id="tab-marketplace" class="tab-pane">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">
                            <i class="fas fa-store"></i> モール固有設定
                        </h3>

                        <!-- eBay設定 -->
                        <div class="marketplace-fields ebay active">
                            <div class="marketplace-header ebay">
                                <h4 style="margin: 0; display: flex; align-items: center; gap: 0.5rem; color: var(--ebay-color);">
                                    <i class="fab fa-ebay"></i> eBay出品設定
                                </h4>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-row">
                                    <label class="form-label">eBayタイトル (80文字以内)</label>
                                    <textarea class="form-textarea" maxlength="80" oninput="updateCharCounter(this, 'ebay-title-counter')">Pokemon Card Pikachu Promo Limited Edition Near Mint Japanese</textarea>
                                    <div class="char-counter" id="ebay-title-counter">65/80</div>
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">eBayカテゴリー</label>
                                    <select class="form-select">
                                        <option value="11116">Toys & Hobbies > Games > Trading Card Games</option>
                                        <option value="183454" selected>Toys & Hobbies > Games > Trading Card Games > Pokémon</option>
                                        <option value="2622">Toys & Hobbies > TV & Movie Character Toys</option>
                                    </select>
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">商品状態 (eBay)</label>
                                    <select class="form-select">
                                        <option value="1000">New</option>
                                        <option value="2500">Like New</option>
                                        <option value="3000" selected>Very Good</option>
                                        <option value="4000">Good</option>
                                        <option value="5000">Acceptable</option>
                                    </select>
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">販売価格 (USD)</label>
                                    <input type="number" class="form-input" value="32.99" step="0.01">
                                </div>
                            </div>
                        </div>

                        <!-- Shopee設定 -->
                        <div class="marketplace-fields shopee">
                            <div class="marketplace-header shopee">
                                <h4 style="margin: 0; display: flex; align-items: center; gap: 0.5rem; color: var(--shopee-color);">
                                    <i class="fas fa-shopping-bag"></i> Shopee出品設定 (未実装)
                                </h4>
                            </div>
                            
                            <div class="shopee-countries">
                                <div class="country-btn active" onclick="toggleShopeeCountry(this, 'SG')">シンガポール</div>
                                <div class="country-btn" onclick="toggleShopeeCountry(this, 'MY')">マレーシア</div>
                                <div class="country-btn" onclick="toggleShopeeCountry(this, 'TH')">タイ</div>
                                <div class="country-btn" onclick="toggleShopeeCountry(this, 'ID')">インドネシア</div>
                                <div class="country-btn" onclick="toggleShopeeCountry(this, 'VN')">ベトナム</div>
                                <div class="country-btn" onclick="toggleShopeeCountry(this, 'PH')">フィリピン</div>
                                <div class="country-btn" onclick="toggleShopeeCountry(this, 'TW')">台湾</div>
                            </div>
                            
                            <div class="form-grid">
                                <div class="form-row">
                                    <label class="form-label">Shopeeタイトル</label>
                                    <input type="text" class="form-input" value="Pokemon Card Pikachu Promo Limited Edition" disabled>
                                </div>
                                
                                <div class="form-row">
                                    <label class="form-label">販売価格 (現地通貨)</label>
                                    <input type="number" class="form-input" value="0" disabled>
                                </div>
                            </div>
                        </div>

                        <!-- 他のモール設定も同様に追加 -->
                        <div class="marketplace-fields shopify">
                            <div class="marketplace-header shopify">
                                <h4 style="margin: 0; display: flex; align-items: center; gap: 0.5rem; color: var(--shopify-color);">
                                    <i class="fab fa-shopify"></i> Shopify出品設定 (未実装)
                                </h4>
                            </div>
                            <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Shopifyとの連携機能は開発中です</p>
                        </div>

                        <div class="marketplace-fields coupang">
                            <div class="marketplace-header coupang">
                                <h4 style="margin: 0; display: flex; align-items: center; gap: 0.5rem; color: var(--coupang-color);">
                                    <i class="fas fa-store"></i> Coupang出品設定 (未実装)
                                </h4>
                            </div>
                            <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Coupangとの連携機能は開発中です</p>
                        </div>

                        <div class="marketplace-fields amazon">
                            <div class="marketplace-header amazon">
                                <h4 style="margin: 0; display: flex; align-items: center; gap: 0.5rem; color: var(--amazon-color);">
                                    <i class="fab fa-amazon"></i> Amazon海外出品設定 (未実装)
                                </h4>
                            </div>
                            <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Amazon海外との連携機能は開発中です</p>
                        </div>

                        <div class="marketplace-fields amazon-jp">
                            <div class="marketplace-header amazon-jp">
                                <h4 style="margin: 0; display: flex; align-items: center; gap: 0.5rem; color: var(--amazon-jp-color);">
                                    <i class="fab fa-amazon"></i> Amazon日本出品設定 (未実装)
                                </h4>
                            </div>
                            <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Amazon日本との連携機能は開発中です</p>
                        </div>
                    </section>

                    <!-- 価格・利益タブ -->
                    <section id="tab-pricing" class="tab-pane">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">
                            <i class="fas fa-calculator"></i> 価格戦略・利益計算
                        </h3>
                        
                        <div id="pricing-content">
                            <!-- eBay利益計算 -->
                            <div class="marketplace-pricing ebay active">
                                <div class="data-section">
                                    <div class="section-header">
                                        <i class="fab fa-ebay"></i> eBay利益計算
                                    </div>
                                    
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                        <div>
                                            <div class="data-row">
                                                <span class="data-label">Yahoo購入価格</span>
                                                <span class="data-value">¥3,500</span>
                                            </div>
                                            <div class="data-row">
                                                <span class="data-label">国内送料</span>
                                                <span class="data-value">¥500</span>
                                            </div>
                                            <div class="data-row">
                                                <span class="data-label">梱包・手数料</span>
                                                <span class="data-value">¥200</span>
                                            </div>
                                            <div class="data-row" style="border-top: 2px solid var(--border-color); font-weight: 600;">
                                                <span class="data-label">総コスト</span>
                                                <span class="data-value">¥4,200</span>
                                            </div>
                                        </div>
                                        <div>
                                            <div class="data-row">
                                                <span class="data-label">eBay販売価格</span>
                                                <span class="data-value">$32.99 (¥4,948)</span>
                                            </div>
                                            <div class="data-row">
                                                <span class="data-label">eBay手数料</span>
                                                <span class="data-value">-$4.37 (-¥656)</span>
                                            </div>
                                            <div class="data-row">
                                                <span class="data-label">PayPal手数料</span>
                                                <span class="data-value">-$1.15 (-¥173)</span>
                                            </div>
                                            <div class="data-row" style="border-top: 2px solid var(--border-color); font-weight: 600; color: var(--success);">
                                                <span class="data-label">純利益</span>
                                                <span class="data-value">¥1,272 (30.3%)</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 他のモールの利益計算は未実装 -->
                            <div class="marketplace-pricing shopee" style="display: none;">
                                <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Shopee利益計算機能は開発中です</p>
                            </div>
                        </div>
                    </section>

                    <!-- 送料・配送タブ -->
                    <section id="tab-shipping" class="tab-pane">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">
                            <i class="fas fa-shipping-fast"></i> 送料計算・配送設定
                        </h3>
                        
                        <div id="shipping-content">
                            <!-- eBay送料設定 -->
                            <div class="marketplace-shipping ebay active">
                                <div class="data-section">
                                    <div class="section-header">
                                        <i class="fab fa-ebay"></i> eBay送料設定
                                    </div>
                                    
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem;">
                                        <div>
                                            <h5 style="margin-bottom: 0.5rem;">国内送料オプション</h5>
                                            <div class="data-row">
                                                <span class="data-label">Standard (3-7日)</span>
                                                <span class="data-value">$8.99</span>
                                            </div>
                                            <div class="data-row">
                                                <span class="data-label">Expedited (1-3日)</span>
                                                <span class="data-value">$15.99</span>
                                            </div>
                                            
                                            <h5 style="margin: 1rem 0 0.5rem;">国際送料オプション</h5>
                                            <div class="data-row">
                                                <span class="data-label">Economy (10-21日)</span>
                                                <span class="data-value">$12.99</span>
                                            </div>
                                            <div class="data-row">
                                                <span class="data-label">Standard (7-14日)</span>
                                                <span class="data-value">$18.99</span>
                                            </div>
                                            <div class="data-row">
                                                <span class="data-label">Express (3-6日)</span>
                                                <span class="data-value">$29.99</span>
                                            </div>
                                        </div>
                                        <div>
                                            <h5 style="margin-bottom: 0.5rem;">商品サイズ・重量</h5>
                                            <div class="form-row">
                                                <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 0.5rem;">
                                                    <input type="text" class="form-input" placeholder="長さ(cm)" value="10">
                                                    <input type="text" class="form-input" placeholder="幅(cm)" value="7">
                                                    <input type="text" class="form-input" placeholder="高さ(cm)" value="0.5">
                                                </div>
                                                <input type="text" class="form-input" placeholder="重量(g)" value="15" style="margin-top: 0.5rem;">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- 他のモールの送料設定は未実装 -->
                            <div class="marketplace-shipping shopee" style="display: none;">
                                <p style="color: var(--text-secondary); text-align: center; padding: 2rem;">Shopee送料計算機能は開発中です</p>
                            </div>
                        </div>
                    </section>

                    <!-- 最終確認タブ -->
                    <section id="tab-final" class="tab-pane">
                        <h3 style="margin-bottom: 1rem; color: var(--text-primary);">
                            <i class="fas fa-check-circle"></i> 最終確認・出品準備
                        </h3>
                        
                        <div class="data-section">
                            <div class="section-header">
                                <i class="fas fa-clipboard-check"></i> 出品準備状況
                            </div>
                            
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
                                <div style="padding: 0.75rem; background: #d4edda; color: #155724; border-radius: 6px;">
                                    <i class="fab fa-ebay"></i> <strong>eBay:</strong> 出品準備完了
                                </div>
                                <div style="padding: 0.75rem; background: #f8d7da; color: #721c24; border-radius: 6px;">
                                    <i class="fas fa-shopping-bag"></i> <strong>Shopee:</strong> 未実装
                                </div>
                                <div style="padding: 0.75rem; background: #f8d7da; color: #721c24; border-radius: 6px;">
                                    <i class="fab fa-shopify"></i> <strong>Shopify:</strong> 未実装
                                </div>
                                <div style="padding: 0.75rem; background: #f8d7da; color: #721c24; border-radius: 6px;">
                                    <i class="fas fa-store"></i> <strong>Coupang:</strong> 未実装
                                </div>
                                <div style="padding: 0.75rem; background: #f8d7da; color: #721c24; border-radius: 6px;">
                                    <i class="fab fa-amazon"></i> <strong>Amazon:</strong> 未実装
                                </div>
                            </div>
                        </div>

                        <!-- 出品ボタン -->
                        <div style="text-align: center; padding: 2rem; background: #f8f9fa; border-radius: 8px; margin-top: 2rem;">
                            <h4 style="margin-bottom: 1rem;">出品実行</h4>
                            <div style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
                                <button class="btn btn-success" onclick="submitToMarketplace('ebay')">
                                    <i class="fab fa-ebay"></i> eBayに出品
                                </button>
                                <button class="btn btn-secondary" disabled>
                                    <i class="fas fa-shopping-bag"></i> Shopee (未対応)
                                </button>
                                <button class="btn btn-secondary" disabled>
                                    <i class="fab fa-shopify"></i> Shopify (未対応)
                                </button>
                                <button class="btn btn-secondary" disabled>
                                    <i class="fas fa-store"></i> Coupang (未対応)
                                </button>
                                <button class="btn btn-secondary" disabled>
                                    <i class="fab fa-amazon"></i> Amazon (未対応)
                                </button>
                            </div>
                        </div>
                    </section>
                </div>
            </div>

            <footer class="modal-footer">
                <div style="font-size: 0.85rem; color: var(--text-secondary);">
                    <i class="fas fa-clock"></i> 処理時間: 2.34秒 | 
                    <i class="fas fa-database"></i> 選択モール: <span id="current-marketplace">eBay</span> | 
                    <i class="fas fa-images"></i> 選択画像: <span id="selected-image-count">0</span>枚
                </div>
                
                <div style="display: flex; gap: 0.75rem;">
                    <button class="btn btn-secondary">
                        <i class="fas fa-save"></i> 下書き保存
                    </button>
                    <button class="btn btn-primary" onclick="switchToNextTab()">
                        <i class="fas fa-arrow-right"></i> 次へ進む
                    </button>
                    <button class="btn btn-success" onclick="submitToCurrentMarketplace()">
                        <i class="fas fa-rocket"></i> 出品実行
                    </button>
                </div>
            </footer>
        </div>
    </div>

    <script>
        // グローバル変数
        let currentMarketplace = 'ebay';
        let selectedImages = new Set();
        
        // モーダル制御
        function openMultiMarketplaceModal() {
            document.getElementById('multi-marketplace-modal').style.display = 'block';
            document.body.style.overflow = 'hidden';
            updateCharCounter(document.querySelector('textarea[maxlength="80"]'), 'ebay-title-counter');
        }
        
        function closeMultiMarketplaceModal() {
            document.getElementById('multi-marketplace-modal').style.display = 'none';
            document.body.style.overflow = 'auto';
        }
        
        // モール切り替え
        function switchMarketplace(marketplace) {
            // モールボタンの状態更新
            document.querySelectorAll('.marketplace-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`.marketplace-btn.${marketplace}`).classList.add('active');
            
            // モール固有フィールドの表示切り替え
            document.querySelectorAll('.marketplace-fields').forEach(field => {
                field.classList.remove('active');
            });
            const targetField = document.querySelector(`.marketplace-fields.${marketplace}`);
            if (targetField) {
                targetField.classList.add('active');
            }
            
            // 価格・利益計算の表示切り替え
            document.querySelectorAll('.marketplace-pricing').forEach(pricing => {
                pricing.style.display = 'none';
            });
            const targetPricing = document.querySelector(`.marketplace-pricing.${marketplace}`);
            if (targetPricing) {
                targetPricing.style.display = 'block';
            } else {
                document.querySelector('.marketplace-pricing.ebay').style.display = 'none';
            }
            
            // 送料設定の表示切り替え
            document.querySelectorAll('.marketplace-shipping').forEach(shipping => {
                shipping.style.display = 'none';
            });
            const targetShipping = document.querySelector(`.marketplace-shipping.${marketplace}`);
            if (targetShipping) {
                targetShipping.style.display = 'block';
            } else {
                document.querySelector('.marketplace-shipping.ebay').style.display = 'none';
            }
            
            currentMarketplace = marketplace;
            document.getElementById('current-marketplace').textContent = getMarketplaceName(marketplace);
        }
        
        // タブ切り替え
        function switchTab(event, tabId) {
            document.querySelectorAll('.tab-link').forEach(link => {
                link.classList.remove('active');
            });
            document.querySelectorAll('.tab-pane').forEach(pane => {
                pane.classList.remove('active');
            });
            
            event.target.classList.add('active');
            document.getElementById(tabId).classList.add('active');
        }
        
        // 画像選択機能（修正版）
        function toggleImageSelection(element, imageId) {
            const isSelected = selectedImages.has(imageId);
            
            if (isSelected) {
                // 選択解除
                selectedImages.delete(imageId);
                element.classList.remove('selected');
                element.querySelector('.image-overlay').innerHTML = element.querySelector('.image-overlay').innerHTML.replace('✓ 選択済み', 'クリックで選択');
            } else {
                // 新規選択（最大15枚まで）
                if (selectedImages.size < 15) {
                    selectedImages.add(imageId);
                    element.classList.add('selected');
                    element.querySelector('.image-overlay').innerHTML = element.querySelector('.image-overlay').innerHTML.replace('クリックで選択', '✓ 選択済み');
                } else {
                    alert('最大15枚まで選択できます。');
                    return;
                }
            }
            
            updateSelectedImagesDisplay();
            updateSelectedCount();
        }
        
        function updateSelectedImagesDisplay() {
            const selectedContainer = document.getElementById('selected-images');
            
            if (selectedImages.size === 0) {
                selectedContainer.innerHTML = `
                    <div style="height: 80px; display: flex; align-items: center; justify-content: center; color: var(--text-secondary); border: 2px dashed var(--border-color); border-radius: 6px;">
                        画像を選択してください
                    </div>
                `;
                return;
            }
            
            selectedContainer.innerHTML = '';
            selectedImages.forEach((imageId, index) => {
                const sourceImage = document.querySelector(`#source-images .image-item:nth-child(${imageId})`);
                if (sourceImage) {
                    const imgSrc = sourceImage.querySelector('img').src;
                    const imgAlt = sourceImage.querySelector('img').alt;
                    
                    const selectedImageDiv = document.createElement('div');
                    selectedImageDiv.className = 'image-item selected';
                    selectedImageDiv.innerHTML = `
                        <img src="${imgSrc}" alt="${imgAlt}">
                        <div class="image-overlay">
                            ${index + 1}番目<br>
                            <i class="fas fa-times" onclick="removeSelectedImage(${imageId})" style="cursor: pointer;"></i>
                        </div>
                    `;
                    selectedContainer.appendChild(selectedImageDiv);
                }
            });
        }
        
        function removeSelectedImage(imageId) {
            selectedImages.delete(imageId);
            
            // 元画像の選択状態を解除
            const sourceImage = document.querySelector(`#source-images .image-item:nth-child(${imageId})`);
            if (sourceImage) {
                sourceImage.classList.remove('selected');
                sourceImage.querySelector('.image-overlay').innerHTML = sourceImage.querySelector('.image-overlay').innerHTML.replace('✓ 選択済み', 'クリックで選択');
            }
            
            updateSelectedImagesDisplay();
            updateSelectedCount();
        }
        
        function updateSelectedCount() {
            document.getElementById('selected-count').textContent = selectedImages.size;
            document.getElementById('selected-image-count').textContent = selectedImages.size;
        }
        
        function selectAllImages() {
            const sourceImages = document.querySelectorAll('#source-images .image-item');
            sourceImages.forEach((element, index) => {
                const imageId = index + 1;
                if (!selectedImages.has(imageId) && selectedImages.size < 15) {
                    selectedImages.add(imageId);
                    element.classList.add('selected');
                    element.querySelector('.image-overlay').innerHTML = element.querySelector('.image-overlay').innerHTML.replace('クリックで選択', '✓ 選択済み');
                }
            });
            updateSelectedImagesDisplay();
            updateSelectedCount();
        }
        
        function clearAllImages() {
            selectedImages.clear();
            document.querySelectorAll('#source-images .image-item').forEach(element => {
                element.classList.remove('selected');
                element.querySelector('.image-overlay').innerHTML = element.querySelector('.image-overlay').innerHTML.replace('✓ 選択済み', 'クリックで選択');
            });
            updateSelectedImagesDisplay();
            updateSelectedCount();
        }
        
        // 文字カウンター
        function updateCharCounter(textarea, counterId) {
            const counter = document.getElementById(counterId);
            if (!counter) return;
            
            const current = textarea.value.length;
            const max = textarea.maxLength;
            counter.textContent = `${current}/${max}`;
            
            // 文字数に応じて色を変更
            if (current > max * 0.9) {
                counter.style.color = 'var(--error)';
            } else if (current > max * 0.8) {
                counter.style.color = 'var(--warning)';
            } else {
                counter.style.color = 'var(--text-secondary)';
            }
        }
        
        // Shopee国選択
        function toggleShopeeCountry(element, countryCode) {
            // 他の国の選択を解除
            document.querySelectorAll('.country-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            // 選択された国をアクティブにする
            element.classList.add('active');
            
            console.log('Shopee国選択:', countryCode);
            // 実装時は各国の設定を読み込み
        }
        
        // モール名取得
        function getMarketplaceName(marketplace) {
            const names = {
                'ebay': 'eBay',
                'shopee': 'Shopee',
                'shopify': 'Shopify', 
                'coupang': 'Coupang',
                'amazon': 'Amazon海外',
                'amazon-jp': 'Amazon日本'
            };
            return names[marketplace] || marketplace;
        }
        
        // 次のタブに移動
        function switchToNextTab() {
            const currentTab = document.querySelector('.tab-link.active');
            const nextTab = currentTab.nextElementSibling;
            
            if (nextTab && nextTab.classList.contains('tab-link')) {
                nextTab.click();
            } else {
                alert('最後のタブです');
            }
        }
        
        // 現在のモールに出品
        function submitToCurrentMarketplace() {
            if (currentMarketplace === 'ebay') {
                submitToMarketplace('ebay');
            } else {
                alert(`${getMarketplaceName(currentMarketplace)}の出品機能は未実装です`);
            }
        }
        
        // モール別出品処理
        function submitToMarketplace(marketplace) {
            if (marketplace !== 'ebay') {
                alert(`${getMarketplaceName(marketplace)}の出品機能は未実装です`);
                return;
            }
            
            if (selectedImages.size === 0) {
                alert('画像を選択してください');
                return;
            }
            
            if (confirm(`${getMarketplaceName(marketplace)}に出品しますか？\n\n選択画像: ${selectedImages.size}枚\n出品後は各モールでの編集が必要になります。`)) {
                // 出品処理のシミュレーション
                const loadingDiv = document.createElement('div');
                loadingDiv.innerHTML = `
                    <div style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 20000; display: flex; align-items: center; justify-content: center; color: white;">
                        <div style="text-align: center;">
                            <div style="font-size: 3rem; margin-bottom: 1rem;">
                                <i class="fas fa-spinner fa-spin"></i>
                            </div>
                            <h3>${getMarketplaceName(marketplace)}に出品中...</h3>
                            <p>画像をアップロードしています...</p>
                            <div style="width: 300px; height: 20px; background: #333; border-radius: 10px; margin: 20px auto; overflow: hidden;">
                                <div id="progress-bar" style="width: 0%; height: 100%; background: var(--success); border-radius: 10px; transition: width 0.5s ease;"></div>
                            </div>
                            <div id="progress-text">0%</div>
                        </div>
                    </div>
                `;
                document.body.appendChild(loadingDiv);
                
                // プログレスバーアニメーション
                let progress = 0;
                const progressInterval = setInterval(() => {
                    progress += Math.random() * 15;
                    if (progress > 100) progress = 100;
                    
                    document.getElementById('progress-bar').style.width = progress + '%';
                    document.getElementById('progress-text').textContent = Math.round(progress) + '%';
                    
                    if (progress >= 100) {
                        clearInterval(progressInterval);
                        setTimeout(() => {
                            document.body.removeChild(loadingDiv);
                            alert(`${getMarketplaceName(marketplace)}への出品が完了しました！\n\n出品ID: 123456789012\nURL: https://example.com/item/123456789012\n\nデータベースが更新されました。`);
                            closeMultiMarketplaceModal();
                        }, 1000);
                    }
                }, 200);
            }
        }
        
        // キーボードショートカット
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeMultiMarketplaceModal();
            }
            
            // Ctrl+S で下書き保存
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                alert('下書きを保存しました');
            }
            
            // Ctrl+Enter で次のタブに移動
            if (e.ctrlKey && e.key === 'Enter') {
                e.preventDefault();
                switchToNextTab();
            }
            
            // 数字キー1-6でモール切り替え
            if (e.key >= '1' && e.key <= '6') {
                const marketplaces = ['ebay', 'shopee', 'shopify', 'coupang', 'amazon', 'amazon-jp'];
                const index = parseInt(e.key) - 1;
                if (marketplaces[index]) {
                    switchMarketplace(marketplaces[index]);
                }
            }
        });
        
        // モーダル外クリックで閉じる
        document.getElementById('multi-marketplace-modal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeMultiMarketplaceModal();
            }
        });
        
        // 初期化
        document.addEventListener('DOMContentLoaded', function() {
            console.log('複数モール統合編集システム初期化完了');
            
            // 初期のeBayタイトルの文字カウント更新
            setTimeout(() => {
                const ebayTitle = document.querySelector('textarea[maxlength="80"]');
                if (ebayTitle) {
                    updateCharCounter(ebayTitle, 'ebay-title-counter');
                }
            }, 100);
        });
        
        // デバッグ用関数
        function debugCurrentState() {
            console.log('現在の状態:', {
                currentMarketplace: currentMarketplace,
                selectedImages: Array.from(selectedImages),
                selectedImageCount: selectedImages.size
            });
        }
        
        // ウィンドウリサイズ時の対応
        window.addEventListener('resize', function() {
            // モバイル対応などの処理をここに追加可能
        });
    </script>
</body>
</html>