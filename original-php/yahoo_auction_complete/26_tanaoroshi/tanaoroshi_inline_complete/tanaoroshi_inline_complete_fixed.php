<?php
if (!defined('SECURE_ACCESS')) {
    die('Direct access not allowed');
}

// XSSÂØæÁ≠ñÈñ¢Êï∞
function safe_output($str) {
    return htmlspecialchars($str, ENT_QUOTES, 'UTF-8');
}
?>

<!DOCTYPE html>
<html lang="ja" data-theme="light">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><?php echo safe_output('Ê£öÂç∏„Åó„Ç∑„Çπ„ÉÜ„É† - ÊßãÊñá„Ç®„É©„ÉºÂÆåÂÖ®‰øÆÊ≠£Áâà'); ?></title>
    
    <!-- Â§ñÈÉ®„É™„ÇΩ„Éº„Çπ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <!-- Â§ñÈÉ®CSS„Éï„Ç°„Ç§„É´Ë™≠„ÅøËæº„Åø -->
    <link rel="stylesheet" href="modules/tanaoroshi_inline_complete/assets/tanaoroshi_styles.css">
    
    <!-- üõ°Ô∏è Á∑äÊÄ•‰øÆÊ≠£CSSË™≠„ÅøËæº„ÅøÔºàÂºï„ÅçÁ∂ô„ÅéÊõ∏‰øÆÊ≠£ÊñπÊ≥ïAÁµ±ÂêàÔºâ -->
    <link rel="stylesheet" href="common/css/pages/tanaoroshi_modal_emergency_fix.css">
    
    <style>
    /* ===== ÊßãÊñá„Ç®„É©„Éº‰øÆÊ≠£ÁâàÔºö„Ç∑„É≥„Éó„É´Âåñ„Ç´„Éº„Éâ„É¨„Ç§„Ç¢„Ç¶„Éà ===== */
    .inventory__grid {
        display: grid !important;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)) !important;
        gap: 1rem !important;
        padding: 1rem !important;
        background: #f8fafc !important;
        min-height: calc(100vh - 400px) !important;
    }
    
    .inventory__card {
        background: white !important;
        border: 1px solid #e2e8f0 !important;
        border-radius: 8px !important;
        overflow: hidden !important;
        cursor: pointer !important;
        transition: box-shadow 0.2s ease !important;
        display: flex !important;
        flex-direction: column !important;
        height: 320px !important;
    }
    
    .inventory__card:hover {
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1) !important;
    }
    
    .inventory__card-image {
        height: 160px !important;
        background: #f1f5f9 !important;
        overflow: hidden !important;
        position: relative !important;
    }
    
    .inventory__card-img {
        width: 100% !important;
        height: 100% !important;
        object-fit: cover !important;
    }
    
    .inventory__card-placeholder {
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        height: 100% !important;
        background: #f1f5f9 !important;
        color: #64748b !important;
        flex-direction: column !important;
        gap: 8px !important;
    }
    
    .inventory__card-info {
        padding: 1rem !important;
        flex: 1 !important;
        display: flex !important;
        flex-direction: column !important;
        gap: 8px !important;
    }
    
    .inventory__card-title {
        font-size: 0.9rem !important;
        font-weight: 600 !important;
        color: #1e293b !important;
        line-height: 1.3 !important;
        margin: 0 !important;
        display: -webkit-box !important;
        -webkit-line-clamp: 2 !important;
        -webkit-box-orient: vertical !important;
        overflow: hidden !important;
        height: 2.6rem !important;
    }
    
    .inventory__card-price {
        font-size: 1.1rem !important;
        font-weight: 700 !important;
        color: #059669 !important;
        margin: 8px 0 !important;
    }
    
    .inventory__card-footer {
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
        margin-top: auto !important;
        padding-top: 8px !important;
        border-top: 1px solid #f1f5f9 !important;
        font-size: 0.8rem !important;
    }
    
    .inventory__card-sku {
        font-size: 0.75rem !important;
        color: #64748b !important;
        font-family: monospace !important;
        background: #f1f5f9 !important;
        padding: 2px 6px !important;
        border-radius: 4px !important;
    }
    
    .inventory__badge {
        position: absolute !important;
        top: 8px !important;
        left: 8px !important;
        padding: 4px 8px !important;
        border-radius: 4px !important;
        font-size: 0.7rem !important;
        font-weight: 700 !important;
        color: white !important;
        background: #059669 !important;
    }
    
    /* Áµ±Ë®à„Ç´„Éº„Éâ */
    .inventory__stats {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)) !important;
        gap: 1rem !important;
        margin-bottom: 2rem !important;
    }
    
    .inventory__stat {
        background: white !important;
        padding: 1rem !important;
        border-radius: 8px !important;
        text-align: center !important;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1) !important;
    }
    
    .inventory__stat-number {
        font-size: 2rem !important;
        font-weight: bold !important;
        color: #1e293b !important;
        display: block !important;
    }
    
    .inventory__stat-label {
        color: #64748b !important;
        font-size: 0.9rem !important;
        margin-top: 4px !important;
    }
    
    /* „Éò„ÉÉ„ÉÄ„Éº */
    .inventory__header {
        background: #0f172a !important;
        color: white !important;
        padding: 2rem !important;
        border-radius: 8px !important;
        margin-bottom: 2rem !important;
        text-align: center !important;
    }
    
    .inventory__title {
        font-size: 2rem !important;
        margin: 0 !important;
        display: flex !important;
        align-items: center !important;
        justify-content: center !important;
        gap: 0.5rem !important;
    }
    
    /* „Éú„Çø„É≥ */
    .btn {
        background: #3b82f6 !important;
        color: white !important;
        border: none !important;
        padding: 0.75rem 1.5rem !important;
        border-radius: 6px !important;
        cursor: pointer !important;
        font-size: 0.9rem !important;
        font-weight: 600 !important;
        display: inline-flex !important;
        align-items: center !important;
        gap: 0.5rem !important;
        transition: background-color 0.2s ease !important;
    }
    
    .btn:hover {
        background: #2563eb !important;
    }
    
    .btn--success { background: #059669 !important; }
    .btn--success:hover { background: #047857 !important; }
    
    .btn--warning { background: #d97706 !important; }
    .btn--warning:hover { background: #b45309 !important; }
    
    /* „Ç≥„É≥„Éà„É≠„Éº„É´„Éê„Éº */
    .inventory__controls {
        display: flex !important;
        justify-content: space-between !important;
        align-items: center !important;
        margin-bottom: 2rem !important;
        flex-wrap: wrap !important;
        gap: 1rem !important;
    }
    
    /* „É¨„Çπ„Éù„É≥„Ç∑„ÉñÂØæÂøú */
    @media (max-width: 768px) {
        .inventory__grid { 
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)) !important; 
            gap: 0.75rem !important;
        }
        .inventory__card { height: 300px !important; }
        .inventory__card-image { height: 140px !important; }
    }
    
    @media (max-width: 480px) {
        .inventory__grid { 
            grid-template-columns: 1fr !important; 
            padding: 0.5rem !important;
        }
        .inventory__card { height: 280px !important; }
        .inventory__card-image { height: 120px !important; }
    }
    </style>
</head>
<body>
    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <header class="inventory__header">
        <h1 class="inventory__title">
            <i class="fas fa-warehouse"></i>
            <?php echo safe_output('Ê£öÂç∏„Åó„Ç∑„Çπ„ÉÜ„É†ÔºàÊßãÊñá„Ç®„É©„ÉºÂÆåÂÖ®‰øÆÊ≠£ÁâàÔºâ'); ?>
        </h1>
        <p>PostgreSQL eBay„Éá„Éº„Çø„Éô„Éº„ÇπÈÄ£Êê∫ | JavaScriptÁÑ°Èôê„É´„Éº„ÉóÂÆåÂÖ®ÂØæÁ≠ñÊ∏à„Åø</p>
    </header>

    <!-- Áµ±Ë®àÊÉÖÂ†± -->
    <div class="inventory__stats">
        <div class="inventory__stat">
            <span class="inventory__stat-number" id="total-products">-</span>
            <span class="inventory__stat-label"><?php echo safe_output('Á∑èÂïÜÂìÅÊï∞'); ?></span>
        </div>
        <div class="inventory__stat">
            <span class="inventory__stat-number" id="stock-products">-</span>
            <span class="inventory__stat-label"><?php echo safe_output('ÊúâÂú®Â∫´ÂïÜÂìÅ'); ?></span>
        </div>
        <div class="inventory__stat">
            <span class="inventory__stat-number" id="total-value">-</span>
            <span class="inventory__stat-label"><?php echo safe_output('Á∑èÂú®Â∫´‰æ°ÂÄ§'); ?></span>
        </div>
        <div class="inventory__stat">
            <span class="inventory__stat-number" id="system-status">‚úÖ</span>
            <span class="inventory__stat-label"><?php echo safe_output('„Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖã'); ?></span>
        </div>
    </div>

    <!-- „Ç≥„É≥„Éà„É≠„Éº„É´„Éê„Éº -->
    <div class="inventory__controls">
        <div>
            <button class="btn btn--success" onclick="loadEbayInventoryData()">
                <i class="fas fa-sync"></i>
                <?php echo safe_output('eBay„Éá„Éº„ÇøÂèñÂæó'); ?>
            </button>
            <button class="btn" onclick="showSystemInfo()">
                <i class="fas fa-info"></i>
                <?php echo safe_output('„Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±'); ?>
            </button>
        </div>
        
        <div id="status-display" style="padding: 12px; background: #f8fafc; border-radius: 6px; font-size: 0.9rem;">
            <strong><?php echo safe_output('„Ç∑„Çπ„ÉÜ„É†Áä∂ÊÖã:'); ?></strong> 
            <span id="status-text"><?php echo safe_output('ÂàùÊúüÂåñÂÆå‰∫Ü„ÄÇ„Éá„Éº„ÇøÂèñÂæóÂæÖ„Å°...'); ?></span>
        </div>
    </div>

    <!-- ÂïÜÂìÅ„Ç∞„É™„ÉÉ„Éâ -->
    <div class="inventory__grid" id="products-container">
        <div style="grid-column: 1 / -1; text-align: center; padding: 3rem; color: #64748b;">
            <i class="fas fa-spinner fa-spin" style="font-size: 2rem; margin-bottom: 1rem;"></i>
            <p><?php echo safe_output('eBay„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„ÇâË™≠„ÅøËæº„Åø‰∏≠...'); ?></p>
        </div>
    </div>

    <!-- JavaScriptÔºàÊßãÊñá„Ç®„É©„ÉºÂÆåÂÖ®‰øÆÊ≠£ÁâàÔºâ -->
    <script>
    // ÊßãÊñá„Ç®„É©„ÉºÂÆåÂÖ®‰øÆÊ≠£Áâà JavaScript
    console.log('üöÄ Ê£öÂç∏„Åó„Ç∑„Çπ„ÉÜ„É†ÔºàÊßãÊñá„Ç®„É©„ÉºÂÆåÂÖ®‰øÆÊ≠£ÁâàÔºâÂàùÊúüÂåñÈñãÂßã');
    
    // „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞„ÅÆÂÆâÂÖ®„Å™ÂàùÊúüÂåñ
    window.inventorySystem = {
        products: [],
        totalValue: 0,
        isLoaded: false,
        exchangeRate: 150.25
    };
    
    // „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞Âº∑Âåñ
    window.addEventListener('error', function(e) {
        console.error('‚ö†Ô∏è JavaScript „Ç®„É©„Éº„Ç≠„É£„ÉÉ„ÉÅ:', e.message);
        updateStatus('JavaScript „Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: ' + e.message, 'error');
        return true;
    });
    
    // DOMÂàùÊúüÂåñÔºà‰∏ÄÂõûÈôê„ÇäÂÆüË°å‰øùË®ºÔºâ
    var isInitialized = false;
    document.addEventListener('DOMContentLoaded', function() {
        if (isInitialized) {
            console.log('‚ö†Ô∏è ÈáçË§áÂàùÊúüÂåñ„ÇíÈò≤Ê≠¢');
            return;
        }
        isInitialized = true;
        
        console.log('‚úÖ DOMÂàùÊúüÂåñÂÆå‰∫Ü');
        updateStatus('„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñÂÆå‰∫Ü„ÄÇ„Éá„Éº„ÇøÂèñÂæóÂèØËÉΩ„Åß„Åô„ÄÇ', 'success');
        
        // Ëá™Âãï„Éá„Éº„ÇøË™≠„ÅøËæº„ÅøÔºà1ÁßíÂæåÔºâ
        setTimeout(function() {
            loadEbayInventoryData();
        }, 1000);
    });
    
    // eBay„Éá„Éº„ÇøÂèñÂæóÔºà„Ç®„É©„ÉºÂÆåÂÖ®ÂØæÂøúÁâàÔºâ
    function loadEbayInventoryData() {
        console.log('üìÇ eBay„Éá„Éº„ÇøÂèñÂæóÈñãÂßã');
        updateStatus('eBay„Éá„Éº„Çø„Éô„Éº„Çπ„Åã„Çâ„Éá„Éº„Çø„ÇíÂèñÂæó‰∏≠...', 'info');
        
        try {
            if (typeof window.executeAjax === 'function') {
                window.executeAjax('ebay_inventory_get_data', {
                    limit: 50,
                    with_images: true
                }).then(function(result) {
                    handleDataResponse(result);
                }).catch(function(error) {
                    console.error('‚ùå Ajax „Ç®„É©„Éº:', error);
                    updateStatus('AjaxÈÄö‰ø°„Ç®„É©„Éº: ' + error.message, 'error');
                    loadDemoData();
                });
            } else {
                console.log('‚ö†Ô∏è N3 AjaxÈñ¢Êï∞„ÅåÂà©Áî®„Åß„Åç„Åæ„Åõ„Çì„ÄÇ„Éá„É¢„Éá„Éº„Çø„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ');
                updateStatus('AjaxÈñ¢Êï∞„ÅåÂà©Áî®„Åß„Åç„Å™„ÅÑ„Åü„ÇÅ„ÄÅ„Éá„É¢„Éá„Éº„Çø„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ', 'warning');
                loadDemoData();
            }
        } catch (error) {
            console.error('‚ùå „Éá„Éº„ÇøÂèñÂæó‰æãÂ§ñ:', error);
            updateStatus('„Éá„Éº„ÇøÂèñÂæó„Ç®„É©„Éº: ' + error.message, 'error');
            loadDemoData();
        }
    }
    
    // „Éá„Éº„ÇøÂøúÁ≠îÂá¶ÁêÜ
    function handleDataResponse(result) {
        console.log('üìä „Éá„Éº„ÇøÂøúÁ≠îÂèó‰ø°:', result);
        
        if (result && result.success && result.data && Array.isArray(result.data)) {
            var convertedData = convertEbayDataToInventory(result.data);
            window.inventorySystem.products = convertedData;
            window.inventorySystem.isLoaded = true;
            
            displayProducts(convertedData);
            updateStatistics(convertedData);
            updateStatus('eBay„Éá„Éº„ÇøÂèñÂæóÊàêÂäü: ' + result.data.length + '‰ª∂', 'success');
            
            console.log('‚úÖ eBay„Éá„Éº„ÇøË°®Á§∫ÂÆå‰∫Ü:', result.data.length, '‰ª∂');
        } else {
            console.log('‚ö†Ô∏è „Éá„Éº„ÇøÊßãÈÄ†„Åå‰∏çÊ≠£„Åß„Åô„ÄÇ„Éá„É¢„Éá„Éº„Çø„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ');
            updateStatus('„Éá„Éº„ÇøÊßãÈÄ†„Ç®„É©„Éº„ÄÇ„Éá„É¢„Éá„Éº„Çø„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ', 'warning');
            loadDemoData();
        }
    }
    
    // eBay„Éá„Éº„Çø„ÇíÊ£öÂç∏„ÅóÂΩ¢Âºè„Å´Â§âÊèõ
    function convertEbayDataToInventory(ebayData) {
        return ebayData.map(function(item, index) {
            return {
                id: item.item_id || index + 1,
                name: item.title || item.name || '„Çø„Ç§„Éà„É´‰∏çÊòé',
                sku: item.sku || 'SKU-' + (index + 1).toString().padStart(6, '0'),
                type: determineProductType(item),
                condition: item.condition || 'used',
                priceUSD: parseFloat(item.price || item.start_price || 0),
                costUSD: parseFloat(item.cost || (item.price * 0.7) || 0),
                stock: parseInt(item.quantity || item.available_quantity || 0),
                category: item.category || item.primary_category || '„Åù„ÅÆ‰ªñ',
                image: item.gallery_url || item.picture_url || item.image_url || '',
                listing_status: item.listing_status || item.status || '„Ç¢„ÇØ„ÉÜ„Ç£„Éñ',
                watchers_count: parseInt(item.watch_count || 0),
                views_count: parseInt(item.hit_count || 0),
                ebay_item_id: item.item_id,
                ebay_url: item.view_item_url || ''
            };
        });
    }
    
    // ÂïÜÂìÅÁ®ÆÂà•Âà§ÂÆö
    function determineProductType(item) {
        var quantity = parseInt(item.quantity || item.available_quantity || 0);
        var title = (item.title || '').toLowerCase();
        
        if (title.indexOf('set') !== -1 || title.indexOf('bundle') !== -1) {
            return 'set';
        } else if (quantity > 10) {
            return 'stock';
        } else if (quantity === 0) {
            return 'dropship';
        } else {
            return 'hybrid';
        }
    }
    
    // „Éá„É¢„Éá„Éº„ÇøË°®Á§∫
    function loadDemoData() {
        console.log('üìã „Éá„É¢„Éá„Éº„ÇøË°®Á§∫');
        
        var demoData = [
            {
                id: 1,
                name: 'iPhone 15 Pro Max - Excellent Condition',
                sku: 'DEMO-IPHONE15PM',
                type: 'stock',
                condition: 'new',
                priceUSD: 299.99,
                costUSD: 209.99,
                stock: 3,
                category: 'Electronics',
                image: 'https://images.unsplash.com/photo-1592750475338-74b7b21085ab?w=300&h=200&fit=crop',
                listing_status: '„Ç¢„ÇØ„ÉÜ„Ç£„Éñ',
                watchers_count: 25,
                views_count: 450,
                ebay_item_id: 'DEMO001',
                ebay_url: 'https://www.ebay.com/itm/demo001'
            },
            {
                id: 2,
                name: 'Samsung Galaxy S24 Ultra - Like New',
                sku: 'DEMO-SAMSUNG-S24U',
                type: 'hybrid',
                condition: 'used',
                priceUSD: 499.99,
                costUSD: 349.99,
                stock: 1,
                category: 'Electronics',
                image: 'https://images.unsplash.com/photo-1605236453806-6ff36851218e?w=300&h=200&fit=crop',
                listing_status: '„Ç¢„ÇØ„ÉÜ„Ç£„Éñ',
                watchers_count: 15,
                views_count: 320,
                ebay_item_id: 'DEMO002',
                ebay_url: 'https://www.ebay.com/itm/demo002'
            },
            {
                id: 3,
                name: 'MacBook Pro M3 - Professional Grade',
                sku: 'DEMO-MBP-M3',
                type: 'stock',
                condition: 'used',
                priceUSD: 799.99,
                costUSD: 559.99,
                stock: 2,
                category: 'Computers',
                image: 'https://images.unsplash.com/photo-1541807084-5c52b6b3adef?w=300&h=200&fit=crop',
                listing_status: '„Ç¢„ÇØ„ÉÜ„Ç£„Éñ',
                watchers_count: 35,
                views_count: 780,
                ebay_item_id: 'DEMO003',
                ebay_url: 'https://www.ebay.com/itm/demo003'
            }
        ];
        
        window.inventorySystem.products = demoData;
        window.inventorySystem.isLoaded = true;
        
        displayProducts(demoData);
        updateStatistics(demoData);
        updateStatus('„Éá„É¢„Éá„Éº„ÇøË°®Á§∫‰∏≠Ôºà3‰ª∂Ôºâ', 'success');
    }
    
    // ÂïÜÂìÅË°®Á§∫
    function displayProducts(products) {
        var container = document.getElementById('products-container');
        if (!container) {
            console.error('‚ùå ÂïÜÂìÅ„Ç≥„É≥„ÉÜ„Éä„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
            return;
        }
        
        var html = '';
        products.forEach(function(product) {
            html += createProductCard(product);
        });
        
        container.innerHTML = html;
        console.log('üé® ÂïÜÂìÅË°®Á§∫ÂÆå‰∫Ü:', products.length, '‰ª∂');
    }
    
    // ÂïÜÂìÅ„Ç´„Éº„Éâ‰ΩúÊàê
    function createProductCard(product) {
        var priceJPY = Math.round(product.priceUSD * window.inventorySystem.exchangeRate);
        
        var imageHtml;
        if (product.image && product.image.trim() !== '') {
            imageHtml = '<img src="' + product.image + '" alt="' + product.name + '" class="inventory__card-img" onerror="this.style.display=\'none\'; this.parentNode.innerHTML=\'<div class=\\\"inventory__card-placeholder\\\"><i class=\\\"fas fa-image\\\"></i><span>ÁîªÂÉè„Ç®„É©„Éº</span></div>\'">';
        } else {
            imageHtml = '<div class="inventory__card-placeholder"><i class="fas fa-image"></i><span>ÁîªÂÉè„Å™„Åó</span></div>';
        }
        
        var stockInfo = product.stock > 0 ? 
            '<span style="color: #059669; font-weight: 600;">Âú®Â∫´:' + product.stock + '</span>' :
            '<span style="color: #dc2626;">Âú®Â∫´Âàá„Çå</span>';
        
        return [
            '<div class="inventory__card" onclick="showProductDetail(' + product.id + ')">',
                '<div class="inventory__card-image">',
                    imageHtml,
                    '<span class="inventory__badge">' + product.type + '</span>',
                '</div>',
                '<div class="inventory__card-info">',
                    '<h3 class="inventory__card-title" title="' + product.name + '">' + product.name + '</h3>',
                    '<div class="inventory__card-price">$' + product.priceUSD.toFixed(2) + ' (¬•' + priceJPY.toLocaleString() + ')</div>',
                    '<div class="inventory__card-footer">',
                        '<span class="inventory__card-sku">' + product.sku + '</span>',
                        stockInfo,
                    '</div>',
                '</div>',
            '</div>'
        ].join('');
    }
    
    // Áµ±Ë®àÊõ¥Êñ∞
    function updateStatistics(products) {
        var stats = {
            total: products.length,
            stock: products.filter(function(p) { return p.stock > 0; }).length,
            totalValue: products.reduce(function(sum, p) { return sum + p.priceUSD; }, 0)
        };
        
        var totalProductsEl = document.getElementById('total-products');
        var stockProductsEl = document.getElementById('stock-products');
        var totalValueEl = document.getElementById('total-value');
        
        if (totalProductsEl) totalProductsEl.textContent = stats.total.toLocaleString();
        if (stockProductsEl) stockProductsEl.textContent = stats.stock.toLocaleString();
        if (totalValueEl) totalValueEl.textContent = '$' + Math.round(stats.totalValue).toLocaleString();
        
        window.inventorySystem.totalValue = stats.totalValue;
        
        console.log('üìà Áµ±Ë®àÊõ¥Êñ∞ÂÆå‰∫Ü:', stats);
    }
    
    // „Çπ„ÉÜ„Éº„Çø„ÇπÊõ¥Êñ∞
    function updateStatus(message, type) {
        var statusEl = document.getElementById('status-text');
        if (!statusEl) return;
        
        var colors = {
            success: '#059669',
            error: '#dc2626',
            warning: '#d97706',
            info: '#3b82f6'
        };
        
        statusEl.textContent = message;
        statusEl.style.color = colors[type] || '#64748b';
        
        console.log('üìä „Çπ„ÉÜ„Éº„Çø„ÇπÊõ¥Êñ∞:', message);
    }
    
    // ÂïÜÂìÅË©≥Á¥∞Ë°®Á§∫
    function showProductDetail(productId) {
        console.log('üëÅÔ∏è ÂïÜÂìÅË©≥Á¥∞Ë°®Á§∫:', productId);
        
        var product = window.inventorySystem.products.find(function(p) { 
            return p.id == productId; 
        });
        
        if (product && product.ebay_url) {
            window.open(product.ebay_url, '_blank');
        } else {
            alert('ÂïÜÂìÅID ' + productId + ' „ÅÆË©≥Á¥∞„ÇíË°®Á§∫„Åó„Åæ„Åô„ÄÇ');
        }
    }
    
    // „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±Ë°®Á§∫
    function showSystemInfo() {
        var info = [
            '„Ç∑„Çπ„ÉÜ„É†: NAGANO-3 Ê£öÂç∏„Åó„Ç∑„Çπ„ÉÜ„É†',
            '„Éê„Éº„Ç∏„Éß„É≥: ÊßãÊñá„Ç®„É©„ÉºÂÆåÂÖ®‰øÆÊ≠£Áâà',
            'ÂïÜÂìÅ„Éá„Éº„Çø: ' + (window.inventorySystem.isLoaded ? window.inventorySystem.products.length + '‰ª∂Ë™≠„ÅøËæº„ÅøÊ∏à„Åø' : 'Êú™Ë™≠„ÅøËæº„Åø'),
            'Á∑èÂú®Â∫´‰æ°ÂÄ§: $' + window.inventorySystem.totalValue.toFixed(2),
            'AjaxÈñ¢Êï∞: ' + (typeof window.executeAjax === 'function' ? 'Âà©Áî®ÂèØËÉΩ' : 'Âà©Áî®‰∏çÂèØ'),
            '„Éñ„É©„Ç¶„Ç∂: ' + navigator.userAgent.split(' ').slice(-1)[0],
            'JavaScript: Ê≠£Â∏∏Âãï‰Ωú‰∏≠'
        ].join('\n');
        
        alert(info);
        console.log('‚ÑπÔ∏è „Ç∑„Çπ„ÉÜ„É†ÊÉÖÂ†±:', info);
    }
    
    console.log('‚úÖ Ê£öÂç∏„Åó„Ç∑„Çπ„ÉÜ„É† JavaScriptÔºàÊßãÊñá„Ç®„É©„ÉºÂÆåÂÖ®‰øÆÊ≠£ÁâàÔºâÂàùÊúüÂåñÂÆå‰∫Ü');
    </script>
</body>
</html>
