
// CAIDS character_limit Hook
// CAIDS character_limit Hook - Âü∫Êú¨ÂÆüË£Ö
console.log('‚úÖ character_limit Hook loaded');

// CAIDS error_handling Hook

// CAIDS „Ç®„É©„ÉºÂá¶ÁêÜHook - ÂÆåÂÖ®ÂÆüË£Ö
window.CAIDS_ERROR_HANDLER = {
    isActive: true,
    errorCount: 0,
    errorHistory: [],
    
    initialize: function() {
        this.setupGlobalErrorHandler();
        this.setupUnhandledPromiseRejection();
        this.setupNetworkErrorHandler();
        console.log('‚ö†Ô∏è CAIDS „Ç®„É©„Éº„Éè„É≥„Éâ„É™„É≥„Ç∞„Ç∑„Çπ„ÉÜ„É†ÂÆåÂÖ®ÂàùÊúüÂåñ');
    },
    
    setupGlobalErrorHandler: function() {
        window.addEventListener('error', (event) => {
            this.handleError({
                type: 'JavaScript Error',
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                stack: event.error?.stack
            });
        });
    },
    
    setupUnhandledPromiseRejection: function() {
        window.addEventListener('unhandledrejection', (event) => {
            this.handleError({
                type: 'Unhandled Promise Rejection',
                message: event.reason?.message || String(event.reason),
                stack: event.reason?.stack
            });
        });
    },
    
    setupNetworkErrorHandler: function() {
        const originalFetch = window.fetch;
        window.fetch = async function(...args) {
            try {
                const response = await originalFetch.apply(this, args);
                if (!response.ok) {
                    window.CAIDS_ERROR_HANDLER.handleError({
                        type: 'Network Error',
                        message: `HTTP ${response.status}: ${response.statusText}`,
                        url: args[0]
                    });
                }
                return response;
            } catch (error) {
                window.CAIDS_ERROR_HANDLER.handleError({
                    type: 'Network Fetch Error',
                    message: error.message,
                    url: args[0]
                });
                throw error;
            }
        };
    },
    
    handleError: function(errorInfo) {
        this.errorCount++;
        this.errorHistory.push({...errorInfo, timestamp: new Date().toISOString()});
        
        console.error('üö® CAIDS Error Handler:', errorInfo);
        this.showErrorNotification(errorInfo);
        this.reportError(errorInfo);
    },
    
    showErrorNotification: function(errorInfo) {
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = `
            position: fixed; top: 10px; right: 10px; z-index: 999999;
            background: linear-gradient(135deg, #ff4444, #cc0000);
            color: white; padding: 15px 20px; border-radius: 8px;
            max-width: 350px; box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            font-size: 13px; font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            border: 2px solid #ff6666; animation: caids-error-shake 0.5s ease-in-out;
        `;
        errorDiv.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 18px;">üö®</span>
                <div>
                    <strong>„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü</strong><br>
                    <small style="opacity: 0.9;">${errorInfo.type}: ${errorInfo.message}</small>
                </div>
            </div>
        `;
        
        // CSS Animation
        if (!document.getElementById('caids-error-styles')) {
            const style = document.createElement('style');
            style.id = 'caids-error-styles';
            style.textContent = `
                @keyframes caids-error-shake {
                    0%, 100% { transform: translateX(0); }
                    25% { transform: translateX(-5px); }
                    75% { transform: translateX(5px); }
                }
            `;
            document.head.appendChild(style);
        }
        
        document.body.appendChild(errorDiv);
        setTimeout(() => errorDiv.remove(), 7000);
    },
    
    reportError: function(errorInfo) {
        // „Ç®„É©„Éº„É¨„Éù„Éº„ÉàÁîüÊàê„ÉªÈÄÅ‰ø°ÔºàÂ∞ÜÊù•„ÅÆÊã°ÂºµÁî®Ôºâ
        const report = {
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            url: window.location.href,
            errorCount: this.errorCount,
            sessionId: this.getSessionId(),
            ...errorInfo
        };
        
        console.log('üìã CAIDS Error Report:', report);
        localStorage.setItem('caids_last_error', JSON.stringify(report));
    },
    
    getSessionId: function() {
        let sessionId = sessionStorage.getItem('caids_session_id');
        if (!sessionId) {
            sessionId = 'caids_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            sessionStorage.setItem('caids_session_id', sessionId);
        }
        return sessionId;
    },
    
    getErrorStats: function() {
        return {
            totalErrors: this.errorCount,
            recentErrors: this.errorHistory.slice(-10),
            sessionId: this.getSessionId()
        };
    }
};

window.CAIDS_ERROR_HANDLER.initialize();

/**
 * NAGANO-3 „Éû„Éã„É•„Ç¢„É´„Ç∑„Çπ„ÉÜ„É† JavaScript
 * Ê§úÁ¥¢„Éª„Éï„Ç£„É´„Çø„É™„É≥„Ç∞„Éª„Ç§„É≥„Çø„É©„ÇØ„Ç∑„Éß„É≥Ê©üËÉΩ
 */

class ManualSystem {
    constructor() {
        this.searchInput = null;
        this.searchClearBtn = null;
        this.searchSuggestions = null;
        this.categories = [];
        this.items = [];
        this.searchIndex = [];
        this.init();
    }

    init() {
        this.bindElements();
        this.buildSearchIndex();
        this.bindEvents();
        this.initializeComponents();
        console.log('NAGANO-3 „Éû„Éã„É•„Ç¢„É´„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñÂÆå‰∫Ü');
    }

    bindElements() {
        this.searchInput = document.getElementById('manualSearchInput');
        this.searchClearBtn = document.getElementById('searchClearBtn');
        this.searchSuggestions = document.getElementById('searchSuggestions');
        this.categories = document.querySelectorAll('.manual__category-card');
        this.items = document.querySelectorAll('.manual__item-link');
    }

    buildSearchIndex() {
        this.searchIndex = [];
        
        this.items.forEach((item, index) => {
            const title = item.querySelector('.manual__item-title')?.textContent || '';
            const description = item.querySelector('.manual__item-description')?.textContent || '';
            const category = item.closest('.manual__category-card')?.querySelector('.manual__category-title')?.textContent || '';
            
            this.searchIndex.push({
                element: item,
                title: title.toLowerCase(),
                description: description.toLowerCase(),
                category: category.toLowerCase(),
                keywords: this.generateKeywords(title, description, category),
                index: index
            });
        });
        
        console.log(`Ê§úÁ¥¢„Ç§„É≥„Éá„ÉÉ„ÇØ„ÇπÊßãÁØâÂÆå‰∫Ü: ${this.searchIndex.length}‰ª∂`);
    }

    generateKeywords(title, description, category) {
        const keywords = new Set();
        
        // „Çø„Ç§„Éà„É´„ÉªË™¨Êòé„Éª„Ç´„ÉÜ„Ç¥„É™„Åã„ÇâÂçòË™û„ÇíÊäΩÂá∫
        const text = `${title} ${description} ${category}`.toLowerCase();
        const words = text.match(/[\w\u3040-\u309F\u30A0-\u30FF\u4E00-\u9FAF]+/g) || [];
        
        words.forEach(word => {
            if (word.length >= 2) {
                keywords.add(word);
                // ÈÉ®ÂàÜ„Éû„ÉÉ„ÉÅÁî®
                for (let i = 0; i < word.length - 1; i++) {
                    keywords.add(word.substring(i, i + 2));
                }
            }
        });
        
        return Array.from(keywords);
    }

    bindEvents() {
        // Ê§úÁ¥¢ÂÖ•Âäõ„Ç§„Éô„É≥„Éà
        if (this.searchInput) {
            this.searchInput.addEventListener('input', (e) => {
                this.handleSearch(e.target.value);
            });
            
            this.searchInput.addEventListener('keydown', (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    this.performSearch(e.target.value);
                } else if (e.key === 'Escape') {
                    this.clearSearch();
                }
            });
        }
        
        // Ê§úÁ¥¢„ÇØ„É™„Ç¢„Éú„Çø„É≥
        if (this.searchClearBtn) {
            this.searchClearBtn.addEventListener('click', () => {
                this.clearSearch();
            });
        }
        
        // FAQ „Ç¢„Ç≥„Éº„Éá„Ç£„Ç™„É≥
        this.bindFAQEvents();
        
        // „Ç´„ÉÜ„Ç¥„É™„Ç´„Éº„ÉâÂ±ïÈñã
        this.bindCategoryEvents();
        
        // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà
        this.bindKeyboardShortcuts();
    }

    bindFAQEvents() {
        const faqToggles = document.querySelectorAll('.manual__faq-toggle');
        faqToggles.forEach(toggle => {
            toggle.addEventListener('click', (e) => {
                e.preventDefault();
                this.toggleFAQItem(toggle);
            });
        });
        
        // FAQË≥™ÂïèÈÉ®ÂàÜ„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Å¶„ÇÇÈñãÈñâ
        const faqQuestions = document.querySelectorAll('.manual__faq-question');
        faqQuestions.forEach(question => {
            question.addEventListener('click', (e) => {
                if (!e.target.classList.contains('manual__faq-toggle')) {
                    const toggle = question.querySelector('.manual__faq-toggle');
                    if (toggle) {
                        this.toggleFAQItem(toggle);
                    }
                }
            });
        });
    }

    bindCategoryEvents() {
        this.categories.forEach(category => {
            const header = category.querySelector('.manual__category-header');
            if (header) {
                header.addEventListener('click', () => {
                    this.toggleCategory(category);
                });
            }
        });
    }

    bindKeyboardShortcuts() {
        document.addEventListener('keydown', (e) => {
            // Ctrl+K „Åæ„Åü„ÅØ Cmd+K „ÅßÊ§úÁ¥¢„Éï„Ç©„Éº„Ç´„Çπ
            if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                e.preventDefault();
                if (this.searchInput) {
                    this.searchInput.focus();
                }
            }
            
            // Ctrl+/ „Åß FAQ „Å∏„Çπ„ÇØ„É≠„Éº„É´
            if ((e.ctrlKey || e.metaKey) && e.key === '/') {
                e.preventDefault();
                this.scrollToFAQ();
            }
        });
    }

    handleSearch(query) {
        const trimmedQuery = query.trim();
        
        if (trimmedQuery.length > 0) {
            this.searchClearBtn.style.display = 'block';
            this.showSearchSuggestions(trimmedQuery);
            this.filterContent(trimmedQuery);
        } else {
            this.searchClearBtn.style.display = 'none';
            this.hideSearchSuggestions();
            this.showAllContent();
        }
    }

    performSearch(query) {
        const trimmedQuery = query.trim();
        if (trimmedQuery.length === 0) return;
        
        this.hideSearchSuggestions();
        this.filterContent(trimmedQuery);
        
        // Ê§úÁ¥¢Áµ±Ë®à„ÇíË®òÈå≤ÔºàÂ∞ÜÊù•„ÅÆÊîπÂñÑÁî®Ôºâ
        this.logSearchEvent(trimmedQuery);
    }

    filterContent(query) {
        const searchTerms = query.toLowerCase().split(/\s+/).filter(term => term.length > 0);
        let hasResults = false;
        
        this.categories.forEach(category => {
            const items = category.querySelectorAll('.manual__item-link');
            let categoryHasResults = false;
            
            items.forEach(item => {
                const searchData = this.searchIndex.find(data => data.element === item);
                if (!searchData) return;
                
                const isMatch = searchTerms.every(term => 
                    searchData.title.includes(term) || 
                    searchData.description.includes(term) || 
                    searchData.category.includes(term) ||
                    searchData.keywords.some(keyword => keyword.includes(term))
                );
                
                if (isMatch) {
                    item.style.display = 'block';
                    categoryHasResults = true;
                    hasResults = true;
                    this.highlightSearchTerms(item, searchTerms);
                } else {
                    item.style.display = 'none';
                    this.removeHighlights(item);
                }
            });
            
            category.style.display = categoryHasResults ? 'block' : 'none';
        });
        
        if (!hasResults) {
            this.showNoResults(query);
        } else {
            this.hideNoResults();
        }
    }

    highlightSearchTerms(item, terms) {
        const title = item.querySelector('.manual__item-title');
        const description = item.querySelector('.manual__item-description');
        
        if (title) {
            title.innerHTML = this.addHighlights(title.textContent, terms);
        }
        if (description) {
            description.innerHTML = this.addHighlights(description.textContent, terms);
        }
    }

    addHighlights(text, terms) {
        let highlightedText = text;
        terms.forEach(term => {
            const regex = new RegExp(`(${this.escapeRegex(term)})`, 'gi');
            highlightedText = highlightedText.replace(regex, '<mark class="manual__search-highlight">$1</mark>');
        });
        return highlightedText;
    }

    removeHighlights(item) {
        const highlights = item.querySelectorAll('.manual__search-highlight');
        highlights.forEach(highlight => {
            highlight.outerHTML = highlight.textContent;
        });
    }

    escapeRegex(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\    handleSearch(query) {
        const trim');
    }

    showSearchSuggestions(query) {
        if (!this.searchSuggestions) return;
        
        const suggestions = this.generateSuggestions(query);
        if (suggestions.length > 0) {
            this.searchSuggestions.innerHTML = suggestions.map(suggestion => 
                `<div class="manual__suggestion-item" onclick="manualSystem.selectSuggestion('${suggestion.query}')">${suggestion.html}</div>`
            ).join('');
            this.searchSuggestions.style.display = 'block';
        } else {
            this.hideSearchSuggestions();
        }
    }

    generateSuggestions(query) {
        const suggestions = [];
        const searchTerms = query.toLowerCase().split(/\s+/);
        const lastTerm = searchTerms[searchTerms.length - 1];
        
        // „Ç´„ÉÜ„Ç¥„É™Âêç„Åã„Çâ„ÅÆÂÄôË£ú
        const categories = ['ÂïÜÂìÅÁÆ°ÁêÜ', 'Âú®Â∫´ÁÆ°ÁêÜ', 'Â£≤‰∏äÂàÜÊûê', 'AIÊ©üËÉΩ', '‰ºöË®àË®òÂ∏≥'];
        categories.forEach(category => {
            if (category.toLowerCase().includes(lastTerm)) {
                suggestions.push({
                    query: category,
                    html: `<i class="fas fa-folder"></i> ${category}`,
                    type: 'category'
                });
            }
        });
        
        // „Çà„ÅèÊ§úÁ¥¢„Åï„Çå„ÇãÁî®Ë™û
        const popularTerms = ['ÁôªÈå≤', 'Ë®≠ÂÆö', '‰Ωø„ÅÑÊñπ', 'ÊâãÈ†Ü', 'ÊñπÊ≥ï', '„Ç®„É©„Éº', '„Éà„É©„Éñ„É´'];
        popularTerms.forEach(term => {
            if (term.includes(lastTerm) && lastTerm.length >= 1) {
                suggestions.push({
                    query: term,
                    html: `<i class="fas fa-search"></i> ${term}`,
                    type: 'term'
                });
            }
        });
        
        return suggestions.slice(0, 5); // ÊúÄÂ§ß5‰ª∂
    }

    selectSuggestion(suggestion) {
        if (this.searchInput) {
            this.searchInput.value = suggestion;
            this.performSearch(suggestion);
        }
    }

    hideSearchSuggestions() {
        if (this.searchSuggestions) {
            this.searchSuggestions.style.display = 'none';
        }
    }

    showNoResults(query) {
        if (!this.searchSuggestions) return;
        
        this.searchSuggestions.innerHTML = `
            <div class="manual__no-results">
                <i class="fas fa-search"></i>
                <p>„Äå${query}„Äç„Å´Ë©≤ÂΩì„Åô„Çã„Éû„Éã„É•„Ç¢„É´„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì„Åß„Åó„Åü</p>
                <div class="manual__search-help">
                    <p>Ê§úÁ¥¢„ÅÆ„Éí„É≥„Éà:</p>
                    <ul>
                        <li>„Ç≠„Éº„ÉØ„Éº„Éâ„ÇíÂ§â„Åà„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ</li>
                        <li>„Çà„Çä‰∏ÄËà¨ÁöÑ„Å™Áî®Ë™û„Çí‰Ωø„Å£„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ</li>
                        <li>„Ç´„ÉÜ„Ç¥„É™Âêç„ÅßÊ§úÁ¥¢„Åó„Å¶„Åø„Å¶„Åè„Å†„Åï„ÅÑ</li>
                    </ul>
                </div>
            </div>
        `;
        this.searchSuggestions.style.display = 'block';
    }

    hideNoResults() {
        this.hideSearchSuggestions();
    }

    clearSearch() {
        if (this.searchInput) {
            this.searchInput.value = '';
        }
        if (this.searchClearBtn) {
            this.searchClearBtn.style.display = 'none';
        }
        this.hideSearchSuggestions();
        this.showAllContent();
    }

    showAllContent() {
        this.categories.forEach(category => {
            category.style.display = 'block';
        });
        this.items.forEach(item => {
            item.style.display = 'block';
            this.removeHighlights(item);
        });
    }

    toggleFAQItem(toggle) {
        const faqItem = toggle.closest('.manual__faq-item');
        const answer = faqItem.querySelector('.manual__faq-answer');
        const icon = toggle.querySelector('i');
        
        if (faqItem.classList.contains('manual__faq-item--open')) {
            faqItem.classList.remove('manual__faq-item--open');
            icon.classList.remove('fa-chevron-up');
            icon.classList.add('fa-chevron-down');
        } else {
            // ‰ªñ„ÅÆFAQ„ÇíÈñâ„Åò„ÇãÔºà„Ç¢„Ç≥„Éº„Éá„Ç£„Ç™„É≥Âãï‰ΩúÔºâ
            document.querySelectorAll('.manual__faq-item--open').forEach(openItem => {
                if (openItem !== faqItem) {
                    openItem.classList.remove('manual__faq-item--open');
                    const openIcon = openItem.querySelector('.manual__faq-toggle i');
                    if (openIcon) {
                        openIcon.classList.remove('fa-chevron-up');
                        openIcon.classList.add('fa-chevron-down');
                    }
                }
            });
            
            faqItem.classList.add('manual__faq-item--open');
            icon.classList.remove('fa-chevron-down');
            icon.classList.add('fa-chevron-up');
        }
    }

    toggleCategory(category) {
        const items = category.querySelector('.manual__category-items');
        const isExpanded = category.classList.contains('manual__category--expanded');
        
        if (isExpanded) {
            category.classList.remove('manual__category--expanded');
        } else {
            category.classList.add('manual__category--expanded');
        }
    }

    scrollToFAQ() {
        const faqSection = document.getElementById('faq');
        if (faqSection) {
            faqSection.scrollIntoView({ 
                behavior: 'smooth',
                block: 'start'
            });
        }
    }

    logSearchEvent(query) {
        // Ê§úÁ¥¢Áµ±Ë®à„ÅÆË®òÈå≤ÔºàÂ∞ÜÊù•„ÅÆÊ©üËÉΩÊîπÂñÑÁî®Ôºâ
        if (typeof analytics !== 'undefined') {
            analytics.track('manual_search', {
                query: query,
                timestamp: new Date().toISOString(),
                page: 'manual_main'
            });
        }
        
        console.log(`Ê§úÁ¥¢ÂÆüË°å: "${query}"`);
    }

    initializeComponents() {
        // „Ç´„ÉÜ„Ç¥„É™„Ç´„Éº„Éâ„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
        this.animateCategoryCards();
        
        // Áµ±Ë®àÊÉÖÂ†±„ÅÆÊõ¥Êñ∞
        this.updateStatistics();
        
        // „Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà„ÅÆË°®Á§∫
        this.setupKeyboardHints();
    }

    animateCategoryCards() {
        const cards = document.querySelectorAll('.manual__category-card');
        cards.forEach((card, index) => {
            card.style.opacity = '0';
            card.style.transform = 'translateY(20px)';
            
            setTimeout(() => {
                card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                card.style.opacity = '1';
                card.style.transform = 'translateY(0)';
            }, index * 100);
        });
    }

    updateStatistics() {
        // „Éû„Éã„É•„Ç¢„É´Èñ≤Ë¶ßÁµ±Ë®à„ÅÆÊõ¥Êñ∞
        const totalManuals = this.searchIndex.length;
        const totalViews = this.calculateTotalViews();
        
        console.log(`„Éû„Éã„É•„Ç¢„É´Áµ±Ë®à: ${totalManuals}‰ª∂, Á∑èÈñ≤Ë¶ßÊï∞: ${totalViews}Âõû`);
    }

    calculateTotalViews() {
        let totalViews = 0;
        document.querySelectorAll('.manual__item-views').forEach(viewElement => {
            const viewText = viewElement.textContent.replace(/[^\d]/g, '');
            const views = parseInt(viewText) || 0;
            totalViews += views;
        });
        return totalViews;
    }

    setupKeyboardHints() {
        // Ê§úÁ¥¢„Éú„ÉÉ„ÇØ„Çπ„Å´„Ç≠„Éº„Éú„Éº„Éâ„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà„ÅÆ„Éí„É≥„Éà„ÇíËøΩÂä†
        if (this.searchInput) {
            const isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0;
            const shortcut = isMac ? '‚åòK' : 'Ctrl+K';
            
            this.searchInput.setAttribute('placeholder', 
                `„Éû„Éã„É•„Ç¢„É´„ÇíÊ§úÁ¥¢... (${shortcut} „Åß„Éï„Ç©„Éº„Ç´„Çπ)`
            );
        }
    }

    // Â§ñÈÉ®APIÔºà‰ªñ„ÅÆ„Çπ„ÇØ„É™„Éó„Éà„Åã„Çâ„ÅÆÂëº„Å≥Âá∫„ÅóÁî®Ôºâ
    search(query) {
        if (this.searchInput) {
            this.searchInput.value = query;
            this.performSearch(query);
        }
    }

    expandCategory(categoryId) {
        const category = document.querySelector(`[data-category="${categoryId}"]`);
        if (category) {
            this.toggleCategory(category);
        }
    }

    highlightManual(manualId) {
        const manual = document.querySelector(`[href*="${manualId}"]`);
        if (manual) {
            manual.scrollIntoView({ behavior: 'smooth' });
            manual.style.background = 'rgba(139, 92, 246, 0.1)';
            manual.style.border = '2px solid var(--manual-primary)';
            
            setTimeout(() => {
                manual.style.background = '';
                manual.style.border = '';
                manual.style.transition = 'background 0.5s ease, border 0.5s ease';
            }, 2000);
        }
    }
}

// „Ç∞„É≠„Éº„Éê„É´Èñ¢Êï∞ÔºàHTMLÂÜÖ„Åß„ÅÆÂëº„Å≥Âá∫„ÅóÁî®Ôºâ
function scrollToFAQ() {
    if (window.manualSystem) {
        window.manualSystem.scrollToFAQ();
    }
}

// CSSËøΩÂä†ÔºàÊ§úÁ¥¢„Éè„Ç§„É©„Ç§„ÉàÁî®Ôºâ
const searchHighlightCSS = `
    .manual__search-highlight {
        background: linear-gradient(135deg, var(--accent-yellow), #fbbf24);
        color: #92400e;
        padding: 1px 3px;
        border-radius: 3px;
        font-weight: 600;
    }
    
    .manual__suggestion-item {
        padding: var(--space-3) var(--space-4);
        cursor: pointer;
        transition: var(--transition);
        border-bottom: 1px solid var(--shadow-dark);
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }
    
    .manual__suggestion-item:last-child {
        border-bottom: none;
    }
    
    .manual__suggestion-item:hover {
        background: var(--bg-hover);
    }
    
    .manual__suggestion-item i {
        color: var(--manual-primary);
        width: 16px;
        text-align: center;
    }
    
    .manual__no-results {
        padding: var(--space-6);
        text-align: center;
        color: var(--text-secondary);
    }
    
    .manual__no-results i {
        font-size: 2rem;
        color: var(--text-tertiary);
        margin-bottom: var(--space-3);
    }
    
    .manual__no-results p {
        margin: 0 0 var(--space-4) 0;
        font-size: var(--text-base);
    }
    
    .manual__search-help {
        background: var(--bg-primary);
        border-radius: var(--radius-md);
        padding: var(--space-4);
        margin-top: var(--space-4);
        text-align: left;
    }
    
    .manual__search-help p {
        font-weight: 600;
        margin-bottom: var(--space-2);
        color: var(--text-primary);
    }
    
    .manual__search-help ul {
        list-style: none;
        margin: 0;
        padding: 0;
    }
    
    .manual__search-help li {
        margin-bottom: var(--space-1);
        padding-left: var(--space-4);
        position: relative;
        font-size: var(--text-sm);
    }
    
    .manual__search-help li::before {
        content: "‚Ä¢";
        position: absolute;
        left: 0;
        color: var(--manual-primary);
        font-weight: bold;
    }
    
    .manual__category--expanded .manual__category-items {
        max-height: none !important;
    }
`;

// CSS „ÇíÂãïÁöÑ„Å´ËøΩÂä†
const styleSheet = document.createElement('style');
styleSheet.textContent = searchHighlightCSS;
document.head.appendChild(styleSheet);

// DOM„ÅåË™≠„ÅøËæº„Åæ„Çå„Åü„Çâ„Éû„Éã„É•„Ç¢„É´„Ç∑„Çπ„ÉÜ„É†„ÇíÂàùÊúüÂåñ
document.addEventListener('DOMContentLoaded', () => {
    window.manualSystem = new ManualSystem();
});

// „Ç®„ÇØ„Çπ„Éù„Éº„ÉàÔºà„É¢„Ç∏„É•„Éº„É´ÂØæÂøúÔºâ
if (typeof module !== 'undefined' && module.exports) {
    module.exports = ManualSystem;
}