<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>出荷管理システム</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        /* ===== CSS変数定義（参考CSS準拠） ===== */
        :root {
            /* ライトモード - 基本カラー */
            --bg-primary: #f7f8f9;
            --bg-secondary: #fcfcfd;
            --bg-tertiary: #f0f1f3;
            --bg-hover: #e8f0fe;

            /* テキストカラー */
            --text-primary: #1f2937;
            --text-secondary: #4b5563;
            --text-tertiary: #6b7280;
            --text-white: #ffffff;

            /* アクセントカラー */
            --accent-purple: #8b5cf6;
            --accent-blue: #8b5cf6;
            --accent-green: #059669;
            --accent-red: #dc2626;
            --accent-yellow: #d97706;
            --accent-orange: #ea580c;

            /* 出荷専用カラー */
            --shukka-primary: #ea580c;
            --shukka-secondary: #f97316;
            --shukka-success: #16a34a;
            --shukka-warning: #d97706;
            --shukka-danger: #dc2626;
            --shukka-info: #0ea5e9;

            /* ステータスカラー */
            --status-new: #0ea5e9;
            --status-waiting: #d97706;
            --status-ready: #16a34a;
            --status-shipped: #8b5cf6;
            --status-transit: #6366f1;
            --status-delivered: #059669;
            --status-problem: #dc2626;

            /* シャドウ */
            --shadow-sm: 2px 2px 4px #d1d5db, -2px -2px 4px #ffffff;
            --shadow-md: 4px 4px 8px #d1d5db, -4px -4px 8px #ffffff;
            --shadow-lg: 8px 8px 16px #d1d5db, -8px -8px 16px #ffffff;

            /* スペーシング */
            --space-1: 0.25rem;
            --space-2: 0.5rem;
            --space-3: 0.75rem;
            --space-4: 1rem;
            --space-5: 1.25rem;
            --space-6: 1.5rem;
            --space-8: 2rem;

            /* フォントサイズ */
            --text-xs: 0.75rem;
            --text-sm: 0.875rem;
            --text-base: 1rem;
            --text-lg: 1.125rem;
            --text-xl: 1.25rem;
            --text-2xl: 1.5rem;
            --text-3xl: 1.875rem;

            /* ボーダーラジアス */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.25rem;

            /* トランジション */
            --transition: all 0.3s ease-in-out;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            font-size: 14px;
            line-height: 1.6;
            font-weight: 500;
        }

        /* ===== メインコンテナ ===== */
        .shukka-container {
            max-width: 1600px;
            margin: 0 auto;
            padding: var(--space-6);
            min-height: 100vh;
        }

        /* ===== ヘッダー（出荷方法・チェック項目表示） ===== */
        .shukka-header {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            padding: var(--space-6);
            margin-bottom: var(--space-6);
            box-shadow: var(--shadow-md);
            border: 1px solid #e2e8f0;
        }

        .shukka-header-main {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: var(--space-4);
        }

        .shukka-title {
            display: flex;
            align-items: center;
            gap: var(--space-3);
            font-size: var(--text-2xl);
            font-weight: 700;
            color: var(--text-primary);
        }

        .shukka-title-icon {
            width: 48px;
            height: 48px;
            background: linear-gradient(135deg, var(--shukka-primary), var(--shukka-secondary));
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-white);
            font-size: var(--text-xl);
            box-shadow: var(--shadow-sm);
        }

        .shukka-status {
            display: flex;
            align-items: center;
            gap: var(--space-4);
        }

        .status-badge {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-lg);
            font-weight: 600;
            font-size: var(--text-sm);
        }

        .status-badge--active {
            background: rgba(16, 185, 129, 0.1);
            color: var(--shukka-success);
            border: 1px solid rgba(16, 185, 129, 0.2);
        }

        /* 出荷方法・チェック項目ガイド */
        .shukka-guide {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: var(--space-4);
        }

        .guide-section {
            background: var(--bg-primary);
            border: 1px solid #e2e8f0;
            border-radius: var(--radius-lg);
            padding: var(--space-4);
        }

        .guide-section-title {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: var(--space-3);
            font-size: var(--text-sm);
        }

        .guide-items {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-2);
        }

        .guide-item {
            display: flex;
            align-items: center;
            gap: var(--space-1);
            padding: var(--space-1) var(--space-2);
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            color: var(--text-secondary);
            font-weight: 500;
        }

        .guide-item-icon {
            font-size: 10px;
        }

        /* ===== レイアウト ===== */
        .shukka-layout {
            display: grid;
            grid-template-columns: 480px 1fr;
            gap: var(--space-6);
            align-items: start;
        }

        /* ===== 左パネル：コンパクトリスト ===== */
        .list-panel {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid #e2e8f0;
            height: calc(100vh - 200px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .list-header {
            padding: var(--space-4) var(--space-5);
            border-bottom: 1px solid #e2e8f0;
            background: var(--bg-tertiary);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .list-title {
            font-size: var(--text-lg);
            font-weight: 600;
            color: var(--text-primary);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .list-count {
            background: var(--shukka-primary);
            color: var(--text-white);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            font-weight: 600;
        }

        .list-controls {
            padding: var(--space-3) var(--space-5);
            border-bottom: 1px solid #e2e8f0;
            background: var(--bg-primary);
            display: flex;
            gap: var(--space-3);
            align-items: center;
            flex-wrap: wrap;
        }

        .bulk-actions {
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .checkbox-all {
            width: 16px;
            height: 16px;
            accent-color: var(--shukka-primary);
        }

        .bulk-btn {
            padding: var(--space-1) var(--space-3);
            border: 1px solid var(--shukka-primary);
            background: var(--bg-secondary);
            color: var(--shukka-primary);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .bulk-btn:hover {
            background: var(--shukka-primary);
            color: var(--text-white);
        }

        .filter-tabs {
            display: flex;
            gap: var(--space-1);
        }

        .filter-tab {
            padding: var(--space-1) var(--space-3);
            border: none;
            background: var(--bg-tertiary);
            color: var(--text-secondary);
            border-radius: var(--radius-sm);
            font-size: var(--text-xs);
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
        }

        .filter-tab.active {
            background: var(--shukka-primary);
            color: var(--text-white);
        }

        .list-content {
            flex: 1;
            overflow-y: auto;
        }

        /* ===== 出荷アイテム（コンパクト） ===== */
        .shipping-item {
            display: grid;
            grid-template-columns: 16px 80px 1fr 100px;
            gap: var(--space-3);
            padding: var(--space-3) var(--space-5);
            border-bottom: 1px solid #f1f5f9;
            cursor: pointer;
            transition: var(--transition);
            align-items: center;
            min-height: 80px;
            position: relative;
        }

        .shipping-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 4px;
            background: var(--status-new);
        }

        /* ステータス別左ボーダー */
        .shipping-item[data-status="new"]::before { background: var(--status-new); }
        .shipping-item[data-status="waiting"]::before { background: var(--status-waiting); }
        .shipping-item[data-status="ready"]::before { background: var(--status-ready); }
        .shipping-item[data-status="shipped"]::before { background: var(--status-shipped); }
        .shipping-item[data-status="transit"]::before { background: var(--status-transit); }
        .shipping-item[data-status="delivered"]::before { background: var(--status-delivered); }
        .shipping-item[data-status="problem"]::before { background: var(--status-problem); }

        .shipping-item:hover {
            background: var(--bg-hover);
        }

        .shipping-item.selected {
            background: rgba(139, 92, 246, 0.05);
            border-color: var(--accent-purple);
        }

        .item-checkbox {
            width: 16px;
            height: 16px;
            accent-color: var(--shukka-primary);
        }

        .item-image {
            width: 80px;
            height: 60px;
            object-fit: cover;
            border-radius: var(--radius-sm);
            border: 1px solid #e2e8f0;
        }

        .item-main {
            min-width: 0;
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }

        .item-id {
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: var(--text-xs);
            font-weight: 600;
            color: var(--text-tertiary);
        }

        .item-title {
            font-size: var(--text-sm);
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.3;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .item-customer {
            font-size: var(--text-xs);
            color: var(--text-secondary);
            font-weight: 500;
        }

        .item-status-info {
            display: flex;
            align-items: center;
            gap: var(--space-1);
            font-size: var(--text-xs);
            color: var(--text-tertiary);
        }

        .item-meta {
            display: flex;
            flex-direction: column;
            align-items: flex-end;
            gap: var(--space-1);
        }

        .priority-indicator {
            display: flex;
            align-items: center;
            gap: var(--space-1);
        }

        .priority-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--text-tertiary);
        }

        .priority-dot.high {
            background: var(--shukka-danger);
            animation: pulse 2s infinite;
        }

        .priority-dot.medium {
            background: var(--shukka-warning);
        }

        .priority-dot.low {
            background: var(--text-tertiary);
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .country-info {
            display: flex;
            align-items: center;
            gap: var(--space-1);
            font-size: var(--text-xs);
        }

        .country-flag {
            font-size: 14px;
        }

        .shipping-method {
            font-size: var(--text-xs);
            font-weight: 600;
            color: var(--text-secondary);
            padding: var(--space-1) var(--space-2);
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
        }

        .deadline-info {
            font-size: var(--text-xs);
            color: var(--shukka-danger);
            font-weight: 600;
        }

        /* ===== 右パネル：詳細表示 ===== */
        .detail-panel {
            background: var(--bg-secondary);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid #e2e8f0;
            height: calc(100vh - 200px);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .detail-header {
            padding: var(--space-4) var(--space-5);
            border-bottom: 1px solid #e2e8f0;
            background: linear-gradient(135deg, var(--shukka-primary), var(--shukka-secondary));
            color: var(--text-white);
        }

        .detail-title {
            font-size: var(--text-lg);
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .detail-content {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-5);
        }

        .detail-empty {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: var(--text-tertiary);
            text-align: center;
        }

        .detail-empty-icon {
            font-size: 48px;
            margin-bottom: var(--space-4);
            opacity: 0.5;
        }

        .detail-empty-text {
            font-size: var(--text-lg);
            font-weight: 500;
        }

        /* ===== 詳細表示カード ===== */
        .detail-sections {
            display: flex;
            flex-direction: column;
            gap: var(--space-4);
        }

        .detail-section {
            background: var(--bg-primary);
            border: 1px solid #e2e8f0;
            border-radius: var(--radius-lg);
            overflow: hidden;
        }

        .section-header {
            padding: var(--space-3) var(--space-4);
            background: var(--bg-tertiary);
            border-bottom: 1px solid #e2e8f0;
            font-weight: 600;
            color: var(--text-primary);
            font-size: var(--text-sm);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .section-content {
            padding: var(--space-4);
        }

        .product-overview {
            display: grid;
            grid-template-columns: 120px 1fr;
            gap: var(--space-4);
            margin-bottom: var(--space-4);
        }

        .product-image-large {
            width: 120px;
            height: 100px;
            object-fit: cover;
            border-radius: var(--radius-md);
            border: 1px solid #e2e8f0;
        }

        .product-details h3 {
            font-size: var(--text-lg);
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: var(--space-2);
        }

        .product-badges {
            display: flex;
            gap: var(--space-2);
            margin-bottom: var(--space-2);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-3);
        }

        .info-item {
            display: flex;
            flex-direction: column;
            gap: var(--space-1);
        }

        .info-label {
            font-size: var(--text-xs);
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: var(--text-sm);
            font-weight: 600;
            color: var(--text-primary);
        }

        .copyable {
            cursor: pointer;
            padding: var(--space-1) var(--space-2);
            background: var(--bg-tertiary);
            border: 1px solid #e2e8f0;
            border-radius: var(--radius-sm);
            font-family: 'Monaco', 'Consolas', monospace;
            transition: var(--transition);
            display: inline-block;
        }

        .copyable:hover {
            background: var(--shukka-primary);
            color: var(--text-white);
            border-color: var(--shukka-primary);
        }

        .status-badge-large {
            padding: var(--space-2) var(--space-3);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-badge-large.new {
            background: rgba(14, 165, 233, 0.1);
            color: var(--status-new);
        }

        .status-badge-large.waiting {
            background: rgba(217, 119, 6, 0.1);
            color: var(--status-waiting);
        }

        .status-badge-large.ready {
            background: rgba(22, 163, 74, 0.1);
            color: var(--status-ready);
        }

        /* チェックリスト */
        .checklist {
            display: flex;
            flex-direction: column;
            gap: var(--space-2);
        }

        .checklist-item {
            display: flex;
            align-items: center;
            gap: var(--space-2);
            padding: var(--space-2);
            background: var(--bg-secondary);
            border-radius: var(--radius-sm);
            border: 1px solid #f1f5f9;
        }

        .checklist-checkbox {
            width: 16px;
            height: 16px;
            accent-color: var(--shukka-success);
        }

        .checklist-text {
            font-size: var(--text-sm);
            color: var(--text-primary);
        }

        .checklist-item.completed {
            background: rgba(22, 163, 74, 0.05);
            border-color: rgba(22, 163, 74, 0.2);
        }

        .checklist-item.completed .checklist-text {
            text-decoration: line-through;
            color: var(--text-secondary);
        }

        /* アクションボタン */
        .action-buttons {
            display: flex;
            gap: var(--space-3);
            flex-wrap: wrap;
            margin-top: var(--space-4);
        }

        .btn {
            padding: var(--space-2) var(--space-4);
            border-radius: var(--radius-md);
            font-size: var(--text-sm);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            border: 2px solid;
            background: var(--bg-secondary);
            display: flex;
            align-items: center;
            gap: var(--space-2);
        }

        .btn-primary {
            background: var(--shukka-primary);
            color: var(--text-white);
            border-color: var(--shukka-primary);
        }

        .btn-primary:hover {
            background: var(--shukka-secondary);
            border-color: var(--shukka-secondary);
        }

        .btn-secondary {
            color: var(--text-secondary);
            border-color: #e2e8f0;
        }

        .btn-secondary:hover {
            background: var(--bg-hover);
            color: var(--text-primary);
            border-color: var(--text-secondary);
        }

        /* ===== レスポンシブ ===== */
        @media (max-width: 1200px) {
            .shukka-layout {
                grid-template-columns: 400px 1fr;
            }
        }

        @media (max-width: 768px) {
            .shukka-layout {
                grid-template-columns: 1fr;
                grid-template-rows: 60vh 40vh;
            }
            
            .shukka-container {
                padding: var(--space-4);
            }
            
            .shukka-header {
                padding: var(--space-4);
            }
            
            .list-panel,
            .detail-panel {
                height: auto;
            }
        }

        /* ===== カスタムスクロールバー ===== */
        .list-content::-webkit-scrollbar,
        .detail-content::-webkit-scrollbar {
            width: 6px;
        }

        .list-content::-webkit-scrollbar-track,
        .detail-content::-webkit-scrollbar-track {
            background: var(--bg-tertiary);
        }

        .list-content::-webkit-scrollbar-thumb,
        .detail-content::-webkit-scrollbar-thumb {
            background: var(--text-tertiary);
            border-radius: var(--radius-sm);
        }

        .list-content::-webkit-scrollbar-thumb:hover,
        .detail-content::-webkit-scrollbar-thumb:hover {
            background: var(--shukka-primary);
        }
    </style>
<script>
// CAIDS error_handling Hook

// CAIDS エラー処理Hook - 完全実装
window.CAIDS_ERROR_HANDLER = {
    isActive: true,
    errorCount: 0,
    errorHistory: [],
    
    initialize: function() {
        this.setupGlobalErrorHandler();
        this.setupUnhandledPromiseRejection();
        this.setupNetworkErrorHandler();
        console.log('⚠️ CAIDS エラーハンドリングシステム完全初期化');
    },
    
    setupGlobalErrorHandler: function() {
        window.addEventListener('error', (event) => {
            this.handleError({
                type: 'JavaScript Error',
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                stack: event.error?.stack
            });
        });
    },
    
    setupUnhandledPromiseRejection: function() {
        window.addEventListener('unhandledrejection', (event) => {
            this.handleError({
                type: 'Unhandled Promise Rejection',
                message: event.reason?.message || String(event.reason),
                stack: event.reason?.stack
            });
        });
    },
    
    setupNetworkErrorHandler: function() {
        const originalFetch = window.fetch;
        window.fetch = async function(...args) {
            try {
                const response = await originalFetch.apply(this, args);
                if (!response.ok) {
                    window.CAIDS_ERROR_HANDLER.handleError({
                        type: 'Network Error',
                        message: `HTTP ${response.status}: ${response.statusText}`,
                        url: args[0]
                    });
                }
                return response;
            } catch (error) {
                window.CAIDS_ERROR_HANDLER.handleError({
                    type: 'Network Fetch Error',
                    message: error.message,
                    url: args[0]
                });
                throw error;
            }
        };
    },
    
    handleError: function(errorInfo) {
        this.errorCount++;
        this.errorHistory.push({...errorInfo, timestamp: new Date().toISOString()});
        
        console.error('🚨 CAIDS Error Handler:', errorInfo);
        this.showErrorNotification(errorInfo);
        this.reportError(errorInfo);
    },
    
    showErrorNotification: function(errorInfo) {
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = `
            position: fixed; top: 10px; right: 10px; z-index: 999999;
            background: linear-gradient(135deg, #ff4444, #cc0000);
            color: white; padding: 15px 20px; border-radius: 8px;
            max-width: 350px; box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            font-size: 13px; font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            border: 2px solid #ff6666; animation: caids-error-shake 0.5s ease-in-out;
        `;
        errorDiv.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 18px;">🚨</span>
                <div>
                    <strong>エラーが発生しました</strong><br>
                    <small style="opacity: 0.9;">${errorInfo.type}: ${errorInfo.message}</small>
                </div>
            </div>
        `;
        
        // CSS Animation
        if (!document.getElementById('caids-error-styles')) {
            const style = document.createElement('style');
            style.id = 'caids-error-styles';
            style.textContent = `
                @keyframes caids-error-shake {
                    0%, 100% { transform: translateX(0); }
                    25% { transform: translateX(-5px); }
                    75% { transform: translateX(5px); }
                }
            `;
            document.head.appendChild(style);
        }
        
        document.body.appendChild(errorDiv);
        setTimeout(() => errorDiv.remove(), 7000);
    },
    
    reportError: function(errorInfo) {
        // エラーレポート生成・送信（将来の拡張用）
        const report = {
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            url: window.location.href,
            errorCount: this.errorCount,
            sessionId: this.getSessionId(),
            ...errorInfo
        };
        
        console.log('📋 CAIDS Error Report:', report);
        localStorage.setItem('caids_last_error', JSON.stringify(report));
    },
    
    getSessionId: function() {
        let sessionId = sessionStorage.getItem('caids_session_id');
        if (!sessionId) {
            sessionId = 'caids_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            sessionStorage.setItem('caids_session_id', sessionId);
        }
        return sessionId;
    },
    
    getErrorStats: function() {
        return {
            totalErrors: this.errorCount,
            recentErrors: this.errorHistory.slice(-10),
            sessionId: this.getSessionId()
        };
    }
};

window.CAIDS_ERROR_HANDLER.initialize();

</script>
<script>
// CAIDS user_feedback Hook
// CAIDS user_feedback Hook - 基本実装
console.log('✅ user_feedback Hook loaded');
</script>
<script>
// CAIDS character_limit Hook
// CAIDS character_limit Hook - 基本実装
console.log('✅ character_limit Hook loaded');
</script>
<script>
// CAIDS natural_explanation Hook
// CAIDS natural_explanation Hook - 基本実装
console.log('✅ natural_explanation Hook loaded');
</script>
<script>
// CAIDS emergency_accumulation Hook
// CAIDS emergency_accumulation Hook - 基本実装
console.log('✅ emergency_accumulation Hook loaded');
</script>
<script>
// CAIDS processing_capacity_monitoring Hook
// CAIDS processing_capacity_monitoring Hook - 基本実装
console.log('✅ processing_capacity_monitoring Hook loaded');
</script>
<script>
// CAIDS pre_analysis_enforcement Hook
// CAIDS pre_analysis_enforcement Hook - 基本実装
console.log('✅ pre_analysis_enforcement Hook loaded');
</script>
<script>
// CAIDS user_approval_required Hook
// CAIDS user_approval_required Hook - 基本実装
console.log('✅ user_approval_required Hook loaded');
</script>
<script>
// CAIDS timeout_management Hook
// CAIDS timeout_management Hook - 基本実装
console.log('✅ timeout_management Hook loaded');
</script>
<script>
// CAIDS development_control Hook
// CAIDS development_control Hook - 基本実装
console.log('✅ development_control Hook loaded');
</script>
</head>
<body>
    <div class="shukka-container">
        <!-- ヘッダー：出荷方法・チェック項目ガイド -->
        <div class="shukka-header">
            <div class="shukka-header-main">
                <div class="shukka-title">
                    <div class="shukka-title-icon">
                        <i class="fas fa-shipping-fast"></i>
                    </div>
                    <span>出荷管理システム</span>
                </div>
                <div class="shukka-status">
                    <div class="status-badge status-badge--active">
                        <i class="fas fa-circle" style="font-size: 8px;"></i>
                        <span>システム稼働中</span>
                    </div>
                    <div class="status-badge" style="background: rgba(234, 88, 12, 0.1); color: var(--shukka-primary); border: 1px solid rgba(234, 88, 12, 0.2);">
                        <i class="fas fa-clock"></i>
                        <span>15件 要対応</span>
                    </div>
                </div>
            </div>
            
            <div class="shukka-guide">
                <div class="guide-section">
                    <div class="guide-section-title">
                        <i class="fas fa-truck guide-item-icon" style="color: var(--shukka-primary);"></i>
                        配送方法
                    </div>
                    <div class="guide-items">
                        <div class="guide-item">
                            <i class="fas fa-plane guide-item-icon" style="color: var(--status-info);"></i>
                            DHL Express
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-ship guide-item-icon" style="color: var(--status-transit);"></i>
                            EMS
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-mail-bulk guide-item-icon" style="color: var(--status-ready);"></i>
                            国際書留
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-truck guide-item-icon" style="color: var(--status-warning);"></i>
                            FedEx
                        </div>
                    </div>
                </div>
                
                <div class="guide-section">
                    <div class="guide-section-title">
                        <i class="fas fa-tasks guide-item-icon" style="color: var(--shukka-success);"></i>
                        必須チェック項目
                    </div>
                    <div class="guide-items">
                        <div class="guide-item">
                            <i class="fas fa-weight guide-item-icon" style="color: var(--status-ready);"></i>
                            重量・サイズ
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-file-invoice guide-item-icon" style="color: var(--status-info);"></i>
                            HSコード
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-exclamation-triangle guide-item-icon" style="color: var(--status-warning);"></i>
                            危険物判定
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-shield-alt guide-item-icon" style="color: var(--status-shipped);"></i>
                            保険・サイン
                        </div>
                    </div>
                </div>
                
                <div class="guide-section">
                    <div class="guide-section-title">
                        <i class="fas fa-clock guide-item-icon" style="color: var(--shukka-danger);"></i>
                        期限・優先度
                    </div>
                    <div class="guide-items">
                        <div class="guide-item">
                            <i class="fas fa-circle guide-item-icon" style="color: var(--shukka-danger);"></i>
                            緊急（24h以内）
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-circle guide-item-icon" style="color: var(--status-warning);"></i>
                            高（3日以内）
                        </div>
                        <div class="guide-item">
                            <i class="fas fa-circle guide-item-icon" style="color: var(--text-tertiary);"></i>
                            通常（1週間）
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- メインレイアウト -->
        <div class="shukka-layout">
            <!-- 左パネル：コンパクトリスト -->
            <div class="list-panel">
                <div class="list-header">
                    <div class="list-title">
                        <i class="fas fa-list"></i>
                        出荷待ちリスト
                        <span class="list-count">23</span>
                    </div>
                </div>
                
                <div class="list-controls">
                    <div class="bulk-actions">
                        <input type="checkbox" class="checkbox-all" id="selectAll">
                        <button class="bulk-btn" onclick="printSelected()">
                            <i class="fas fa-print"></i> 印刷
                        </button>
                        <button class="bulk-btn" onclick="exportSelected()">
                            <i class="fas fa-download"></i> 出力
                        </button>
                    </div>
                    <div class="filter-tabs">
                        <button class="filter-tab active">全て</button>
                        <button class="filter-tab">新規</button>
                        <button class="filter-tab">準備中</button>
                        <button class="filter-tab">緊急</button>
                    </div>
                </div>

                <div class="list-content">
                    <!-- 出荷アイテム 1 -->
                    <div class="shipping-item" data-status="new" onclick="selectItem(this, 1)">
                        <input type="checkbox" class="item-checkbox" onclick="event.stopPropagation()">
                        <img src="https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=80&h=60&fit=crop&crop=center" 
                             alt="商品画像" class="item-image">
                        <div class="item-main">
                            <div class="item-id">EB001-20241213</div>
                            <div class="item-title">Vintage Camera Set Premium Collection</div>
                            <div class="item-customer">山田 太郎（東京都）</div>
                            <div class="item-status-info">
                                <i class="fas fa-exclamation-triangle" style="color: var(--status-warning);"></i>
                                危険物チェック要
                            </div>
                        </div>
                        <div class="item-meta">
                            <div class="priority-indicator">
                                <div class="priority-dot high"></div>
                                <span style="font-size: var(--text-xs); color: var(--shukka-danger); font-weight: 600;">緊急</span>
                            </div>
                            <div class="country-info">
                                <span class="country-flag">🇺🇸</span>
                                <span>USA</span>
                            </div>
                            <div class="shipping-method">DHL</div>
                            <div class="deadline-info">残り18時間</div>
                        </div>
                    </div>

                    <!-- 出荷アイテム 2 -->
                    <div class="shipping-item" data-status="waiting" onclick="selectItem(this, 2)">
                        <input type="checkbox" class="item-checkbox" onclick="event.stopPropagation()">
                        <img src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=80&h=60&fit=crop&crop=center" 
                             alt="商品画像" class="item-image">
                        <div class="item-main">
                            <div class="item-id">EB002-20241213</div>
                            <div class="item-title">Nike Air Max Limited Edition</div>
                            <div class="item-customer">佐藤 花子（大阪府）</div>
                            <div class="item-status-info">
                                <i class="fas fa-check-circle" style="color: var(--status-ready);"></i>
                                商品到着済み
                            </div>
                        </div>
                        <div class="item-meta">
                            <div class="priority-indicator">
                                <div class="priority-dot medium"></div>
                                <span style="font-size: var(--text-xs); color: var(--status-warning); font-weight: 600;">高</span>
                            </div>
                            <div class="country-info">
                                <span class="country-flag">🇩🇪</span>
                                <span>DEU</span>
                            </div>
                            <div class="shipping-method">DPD</div>
                            <div class="deadline-info">残り2日</div>
                        </div>
                    </div>

                    <!-- 出荷アイテム 3 -->
                    <div class="shipping-item" data-status="ready" onclick="selectItem(this, 3)">
                        <input type="checkbox" class="item-checkbox" onclick="event.stopPropagation()">
                        <img src="https://images.unsplash.com/photo-1581235720704-06d3acfcb36f?w=80&h=60&fit=crop&crop=center" 
                             alt="商品画像" class="item-image">
                        <div class="item-main">
                            <div class="item-id">EB003-20241213</div>
                            <div class="item-title">Mechanical Keyboard RGB Gaming</div>
                            <div class="item-customer">田中 一郎（愛知県）</div>
                            <div class="item-status-info">
                                <i class="fas fa-box" style="color: var(--status-ready);"></i>
                                梱包完了
                            </div>
                        </div>
                        <div class="item-meta">
                            <div class="priority-indicator">
                                <div class="priority-dot low"></div>
                                <span style="font-size: var(--text-xs); color: var(--text-tertiary); font-weight: 600;">通常</span>
                            </div>
                            <div class="country-info">
                                <span class="country-flag">🇫🇷</span>
                                <span>FRA</span>
                            </div>
                            <div class="shipping-method">COLISSIMO</div>
                            <div class="deadline-info">残り5日</div>
                        </div>
                    </div>

                    <!-- 出荷アイテム 4 -->
                    <div class="shipping-item" data-status="shipped" onclick="selectItem(this, 4)">
                        <input type="checkbox" class="item-checkbox" onclick="event.stopPropagation()">
                        <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=80&h=60&fit=crop&crop=center" 
                             alt="商品画像" class="item-image">
                        <div class="item-main">
                            <div class="item-id">EB004-20241213</div>
                            <div class="item-title">Wireless Headphones Premium</div>
                            <div class="item-customer">鈴木 美香（福岡県）</div>
                            <div class="item-status-info">
                                <i class="fas fa-truck" style="color: var(--status-shipped);"></i>
                                出荷済み
                            </div>
                        </div>
                        <div class="item-meta">
                            <div class="priority-indicator">
                                <div class="priority-dot high"></div>
                                <span style="font-size: var(--text-xs); color: var(--shukka-danger); font-weight: 600;">緊急</span>
                            </div>
                            <div class="country-info">
                                <span class="country-flag">🇬🇧</span>
                                <span>GBR</span>
                            </div>
                            <div class="shipping-method">ROYAL MAIL</div>
                            <div class="deadline-info">配送中</div>
                        </div>
                    </div>

                    <!-- 出荷アイテム 5 -->
                    <div class="shipping-item" data-status="problem" onclick="selectItem(this, 5)">
                        <input type="checkbox" class="item-checkbox" onclick="event.stopPropagation()">
                        <img src="https://images.unsplash.com/photo-1560472355-536de3962603?w=80&h=60&fit=crop&crop=center" 
                             alt="商品画像" class="item-image">
                        <div class="item-main">
                            <div class="item-id">EB005-20241213</div>
                            <div class="item-title">Smart Watch Series X</div>
                            <div class="item-customer">高橋 健太（北海道）</div>
                            <div class="item-status-info">
                                <i class="fas fa-exclamation-circle" style="color: var(--status-problem);"></i>
                                住所不備
                            </div>
                        </div>
                        <div class="item-meta">
                            <div class="priority-indicator">
                                <div class="priority-dot high"></div>
                                <span style="font-size: var(--text-xs); color: var(--shukka-danger); font-weight: 600;">緊急</span>
                            </div>
                            <div class="country-info">
                                <span class="country-flag">🇨🇦</span>
                                <span>CAN</span>
                            </div>
                            <div class="shipping-method">CANADA POST</div>
                            <div class="deadline-info">要確認</div>
                        </div>
                    </div>

                    <!-- その他のアイテム... -->
                </div>
            </div>

            <!-- 右パネル：詳細表示 -->
            <div class="detail-panel">
                <div class="detail-header">
                    <div class="detail-title">
                        <i class="fas fa-info-circle"></i>
                        出荷詳細情報
                    </div>
                </div>
                
                <div class="detail-content">
                    <div class="detail-empty">
                        <div class="detail-empty-icon">
                            <i class="fas fa-mouse-pointer"></i>
                        </div>
                        <div class="detail-empty-text">
                            左のリストから出荷アイテムを<br>選択してください
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // サンプル詳細データ
        const shippingDetails = {
            1: {
                id: "EB001-20241213",
                title: "Vintage Camera Set Premium Collection",
                customer: "山田 太郎",
                status: "new",
                priority: "high",
                country: "🇺🇸 United States",
                method: "DHL Express",
                image: "https://images.unsplash.com/photo-1523275335684-37898b6baf30?w=300&h=200&fit=crop&crop=center",
                weight: "2.8kg",
                dimensions: "35×28×18cm",
                value: "¥52,000",
                hsCode: "9006.10.00",
                address: "123 Main Street, New York, NY 10001, USA",
                tracking: "",
                notes: "危険物チェック必須 - リチウム電池含有の可能性",
                deadline: "18時間後",
                checklist: [
                    { id: 1, text: "商品到着確認", completed: true },
                    { id: 2, text: "商品検品", completed: true },
                    { id: 3, text: "危険物判定", completed: false },
                    { id: 4, text: "重量・サイズ測定", completed: false },
                    { id: 5, text: "HSコード確認", completed: false },
                    { id: 6, text: "梱包材選定", completed: false },
                    { id: 7, text: "配送方法確定", completed: false },
                    { id: 8, text: "保険・サイン設定", completed: false },
                    { id: 9, text: "伝票作成", completed: false },
                    { id: 10, text: "最終確認", completed: false }
                ]
            },
            2: {
                id: "EB002-20241213",
                title: "Nike Air Max Limited Edition",
                customer: "佐藤 花子",
                status: "waiting",
                priority: "medium",
                country: "🇩🇪 Deutschland",
                method: "DPD Standard",
                image: "https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=300&h=200&fit=crop&crop=center",
                weight: "1.5kg",
                dimensions: "32×22×14cm",
                value: "¥28,500",
                hsCode: "6402.19.00",
                address: "Hauptstraße 42, 10115 Berlin, Deutschland",
                tracking: "",
                notes: "土曜配達希望",
                deadline: "2日後",
                checklist: [
                    { id: 1, text: "商品到着確認", completed: true },
                    { id: 2, text: "商品検品", completed: true },
                    { id: 3, text: "危険物判定", completed: true },
                    { id: 4, text: "重量・サイズ測定", completed: false },
                    { id: 5, text: "HSコード確認", completed: true },
                    { id: 6, text: "梱包材選定", completed: false },
                    { id: 7, text: "配送方法確定", completed: true },
                    { id: 8, text: "保険・サイン設定", completed: false },
                    { id: 9, text: "伝票作成", completed: false },
                    { id: 10, text: "最終確認", completed: false }
                ]
            }
        };

        function selectItem(element, itemId) {
            // 前の選択を削除
            document.querySelectorAll('.shipping-item').forEach(item => {
                item.classList.remove('selected');
            });
            
            // 選択を追加
            element.classList.add('selected');
            
            // 詳細表示
            showDetail(itemId);
        }

        function showDetail(itemId) {
            const detail = shippingDetails[itemId];
            if (!detail) return;

            const detailContent = document.querySelector('.detail-content');
            
            // チェック完了数計算
            const completedCount = detail.checklist.filter(item => item.completed).length;
            const totalCount = detail.checklist.length;
            const completionRate = Math.round((completedCount / totalCount) * 100);
            
            detailContent.innerHTML = `
                <div class="detail-sections">
                    <!-- 商品概要 -->
                    <div class="detail-section">
                        <div class="section-header">
                            <i class="fas fa-box"></i>
                            商品情報
                        </div>
                        <div class="section-content">
                            <div class="product-overview">
                                <img src="${detail.image}" alt="商品画像" class="product-image-large">
                                <div class="product-details">
                                    <h3>${detail.title}</h3>
                                    <div class="product-badges">
                                        <div class="status-badge-large ${detail.status}">${getStatusText(detail.status)}</div>
                                        <div class="status-badge-large" style="background: rgba(234, 88, 12, 0.1); color: var(--shukka-primary);">
                                            優先度: ${getPriorityText(detail.priority)}
                                        </div>
                                    </div>
                                    <div class="copyable" onclick="copyToClipboard('${detail.hsCode}')" title="クリックでコピー">
                                        HSコード: ${detail.hsCode}
                                    </div>
                                </div>
                            </div>
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">受注番号</div>
                                    <div class="info-value copyable" onclick="copyToClipboard('${detail.id}')">${detail.id}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">重量</div>
                                    <div class="info-value">${detail.weight}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">サイズ</div>
                                    <div class="info-value">${detail.dimensions}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">商品価値</div>
                                    <div class="info-value">${detail.value}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">出荷期限</div>
                                    <div class="info-value" style="color: var(--shukka-danger); font-weight: 700;">${detail.deadline}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 顧客・配送情報 -->
                    <div class="detail-section">
                        <div class="section-header">
                            <i class="fas fa-user"></i>
                            顧客・配送情報
                        </div>
                        <div class="section-content">
                            <div class="info-grid">
                                <div class="info-item">
                                    <div class="info-label">顧客名</div>
                                    <div class="info-value">${detail.customer}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">配送先国</div>
                                    <div class="info-value">${detail.country}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">配送方法</div>
                                    <div class="info-value">${detail.method}</div>
                                </div>
                                <div class="info-item">
                                    <div class="info-label">追跡番号</div>
                                    <div class="info-value">${detail.tracking || '未発行'}</div>
                                </div>
                            </div>
                            <div class="info-item" style="margin-top: var(--space-3);">
                                <div class="info-label">配送先住所</div>
                                <div class="info-value copyable" onclick="copyToClipboard('${detail.address}')">${detail.address}</div>
                            </div>
                            ${detail.notes ? `
                                <div class="info-item" style="margin-top: var(--space-3);">
                                    <div class="info-label">注意事項</div>
                                    <div class="info-value" style="color: var(--shukka-danger); font-weight: 600; background: rgba(220, 38, 38, 0.1); padding: var(--space-2); border-radius: var(--radius-sm);">
                                        <i class="fas fa-exclamation-triangle" style="margin-right: var(--space-1);"></i>
                                        ${detail.notes}
                                    </div>
                                </div>
                            ` : ''}
                        </div>
                    </div>

                    <!-- チェックリスト -->
                    <div class="detail-section">
                        <div class="section-header">
                            <i class="fas fa-tasks"></i>
                            作業チェックリスト
                            <div style="margin-left: auto; font-size: var(--text-xs); background: var(--shukka-primary); color: var(--text-white); padding: var(--space-1) var(--space-2); border-radius: var(--radius-sm);">
                                ${completedCount}/${totalCount} (${completionRate}%)
                            </div>
                        </div>
                        <div class="section-content">
                            <div class="checklist">
                                ${detail.checklist.map(item => `
                                    <div class="checklist-item ${item.completed ? 'completed' : ''}">
                                        <input type="checkbox" class="checklist-checkbox" ${item.completed ? 'checked' : ''} 
                                               onchange="toggleChecklistItem(${itemId}, ${item.id}, this.checked)">
                                        <span class="checklist-text">${item.text}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    </div>

                    <!-- アクション -->
                    <div class="detail-section">
                        <div class="section-header">
                            <i class="fas fa-cogs"></i>
                            アクション
                        </div>
                        <div class="section-content">
                            <div class="action-buttons">
                                <button class="btn btn-primary" onclick="executeShipping(${itemId})">
                                    <i class="fas fa-truck"></i>
                                    出荷実行
                                </button>
                                <button class="btn btn-secondary" onclick="printLabel(${itemId})">
                                    <i class="fas fa-print"></i>
                                    ラベル印刷
                                </button>
                                <button class="btn btn-secondary" onclick="printInvoice(${itemId})">
                                    <i class="fas fa-file-invoice"></i>
                                    インボイス
                                </button>
                                <button class="btn btn-secondary" onclick="editItem(${itemId})">
                                    <i class="fas fa-edit"></i>
                                    編集
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getStatusText(status) {
            const statusMap = {
                'new': '新規',
                'waiting': '待機中',
                'ready': '準備完了',
                'shipped': '出荷済み',
                'transit': '配送中',
                'delivered': '配達完了',
                'problem': '問題あり'
            };
            return statusMap[status] || status;
        }

        function getPriorityText(priority) {
            const priorityMap = {
                'high': '緊急',
                'medium': '高',
                'low': '通常'
            };
            return priorityMap[priority] || priority;
        }

        function toggleChecklistItem(itemId, checkId, completed) {
            if (shippingDetails[itemId]) {
                const item = shippingDetails[itemId].checklist.find(c => c.id === checkId);
                if (item) {
                    item.completed = completed;
                    // リストを更新（実際のシステムではサーバーに送信）
                    showDetail(itemId);
                }
            }
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('コピーしました: ' + text, 'success');
            });
        }

        function showNotification(message, type = 'info') {
            // 通知表示（簡易版）
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: var(--shukka-success);
                color: white;
                padding: var(--space-3) var(--space-4);
                border-radius: var(--radius-md);
                box-shadow: var(--shadow-lg);
                z-index: 10000;
                font-weight: 600;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        function printSelected() {
            const selected = document.querySelectorAll('.item-checkbox:checked');
            showNotification(`${selected.length}件の印刷を開始します`, 'info');
        }

        function exportSelected() {
            const selected = document.querySelectorAll('.item-checkbox:checked');
            showNotification(`${selected.length}件のデータを出力します`, 'info');
        }

        function executeShipping(itemId) {
            showNotification('出荷処理を開始しました', 'success');
        }

        function printLabel(itemId) {
            showNotification('ラベルを印刷しています', 'info');
        }

        function printInvoice(itemId) {
            showNotification('インボイスを印刷しています', 'info');
        }

        function editItem(itemId) {
            showNotification('編集画面を開きます', 'info');
        }

        // 全選択機能
        document.getElementById('selectAll').addEventListener('change', function() {
            const checkboxes = document.querySelectorAll('.item-checkbox');
            checkboxes.forEach(cb => cb.checked = this.checked);
        });

        // フィルター機能
        document.querySelectorAll('.filter-tab').forEach(tab => {
            tab.addEventListener('click', function() {
                document.querySelectorAll('.filter-tab').forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                // フィルター処理（実装省略）
                showNotification(`フィルター: ${this.textContent}`, 'info');
            });
        });
    </script>
</body>
</html>