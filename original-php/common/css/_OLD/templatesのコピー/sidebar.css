# ğŸ”§ NAGANO-3 ä¸è¶³ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸

## ğŸ“ **1. sidebar.css ä½œæˆ**

**ãƒ•ã‚¡ã‚¤ãƒ«ä½œæˆ**: `common/css/components/sidebar.css`

```css
/**
 * ğŸ¯ sidebar.css - ã‚µã‚¤ãƒ‰ãƒãƒ¼å°‚ç”¨CSS
 * common/css/components/sidebar.css
 * 
 * âœ… BEMå‘½åè¦å‰‡æº–æ‹ 
 * âœ… CSSå¤‰æ•°æ´»ç”¨
 * âœ… ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ
 */

/* ===================================== */
/* ğŸ¨ ã‚µã‚¤ãƒ‰ãƒãƒ¼åŸºæœ¬è¨­å®š */
/* ===================================== */

.sidebar {
    position: fixed;
    top: 0;
    left: 0;
    height: 100vh;
    width: var(--sidebar-width, 220px);
    background: var(--sidebar-bg, #1f2937);
    color: var(--sidebar-text, #ffffff);
    transition: width 0.3s ease;
    z-index: 1000;
    overflow: hidden;
    box-shadow: 2px 0 8px rgba(0, 0, 0, 0.1);
}

/* ç¸®å°çŠ¶æ…‹ */
.sidebar--collapsed {
    width: 60px;
}

/* å±•é–‹çŠ¶æ…‹ */
.sidebar--expanded {
    width: 220px;
}

/* ===================================== */
/* ğŸ§­ ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ */
/* ===================================== */

.navigation {
    padding: var(--space-4, 1rem) 0;
}

.navigation__list {
    list-style: none;
    margin: 0;
    padding: 0;
}

.navigation__item {
    margin-bottom: var(--space-2, 0.5rem);
}

.navigation__link {
    display: flex;
    align-items: center;
    padding: var(--space-3, 0.75rem) var(--space-4, 1rem);
    color: inherit;
    text-decoration: none;
    transition: background-color 0.2s ease;
    border-radius: 0 25px 25px 0;
    margin-right: var(--space-4, 1rem);
}

.navigation__link:hover {
    background: rgba(255, 255, 255, 0.1);
}

.navigation__link--active {
    background: var(--color-primary, #059669);
    color: white;
}

.navigation__icon {
    width: 20px;
    height: 20px;
    margin-right: var(--space-3, 0.75rem);
    flex-shrink: 0;
}

.navigation__text {
    font-size: 0.9rem;
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease, visibility 0.3s ease;
    white-space: nowrap;
}

/* ===================================== */
/* ğŸ”„ ãƒˆã‚°ãƒ«æ©Ÿèƒ½ */
/* ===================================== */

.sidebar-toggle {
    position: absolute;
    top: var(--space-4, 1rem);
    right: var(--space-4, 1rem);
    background: rgba(255, 255, 255, 0.1);
    border: none;
    color: white;
    width: 32px;
    height: 32px;
    border-radius: 50%;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease;
}

.sidebar-toggle:hover {
    background: rgba(255, 255, 255, 0.2);
}

.toggle-text {
    opacity: 1;
    visibility: visible;
    transition: opacity 0.3s ease, visibility 0.3s ease;
}

/* ===================================== */
/* ğŸ“± ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ */
/* ===================================== */

/* ç¸®å°æ™‚ã®ãƒ†ã‚­ã‚¹ãƒˆéè¡¨ç¤º */
[data-sidebar="collapsed"] .navigation__text,
[data-sidebar="collapsed"] .toggle-text,
.sidebar--collapsed .navigation__text,
.sidebar--collapsed .toggle-text {
    opacity: 0;
    visibility: hidden;
}

/* ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ */
@media (max-width: 768px) {
    .sidebar {
        transform: translateX(-100%);
        transition: transform 0.3s ease;
    }
    
    .sidebar--mobile-open {
        transform: translateX(0);
    }
    
    .sidebar--collapsed {
        transform: translateX(-100%);
    }
}

/* ===================================== */
/* ğŸ¨ ãƒ–ãƒ©ãƒ³ãƒ‡ã‚£ãƒ³ã‚° */
/* ===================================== */

.sidebar__header {
    padding: var(--space-6, 1.5rem) var(--space-4, 1rem);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    margin-bottom: var(--space-4, 1rem);
}

.sidebar__logo {
    font-size: 1.25rem;
    font-weight: 600;
    color: var(--color-primary, #059669);
}

.sidebar__version {
    font-size: 0.75rem;
    opacity: 0.7;
    margin-top: var(--space-1, 0.25rem);
}

/* ===================================== */
/* ğŸ”§ ã‚µãƒ–ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */
/* ===================================== */

.submenu {
    position: absolute;
    left: 220px;
    top: 0;
    background: var(--sidebar-bg, #1f2937);
    border-radius: var(--radius-lg, 0.5rem);
    box-shadow: var(--shadow-lg, 0 10px 15px -3px rgba(0, 0, 0, 0.1));
    padding: var(--space-2, 0.5rem);
    min-width: 180px;
    opacity: 0;
    visibility: hidden;
    transition: opacity 0.2s ease, visibility 0.2s ease;
    z-index: 1001;
}

.navigation__item:hover .submenu {
    opacity: 1;
    visibility: visible;
}

.submenu__list {
    list-style: none;
    margin: 0;
    padding: 0;
}

.submenu__item {
    margin-bottom: var(--space-1, 0.25rem);
}

.submenu__link {
    display: block;
    padding: var(--space-2, 0.5rem) var(--space-3, 0.75rem);
    color: inherit;
    text-decoration: none;
    border-radius: var(--radius-md, 0.375rem);
    font-size: 0.85rem;
    transition: background-color 0.2s ease;
}

.submenu__link:hover {
    background: rgba(255, 255, 255, 0.1);
}

/* ===================================== */
/* ğŸ¯ ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£ */
/* ===================================== */

.sidebar:focus-within {
    outline: 2px solid var(--color-primary, #059669);
    outline-offset: -2px;
}

.navigation__link:focus {
    outline: 2px solid var(--color-primary, #059669);
    outline-offset: -2px;
}

/* ===================================== */
/* ğŸ”„ ã‚¢ãƒ‹ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³ */
/* ===================================== */

@keyframes slideIn {
    from {
        transform: translateX(-100%);
    }
    to {
        transform: translateX(0);
    }
}

@keyframes slideOut {
    from {
        transform: translateX(0);
    }
    to {
        transform: translateX(-100%);
    }
}

.sidebar--animating {
    animation: slideIn 0.3s ease-out;
}

/* ===================================== */
/* ğŸ¨ ãƒ€ãƒ¼ã‚¯ãƒ¢ãƒ¼ãƒ‰å¯¾å¿œ */
/* ===================================== */

[data-theme="dark"] .sidebar {
    background: var(--dark-sidebar-bg, #111827);
    color: var(--dark-sidebar-text, #f9fafb);
}

[data-theme="dark"] .navigation__link:hover {
    background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .sidebar-toggle {
    background: rgba(255, 255, 255, 0.05);
}

[data-theme="dark"] .sidebar-toggle:hover {
    background: rgba(255, 255, 255, 0.1);
}
```

## ğŸ“ **2. main.js ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒ©ãƒ¼ä¿®æ­£**

**ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£**: `common/js/main.js` ã®ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒˆã‚°ãƒ«é–¢æ•°

```javascript
/**
 * ğŸ”„ ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒˆã‚°ãƒ«æ©Ÿèƒ½ï¼ˆä¿®æ­£ç‰ˆï¼‰
 */
window.toggleSidebar = function() {
    console.log('ğŸ”„ ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒˆã‚°ãƒ«å®Ÿè¡Œé–‹å§‹');
    
    try {
        const sidebar = document.querySelector('.sidebar');
        const body = document.body;
        const root = document.documentElement;
        
        // ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¦ç´ ã®æ¤œç´¢ï¼ˆè¤‡æ•°ã®å¯èƒ½æ€§ã‚’è€ƒæ…®ï¼‰
        const mainContent = document.querySelector('.main-content') || 
                           document.querySelector('.content') || 
                           document.querySelector('.page-content') ||
                           document.querySelector('main') ||
                           document.querySelector('#main') ||
                           document.querySelector('.container');
        
        if (!sidebar) {
            console.error('âŒ ã‚µã‚¤ãƒ‰ãƒãƒ¼è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“');
            return;
        }
        
        if (!mainContent) {
            console.warn('âš ï¸ ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„è¦ç´ ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ - ã‚µã‚¤ãƒ‰ãƒãƒ¼ã®ã¿èª¿æ•´');
        }
        
        // ç¾åœ¨ã®çŠ¶æ…‹ç¢ºèª
        const isCollapsed = body.getAttribute('data-sidebar') === 'collapsed' ||
                           sidebar.classList.contains('sidebar--collapsed');
        
        if (isCollapsed) {
            // å±•é–‹å‡¦ç†
            console.log('ğŸ”¹ ã‚µã‚¤ãƒ‰ãƒãƒ¼å±•é–‹å‡¦ç†é–‹å§‹');
            
            // CSSå¤‰æ•°ã‚’å‹•çš„å¤‰æ›´
            root.style.setProperty('--sidebar-width', '220px');
            body.setAttribute('data-sidebar', 'expanded');
            
            sidebar.classList.remove('sidebar--collapsed');
            sidebar.classList.add('sidebar--expanded');
            sidebar.style.width = '220px';
            
            // ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª¿æ•´ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿ï¼‰
            if (mainContent) {
                mainContent.style.marginLeft = '220px';
                mainContent.style.maxWidth = 'calc(100vw - 220px)';
            }
            
            // ãƒ†ã‚­ã‚¹ãƒˆè¡¨ç¤º
            setTimeout(() => {
                const sidebarTexts = sidebar.querySelectorAll('.sidebar-text, .toggle-text, .navigation__text');
                sidebarTexts.forEach(text => {
                    text.style.opacity = '1';
                    text.style.visibility = 'visible';
                });
            }, 100);
            
            console.log('âœ… ã‚µã‚¤ãƒ‰ãƒãƒ¼å±•é–‹å®Œäº†');
            
        } else {
            // ç¸®å°å‡¦ç†
            console.log('ğŸ”¹ ã‚µã‚¤ãƒ‰ãƒãƒ¼ç¸®å°å‡¦ç†é–‹å§‹');
            
            // ãƒ†ã‚­ã‚¹ãƒˆéè¡¨ç¤º
            const sidebarTexts = sidebar.querySelectorAll('.sidebar-text, .toggle-text, .navigation__text');
            sidebarTexts.forEach(text => {
                text.style.opacity = '0';
                text.style.visibility = 'hidden';
            });
            
            setTimeout(() => {
                root.style.setProperty('--sidebar-width', '60px');
                body.setAttribute('data-sidebar', 'collapsed');
                
                sidebar.classList.add('sidebar--collapsed');
                sidebar.classList.remove('sidebar--expanded');
                sidebar.style.width = '60px';
                
                // ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„èª¿æ•´ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿ï¼‰
                if (mainContent) {
                    mainContent.style.marginLeft = '60px';
                    mainContent.style.maxWidth = 'calc(100vw - 60px)';
                }
            }, 200);
            
            console.log('âœ… ã‚µã‚¤ãƒ‰ãƒãƒ¼ç¸®å°å®Œäº†');
        }
        
        // é€šçŸ¥è¡¨ç¤ºï¼ˆé–¢æ•°ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®ã¿ï¼‰
        if (typeof showNotification === 'function') {
            showNotification(
                `ã‚µã‚¤ãƒ‰ãƒãƒ¼ã‚’${isCollapsed ? 'å±•é–‹' : 'ç¸®å°'}ã—ã¾ã—ãŸ`, 
                'info'
            );
        }
        
    } catch (error) {
        console.error('âŒ ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒˆã‚°ãƒ«å¤±æ•—:', error);
        
        if (typeof showNotification === 'function') {
            showNotification('ã‚µã‚¤ãƒ‰ãƒãƒ¼æ“ä½œã§ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'error');
        }
    }
};
```

## ğŸ“ **3. style.css ã« sidebar.css ã‚¤ãƒ³ãƒãƒ¼ãƒˆè¿½åŠ **

**ãƒ•ã‚¡ã‚¤ãƒ«ä¿®æ­£**: `common/css/style.css`

```css
/* æ—¢å­˜ã®ã‚¤ãƒ³ãƒãƒ¼ãƒˆæ–‡ã®ä¸‹ã«è¿½åŠ  */
@import url('components/sidebar.css');
```

## ğŸ“ **4. çµ±åˆãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã® test_error_handling å®Ÿè£…**

**ä¿®æ­£ç®‡æ‰€**: `kicho_integrated_system_test_fixed.php` ã®switchæ–‡å†…

```php
case 'test_error_handling':
    // ã‚ã–ã¨ã‚¨ãƒ©ãƒ¼ã‚’ç™ºç”Ÿã•ã›ã¦ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚’ãƒ†ã‚¹ãƒˆ
    throw new Exception('ãƒ†ã‚¹ãƒˆç”¨ã‚¨ãƒ©ãƒ¼: ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°æ©Ÿèƒ½ã®ç¢ºèªãƒ†ã‚¹ãƒˆ');
    break;
```

## ğŸš€ **å®Ÿè£…æ‰‹é †**

### **Step 1: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ**
```bash
mkdir -p common/css/components
```

### **Step 2: sidebar.css ä½œæˆ**
```bash
# ä¸Šè¨˜ã®sidebar.cssã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦ä½œæˆ
cat > common/css/components/sidebar.css << 'EOF'
[ä¸Šè¨˜ã®CSSã‚³ãƒ¼ãƒ‰ã‚’ã“ã“ã«è²¼ã‚Šä»˜ã‘]
EOF
```

### **Step 3: style.css ä¿®æ­£**
```bash
# style.cssã®æœ«å°¾ã«è¿½åŠ 
echo "@import url('components/sidebar.css');" >> common/css/style.css
```

### **Step 4: main.js ä¿®æ­£**
```bash
# main.jsã®toggleSidebaré–¢æ•°ã‚’ä¸Šè¨˜ã®ä¿®æ­£ç‰ˆã«ç½®ãæ›ãˆ
```

### **Step 5: æ¨©é™è¨­å®š**
```bash
chmod 644 common/css/components/sidebar.css
chmod 644 common/css/style.css
chmod 644 common/js/main.js
```

## âœ… **ä¿®æ­£å¾Œã®æœŸå¾…çµæœ**

1. **sidebar.css 404ã‚¨ãƒ©ãƒ¼è§£æ¶ˆ**: CSSãƒ•ã‚¡ã‚¤ãƒ«ãŒæ­£å¸¸ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹
2. **ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒ©ãƒ¼è§£æ¶ˆ**: è¤‡æ•°ã®è¦ç´ å€™è£œã‹ã‚‰æ¤œç´¢ã—ã¦ã‚¨ãƒ©ãƒ¼ã‚’å›é¿
3. **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ãƒ†ã‚¹ãƒˆæ­£å¸¸å‹•ä½œ**: æœŸå¾…é€šã‚Šã®ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã™
4. **ã‚µã‚¤ãƒ‰ãƒãƒ¼ãƒˆã‚°ãƒ«æ­£å¸¸å‹•ä½œ**: CSSå¤‰æ•°ã¨ã‚¯ãƒ©ã‚¹åˆ¶å¾¡ãŒé©åˆ‡ã«æ©Ÿèƒ½

## ğŸ” **å‹•ä½œç¢ºèªæ–¹æ³•**

```javascript
// ãƒ–ãƒ©ã‚¦ã‚¶ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã§å®Ÿè¡Œ
console.log('=== NAGANO-3 ä¿®æ­£ç¢ºèª ===');

// 1. ã‚µã‚¤ãƒ‰ãƒãƒ¼CSSç¢ºèª
const sidebarStyles = getComputedStyle(document.querySelector('.sidebar'));
console.log('ã‚µã‚¤ãƒ‰ãƒãƒ¼CSS:', sidebarStyles.width);

// 2. ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç¢ºèª
const mainContent = document.querySelector('.main-content, .content, .page-content, main, #main, .container');
console.log('ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„:', mainContent ? 'ç™ºè¦‹' : 'è¦‹ã¤ã‹ã‚‰ãš');

// 3. toggleSidebaré–¢æ•°ç¢ºèª
console.log('toggleSidebaré–¢æ•°:', typeof window.toggleSidebar);

// 4. ãƒ‡ãƒãƒƒã‚°å®Ÿè¡Œ
if (typeof window.debugSidebar === 'function') {
    window.debugSidebar();
}
```

ã“ã®ä¿®æ­£ã«ã‚ˆã‚Šã€ã™ã¹ã¦ã®ã‚¨ãƒ©ãƒ¼ãŒè§£æ¶ˆã•ã‚Œã€çµ±åˆã‚·ã‚¹ãƒ†ãƒ ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚