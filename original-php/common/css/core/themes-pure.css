/* ===== NAGANO-3 テーマ修正版 - サイドバーテキスト可視性改善 ===== */
/* 📁 common/css/core/themes-pure.css */

/*
 * 🎯 既存のmain.js["light", "dark", "gentle"]と完全互換
 * 🔧 common.cssの既存変数を全て維持
 * 🎨 gentleモードの色味を完全修正
 * ✅ JavaScript toggleTheme() 完全対応
 * 🔧 サイドバーテキスト可視性問題解決
 */

/* ===== 既存の共通変数はそのまま維持 ===== */
/* common.css の変数定義を変更せず、上書きのみ */

/* ===== 1. Light Mode - 既存デフォルトそのまま ===== */
:root,
[data-theme="light"] {
  /* common.cssのデフォルト値をそのまま使用 */
  /* 変更なし - 既存の動作を保持 */

  /* サイドバー専用変数追加 */
  --sidebar-bg: #2c3e50;
  --sidebar-text: rgba(255, 255, 255, 0.9);
  --sidebar-text-hover: #ffffff;
  --sidebar-text-active: #ffffff;
  --sidebar-border: rgba(255, 255, 255, 0.1);
}

/* ===== 2. Dark Mode - 既存定義そのまま ===== */
[data-theme="dark"] {
  /* common.cssの既存定義をそのまま使用 */
  /* 変更なし - 既存の動作を保持 */

  /* サイドバー専用変数追加 */
  --sidebar-bg: #1e293b;
  --sidebar-text: rgba(255, 255, 255, 0.9);
  --sidebar-text-hover: #ffffff;
  --sidebar-text-active: #ffffff;
  --sidebar-border: rgba(255, 255, 255, 0.1);
}

/* ===== 3. Gentle Mode - 色味のみ完全修正 + サイドバー可視性改善 ===== */
[data-theme="gentle"] {
  /* 背景色 - 既存構造維持・色味のみ調整 */
  --bg-primary: #faf9f7;
  /* わずかに暖色調整 */
  --bg-secondary: #f5f3f0;
  /* ベージュ系に調整 */
  --bg-tertiary: #f0ede8;
  /* より暖かみ */
  --bg-hover: #ebe6df;
  /* ホバー時も暖色 */
  --bg-active: #e5dfd6;
  /* アクティブも統一 */

  /* テキスト色 - 読みやすさ重視で調整 */
  --text-primary: #2d2a26;
  /* より濃く調整（元: #4a453f） */
  --text-secondary: #4a4037;
  /* より濃く調整（元: #6b5f52） */
  --text-tertiary: #6b5d4f;
  /* より濃く調整（元: #8a7d70） */
  --text-muted: #8a7d70;
  /* より濃く調整（元: #a3968a） */
  --text-white: #ffffff;
  /* 変更なし */

  /* ボーダー・シャドウ - 既存構造で色味調整 */
  --border-color: #e8e1d8;
  /* ベージュ系境界 */
  --border-light: #ede7de;
  /* ライトボーダー */
  --border-dark: #ddd4c8;
  /* ダークボーダー */
  --shadow-sm: 0 1px 3px rgba(45, 42, 38, 0.12);
  /* より濃く */
  --shadow-md: 0 4px 12px rgba(45, 42, 38, 0.15);
  /* より濃く */
  --shadow-lg: 0 8px 32px rgba(45, 42, 38, 0.18);
  /* より濃く */
  --shadow-dark: rgba(45, 42, 38, 0.08);
  /* より濃く */

  /* プライマリカラー - 完全修正（明るすぎる紫→落ち着いた色） */
  --color-primary: #6b5d4f;
  /* より濃く調整（元: #7c6f5c） */
  --color-secondary: #7a6b56;
  /* セカンダリも調整 */
  --color-success: #5a7a4f;
  /* 緑系も調整 */
  --color-warning: #a3845f;
  /* きつい黄色 → 暖かいベージュ */
  --color-danger: #a56455;
  /* 赤系も調整 */

  /* アクセント色 - 全て調整（既存変数名維持） */
  --accent-blue: #6b8499;
  /* 青系を落ち着かせる */
  --accent-purple: #7a6b8a;
  /* 明るすぎる紫 → 落ち着いた紫 */
  --accent-green: #5a7a4f;
  /* 緑系調整 */
  --accent-yellow: #a3845f;
  /* きつい黄色 → 完全修正 */
  --accent-red: #a56455;
  /* 赤系調整 */
  --accent-orange: #b5885d;
  /* オレンジ系調整 */

  /* 🔧 サイドバー専用変数（gentle mode用） */
  --sidebar-bg: #5a5045;
  /* 暖色系ダーク */
  --sidebar-text: #f5f3f0;
  /* 明るいベージュテキスト */
  --sidebar-text-hover: #ffffff;
  /* ホバー時は純白 */
  --sidebar-text-active: #ffffff;
  /* アクティブ時は純白 */
  --sidebar-border: rgba(245, 243, 240, 0.15);
  /* 薄いベージュボーダー */
  --sidebar-hover-bg: rgba(245, 243, 240, 0.1);
  /* ホバー背景 */
  --sidebar-active-bg: #6b5d4f;
  /* アクティブ背景 */
}

/* ===== 4番目・5番目のテーマ追加（main.js対応版） ===== */

/* 4番目のテーマ: Vivid Mode（main.jsで追加が必要） */
[data-theme="vivid"] {
  /* 明るく活き活きとした色彩 */
  --bg-primary: #ffffff;
  --bg-secondary: #fdfdfe;
  --bg-tertiary: #f8fcff;
  --bg-hover: #f0f9ff;
  --bg-active: #e0f2fe;

  --text-primary: #0f172a;
  --text-secondary: #334155;
  --text-tertiary: #475569;
  --text-muted: #64748b;
  --text-white: #ffffff;

  --border-color: #e2e8f0;
  --border-light: #f1f5f9;
  --border-dark: #cbd5e1;
  --shadow-sm: 0 1px 3px rgba(15, 23, 42, 0.08);
  --shadow-md: 0 4px 12px rgba(15, 23, 42, 0.12);
  --shadow-lg: 0 8px 32px rgba(15, 23, 42, 0.15);
  --shadow-dark: rgba(15, 23, 42, 0.06);

  /* 鮮やかで若々しい色 */
  --color-primary: #06b6d4;
  --color-secondary: #0891b2;
  --color-success: #10b981;
  --color-warning: #f59e0b;
  --color-danger: #ef4444;

  --accent-blue: #06b6d4;
  --accent-purple: #8b5cf6;
  --accent-green: #10b981;
  --accent-yellow: #f59e0b;
  --accent-red: #ef4444;
  --accent-orange: #f97316;

  /* サイドバー専用変数 */
  --sidebar-bg: #1e293b;
  --sidebar-text: rgba(255, 255, 255, 0.9);
  --sidebar-text-hover: #ffffff;
  --sidebar-text-active: #ffffff;
  --sidebar-border: rgba(255, 255, 255, 0.1);
}

/* 5番目のテーマ: Ocean Mode（main.jsで追加が必要） */
[data-theme="ocean"] {
  /* 海をイメージした癒し系 */
  --bg-primary: #f0f9ff;
  --bg-secondary: #e0f2fe;
  --bg-tertiary: #bae6fd;
  --bg-hover: #7dd3fc;
  --bg-active: #38bdf8;

  --text-primary: #0c4a6e;
  --text-secondary: #075985;
  --text-tertiary: #0369a1;
  --text-muted: #0284c7;
  --text-white: #ffffff;

  --border-color: #bae6fd;
  --border-light: #e0f2fe;
  --border-dark: #7dd3fc;
  --shadow-sm: 0 1px 3px rgba(12, 74, 110, 0.15);
  --shadow-md: 0 4px 12px rgba(12, 74, 110, 0.20);
  --shadow-lg: 0 8px 32px rgba(12, 74, 110, 0.25);
  --shadow-dark: rgba(12, 74, 110, 0.1);

  /* 海洋系の色彩 */
  --color-primary: #0ea5e9;
  --color-secondary: #0284c7;
  --color-success: #059669;
  --color-warning: #d97706;
  --color-danger: #dc2626;

  --accent-blue: #0ea5e9;
  --accent-purple: #6366f1;
  --accent-green: #059669;
  --accent-yellow: #d97706;
  --accent-red: #dc2626;
  --accent-orange: #ea580c;

  /* サイドバー専用変数 */
  --sidebar-bg: #0c4a6e;
  --sidebar-text: rgba(255, 255, 255, 0.9);
  --sidebar-text-hover: #ffffff;
  --sidebar-text-active: #ffffff;
  --sidebar-border: rgba(255, 255, 255, 0.1);
}

/* ===== サイドバー専用スタイル強化（全テーマ対応） ===== */

/* サイドバー基本スタイル */
.sidebar {
  background: var(--sidebar-bg, #2c3e50) !important;
  border-right: 1px solid var(--sidebar-border, rgba(255, 255, 255, 0.1)) !important;
}

/* サイドバーリンク・ラベル */
.sidebar-link,
.submenu-label {
  color: var(--sidebar-text, rgba(255, 255, 255, 0.9)) !important;
  transition: all 0.2s ease !important;
}

.sidebar-link:hover,
.submenu-label:hover {
  color: var(--sidebar-text-hover, #ffffff) !important;
  background: var(--sidebar-hover-bg, rgba(52, 152, 219, 0.3)) !important;
}

.sidebar-link--active {
  color: var(--sidebar-text-active, #ffffff) !important;
  background: var(--sidebar-active-bg, var(--color-primary, #3498db)) !important;
  font-weight: 600 !important;
}

/* サイドバーアイコン */
.sidebar-icon {
  color: inherit !important;
  opacity: 0.9 !important;
}

.sidebar-link:hover .sidebar-icon,
.submenu-label:hover .sidebar-icon {
  opacity: 1 !important;
}

/* サイドバーテキスト */
.sidebar-text {
  color: inherit !important;
}

/* 矢印アイコン */
.arrow {
  color: var(--sidebar-text, rgba(255, 255, 255, 0.6)) !important;
  opacity: 0.6 !important;
  transition: transform 0.3s ease, opacity 0.2s ease !important;
}

.submenu-label:hover .arrow {
  color: var(--sidebar-text-hover, #ffffff) !important;
  opacity: 1 !important;
  transform: rotate(90deg) !important;
}

/* サブメニュー */
.submenu {
  background: rgba(0, 0, 0, 0.2) !important;
  border-left: 3px solid var(--color-primary, #3498db) !important;
}

.submenu-link {
  color: var(--sidebar-text, rgba(255, 255, 255, 0.8)) !important;
  border-bottom: 1px solid var(--sidebar-border, rgba(255, 255, 255, 0.05)) !important;
  transition: all 0.2s ease !important;
}

.submenu-link:hover {
  color: var(--sidebar-text-hover, #ffffff) !important;
  background: var(--sidebar-hover-bg, rgba(52, 152, 219, 0.3)) !important;
  padding-left: 24px !important;
}

.submenu-link::before {
  color: var(--color-primary, #3498db) !important;
}

/* トグルボタン */
.toggle-button {
  background: var(--sidebar-hover-bg, rgba(0, 0, 0, 0.2)) !important;
  color: var(--sidebar-text, rgba(255, 255, 255, 0.8)) !important;
  border: 1px solid var(--sidebar-border, rgba(255, 255, 255, 0.1)) !important;
}

.toggle-button:hover {
  background: var(--color-primary, #3498db) !important;
  color: var(--sidebar-text-hover, #ffffff) !important;
}

/* ===== 既存システムとの互換性確保 ===== */

/* 全テーマ共通：スムーズトランジション */
* {
  transition:
    background-color var(--transition-normal, 0.3s ease),
    color var(--transition-normal, 0.3s ease),
    border-color var(--transition-normal, 0.3s ease),
    box-shadow var(--transition-normal, 0.3s ease);
}

/* 既存コンポーネントの色変数適用を確実にする */
.dashboard__stat-card,
.kicho__overview-card,
.zaiko__table,
.shohin__table {
  background: var(--bg-secondary) !important;
  border: 1px solid var(--border-color) !important;
  color: var(--text-primary) !important;
}

.btn--primary {
  background: var(--color-primary) !important;
  color: var(--text-white) !important;
}

.btn--primary:hover {
  background: var(--color-secondary) !important;
}

.form-input,
.kicho__form-input,
.zaiko__search-input--compact {
  background: var(--bg-secondary) !important;
  border: 1px solid var(--border-color) !important;
  color: var(--text-primary) !important;
}

.form-input:focus,
.kicho__form-input:focus,
.zaiko__search-input--compact:focus {
  border-color: var(--color-primary) !important;
}

/* テーマ切り替えボタンのアイコン更新 */
.theme-switcher {
  transition: var(--transition-normal);
}

[data-theme="light"] .theme-switcher i::before {
  content: "\f185";
  /* fa-sun */
}

[data-theme="dark"] .theme-switcher i::before {
  content: "\f186";
  /* fa-moon */
}

[data-theme="gentle"] .theme-switcher i::before {
  content: "\f06c";
  /* fa-leaf */
}

[data-theme="vivid"] .theme-switcher i::before {
  content: "\f75a";
  /* fa-rainbow */
}

[data-theme="ocean"] .theme-switcher i::before {
  content: "\f773";
  /* fa-water */
}

/* ===== 強制適用（重要度最高） ===== */

/* サイドバーテキストの強制可視化 */
.sidebar .sidebar-link,
.sidebar .submenu-label,
.sidebar .sidebar-text,
.sidebar .submenu-link {
  color: var(--sidebar-text, rgba(255, 255, 255, 0.9)) !important;
  font-weight: 500 !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1) !important;
}

/* ホバー状態の強制適用 */
.sidebar .sidebar-link:hover,
.sidebar .submenu-label:hover,
.sidebar .submenu-link:hover {
  color: var(--sidebar-text-hover, #ffffff) !important;
  font-weight: 600 !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2) !important;
}

/* アクティブ状態の強制適用 */
.sidebar .sidebar-link--active {
  color: var(--sidebar-text-active, #ffffff) !important;
  font-weight: 700 !important;
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
}

/* ===== レスポンシブ対応 ===== */
@media (max-width: 768px) {

  /* モバイルでのテーマ切り替え調整 */
  .theme-switcher {
    width: 36px;
    height: 36px;
  }

  /* モバイルでのサイドバーテキスト強化 */
  .sidebar .sidebar-link,
  .sidebar .submenu-label {
    font-size: 14px !important;
    padding: 12px 16px !important;
  }
}

/* ===== アクセシビリティ ===== */
@media (prefers-reduced-motion: reduce) {
  * {
    transition: none !important;
  }
}

/* 高コントラストモード対応 */
@media (prefers-contrast: high) {

  .sidebar .sidebar-link,
  .sidebar .submenu-label,
  .sidebar .submenu-link {
    color: #ffffff !important;
    font-weight: 600 !important;
  }
}

/* ===== 印刷対応 ===== */
@media print {
  * {
    background: white !important;
    color: black !important;
    box-shadow: none !important;
  }

  .sidebar {
    display: none !important;
  }
}

/* ===== デバッグ情報（開発用） ===== */
.theme-debug-info {
  position: fixed;
  bottom: 10px;
  right: 10px;
  background: var(--bg-secondary);
  border: 1px solid var(--border-color);
  border-radius: var(--radius-md, 8px);
  padding: 8px 12px;
  font-size: 12px;
  font-family: monospace;
  z-index: 9999;
  opacity: 0.8;
}

/* URLパラメータでdebug=1の時のみ表示 */
body:not([data-debug="true"]) .theme-debug-info {
  display: none;
}

/* ===== テーマ固有の特殊効果（オプション） ===== */

/* Vivid Mode: グラデーション効果 */
[data-theme="vivid"] .dashboard__stat-card {
  background: linear-gradient(135deg, var(--bg-secondary), var(--bg-tertiary)) !important;
}

[data-theme="vivid"] .btn--primary {
  background: linear-gradient(135deg, var(--color-primary), var(--color-secondary)) !important;
  box-shadow: 0 4px 15px rgba(6, 182, 212, 0.3) !important;
}

/* Ocean Mode: 波紋効果 */
[data-theme="ocean"] .btn:hover {
  position: relative;
  overflow: hidden;
}

[data-theme="ocean"] .btn:hover::before {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  width: 0;
  height: 0;
  background: rgba(255, 255, 255, 0.2);
  border-radius: 50%;
  transform: translate(-50%, -50%);
  animation: ripple 0.6s ease-out;
}

@keyframes ripple {
  to {
    width: 300px;
    height: 300px;
    opacity: 0;
  }
}

/* Gentle Mode: ソフトな境界 */
[data-theme="gentle"] * {
  border-radius: calc(var(--radius-md, 8px) * 1.2);
}

[data-theme="gentle"] .dashboard__stat-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(45, 42, 38, 0.15) !important;
}

/* ===== main.js テーマ配列更新用コメント ===== */
/*
修正版main.jsではすでに3テーマ対応されています：
const themes = ["light", "dark", "gentle"];

5テーマ版に変更する場合：
const themes = ["light", "dark", "gentle", "vivid", "ocean"];
*/