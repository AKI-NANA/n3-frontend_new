<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸš€ CAIDSåŒ…æ‹¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸ - å®Œå…¨å®Ÿè¨¼ç‰ˆ</title>
    <style>
        :root {
            --primary-color: #2563eb;
            --secondary-color: #7c3aed;
            --success-color: #059669;
            --warning-color: #d97706;
            --error-color: #dc2626;
            --background: #f8fafc;
            --surface: #ffffff;
            --text-primary: #1e293b;
            --text-secondary: #64748b;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif; background: var(--background); color: var(--text-primary); line-height: 1.6; }
        .app-container { min-height: 100vh; display: flex; flex-direction: column; }
        .header { background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); color: white; padding: 2rem; text-align: center; box-shadow: var(--shadow); }
        .header h1 { font-size: 2.5rem; font-weight: 700; margin-bottom: 0.5rem; }
        .header-subtitle { font-size: 1.2rem; opacity: 0.9; margin-bottom: 1rem; }
        .test-controls { display: flex; gap: 1rem; justify-content: center; flex-wrap: wrap; }
        .btn { padding: 0.75rem 1.5rem; border: none; border-radius: 0.5rem; font-weight: 600; cursor: pointer; transition: all 0.2s; text-decoration: none; display: inline-flex; align-items: center; gap: 0.5rem; }
        .btn-primary { background: var(--success-color); color: white; }
        .btn-secondary { background: rgba(255, 255, 255, 0.2); color: white; border: 1px solid rgba(255, 255, 255, 0.3); }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15); }
        .main-content { flex: 1; padding: 2rem; max-width: 1400px; margin: 0 auto; width: 100%; }
        .test-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 2rem; margin-bottom: 2rem; }
        .test-section { background: var(--surface); border-radius: 1rem; padding: 2rem; box-shadow: var(--shadow); border: 1px solid var(--border); }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid var(--border); }
        .section-header h3 { font-size: 1.25rem; font-weight: 700; color: var(--text-primary); }
        .status-indicator { padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.75rem; font-weight: 600; }
        .status-ready { background: var(--success-color); color: white; }
        .console-section { grid-column: 1 / -1; background: #1e293b; color: #f1f5f9; border-radius: 1rem; overflow: hidden; }
        .console-header { background: #334155; padding: 1rem; display: flex; justify-content: space-between; align-items: center; }
        .console-tabs { display: flex; gap: 0.5rem; }
        .console-tab { padding: 0.5rem 1rem; background: transparent; color: #94a3b8; border: none; border-radius: 0.25rem; cursor: pointer; transition: all 0.2s; }
        .console-tab.active { background: var(--primary-color); color: white; }
        .console-content { padding: 1rem; height: 300px; overflow-y: auto; font-family: 'Monaco', 'Consolas', monospace; font-size: 0.875rem; }
        .log-entry { margin-bottom: 0.25rem; display: flex; gap: 0.5rem; }
        .log-timestamp { color: #64748b; min-width: 80px; }
        .log-level { min-width: 60px; font-weight: 600; }
        .log-level.success { color: #10b981; }
        .log-level.error { color: #ef4444; }
        .log-level.warning { color: #f59e0b; }
        .log-level.info { color: #3b82f6; }
        .log-message { flex: 1; }
        .btn-sm { padding: 0.5rem 1rem; font-size: 0.875rem; }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: none; justify-content: center; align-items: center; z-index: 1000; }
        .modal-content { background: white; border-radius: 1rem; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3); }
        .modal-header { padding: 1.5rem; border-bottom: 1px solid var(--border); display: flex; justify-content: space-between; align-items: center; }
        .modal-close { background: none; border: none; font-size: 1.5rem; cursor: pointer; color: var(--text-secondary); }
        .modal-body { padding: 1.5rem; }
    </style>
<script>
// CAIDS error_handling Hook

// CAIDS ã‚¨ãƒ©ãƒ¼å‡¦ç†Hook - å®Œå…¨å®Ÿè£…
window.CAIDS_ERROR_HANDLER = {
    isActive: true,
    errorCount: 0,
    errorHistory: [],
    
    initialize: function() {
        this.setupGlobalErrorHandler();
        this.setupUnhandledPromiseRejection();
        this.setupNetworkErrorHandler();
        console.log('âš ï¸ CAIDS ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ å®Œå…¨åˆæœŸåŒ–');
    },
    
    setupGlobalErrorHandler: function() {
        window.addEventListener('error', (event) => {
            this.handleError({
                type: 'JavaScript Error',
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                stack: event.error?.stack
            });
        });
    },
    
    setupUnhandledPromiseRejection: function() {
        window.addEventListener('unhandledrejection', (event) => {
            this.handleError({
                type: 'Unhandled Promise Rejection',
                message: event.reason?.message || String(event.reason),
                stack: event.reason?.stack
            });
        });
    },
    
    setupNetworkErrorHandler: function() {
        const originalFetch = window.fetch;
        window.fetch = async function(...args) {
            try {
                const response = await originalFetch.apply(this, args);
                if (!response.ok) {
                    window.CAIDS_ERROR_HANDLER.handleError({
                        type: 'Network Error',
                        message: `HTTP ${response.status}: ${response.statusText}`,
                        url: args[0]
                    });
                }
                return response;
            } catch (error) {
                window.CAIDS_ERROR_HANDLER.handleError({
                    type: 'Network Fetch Error',
                    message: error.message,
                    url: args[0]
                });
                throw error;
            }
        };
    },
    
    handleError: function(errorInfo) {
        this.errorCount++;
        this.errorHistory.push({...errorInfo, timestamp: new Date().toISOString()});
        
        console.error('ğŸš¨ CAIDS Error Handler:', errorInfo);
        this.showErrorNotification(errorInfo);
        this.reportError(errorInfo);
    },
    
    showErrorNotification: function(errorInfo) {
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = `
            position: fixed; top: 10px; right: 10px; z-index: 999999;
            background: linear-gradient(135deg, #ff4444, #cc0000);
            color: white; padding: 15px 20px; border-radius: 8px;
            max-width: 350px; box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            font-size: 13px; font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            border: 2px solid #ff6666; animation: caids-error-shake 0.5s ease-in-out;
        `;
        errorDiv.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 18px;">ğŸš¨</span>
                <div>
                    <strong>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ</strong><br>
                    <small style="opacity: 0.9;">${errorInfo.type}: ${errorInfo.message}</small>
                </div>
            </div>
        `;
        
        // CSS Animation
        if (!document.getElementById('caids-error-styles')) {
            const style = document.createElement('style');
            style.id = 'caids-error-styles';
            style.textContent = `
                @keyframes caids-error-shake {
                    0%, 100% { transform: translateX(0); }
                    25% { transform: translateX(-5px); }
                    75% { transform: translateX(5px); }
                }
            `;
            document.head.appendChild(style);
        }
        
        document.body.appendChild(errorDiv);
        setTimeout(() => errorDiv.remove(), 7000);
    },
    
    reportError: function(errorInfo) {
        // ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆãƒ»é€ä¿¡ï¼ˆå°†æ¥ã®æ‹¡å¼µç”¨ï¼‰
        const report = {
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            url: window.location.href,
            errorCount: this.errorCount,
            sessionId: this.getSessionId(),
            ...errorInfo
        };
        
        console.log('ğŸ“‹ CAIDS Error Report:', report);
        localStorage.setItem('caids_last_error', JSON.stringify(report));
    },
    
    getSessionId: function() {
        let sessionId = sessionStorage.getItem('caids_session_id');
        if (!sessionId) {
            sessionId = 'caids_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            sessionStorage.setItem('caids_session_id', sessionId);
        }
        return sessionId;
    },
    
    getErrorStats: function() {
        return {
            totalErrors: this.errorCount,
            recentErrors: this.errorHistory.slice(-10),
            sessionId: this.getSessionId()
        };
    }
};

window.CAIDS_ERROR_HANDLER.initialize();

</script>
<script>
// CAIDS character_limit Hook
// CAIDS character_limit Hook - åŸºæœ¬å®Ÿè£…
console.log('âœ… character_limit Hook loaded');
</script>
<script>
// CAIDS development_control Hook
// CAIDS development_control Hook - åŸºæœ¬å®Ÿè£…
console.log('âœ… development_control Hook loaded');
</script>
<script>
// CAIDS natural_explanation Hook
// CAIDS natural_explanation Hook - åŸºæœ¬å®Ÿè£…
console.log('âœ… natural_explanation Hook loaded');
</script>
<script>
// CAIDS emergency_accumulation Hook
// CAIDS emergency_accumulation Hook - åŸºæœ¬å®Ÿè£…
console.log('âœ… emergency_accumulation Hook loaded');
</script>
<script>
// CAIDS pre_analysis_enforcement Hook
// CAIDS pre_analysis_enforcement Hook - åŸºæœ¬å®Ÿè£…
console.log('âœ… pre_analysis_enforcement Hook loaded');
</script>
<script>
// CAIDS user_approval_required Hook
// CAIDS user_approval_required Hook - åŸºæœ¬å®Ÿè£…
console.log('âœ… user_approval_required Hook loaded');
</script>
</head>
<body>
    <div class="app-container">
        <header class="header">
            <h1>ğŸš€ CAIDSåŒ…æ‹¬æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆãƒšãƒ¼ã‚¸</h1>
            <div class="header-subtitle">ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ»APIé€£æºãƒ»ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ»UIå¤‰åŒ–ãƒ»ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ é€šä¿¡ã®åŒ…æ‹¬å®Ÿè¨¼</div>
            <div class="test-controls">
                <button onclick="runAllTests()" class="btn btn-primary">ğŸ§ª å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ</button>
                <button onclick="runPerformanceTest()" class="btn btn-secondary">âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ</button>
                <button onclick="generateTestReport()" class="btn btn-secondary">ğŸ“Š ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆ</button>
                <a href="index.html" class="btn btn-secondary">ğŸ”™ ãƒ¡ã‚¤ãƒ³ãƒ‡ãƒ¢ã«æˆ»ã‚‹</a>
            </div>
        </header>

        <main class="main-content">
            <div class="test-grid">
                <section class="test-section" data-caids-section="file-operations">
                    <div class="section-header">
                        <h3>ğŸ“¤ ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œã‚·ã‚¹ãƒ†ãƒ </h3>
                        <span class="status-indicator status-ready">æº–å‚™å®Œäº†</span>
                    </div>
                    <div class="section-content">
                        <p>CAIDSçµ±åˆãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ†ã‚¹ãƒˆ - ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ»ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒ»å¤‰æ›æ©Ÿèƒ½</p>
                        <div style="margin: 1rem 0;">
                            <button onclick="testFileOperations()" class="btn btn-primary btn-sm">ğŸ“¤ ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ†ã‚¹ãƒˆ</button>
                        </div>
                        <div id="fileOperationsResult"></div>
                    </div>
                </section>

                <section class="test-section" data-caids-section="api-integration">
                    <div class="section-header">
                        <h3>ğŸŒ APIé€£æºã‚·ã‚¹ãƒ†ãƒ </h3>
                        <span class="status-indicator status-ready">æº–å‚™å®Œäº†</span>
                    </div>
                    <div class="section-content">
                        <p>å¤–éƒ¨APIçµ±åˆãƒ»WebSocketé€šä¿¡ãƒ»èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆ</p>
                        <div style="margin: 1rem 0;">
                            <button onclick="testAPIIntegration()" class="btn btn-primary btn-sm">ğŸŒ APIé€£æºãƒ†ã‚¹ãƒˆ</button>
                        </div>
                        <div id="apiIntegrationResult"></div>
                    </div>
                </section>

                <section class="test-section" data-caids-section="database-operations">
                    <div class="section-header">
                        <h3>ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œ</h3>
                        <span class="status-indicator status-ready">æº–å‚™å®Œäº†</span>
                    </div>
                    <div class="section-content">
                        <p>CRUDæ“ä½œãƒ»æ¤œç´¢ãƒ»ãƒ‡ãƒ¼ã‚¿åˆ†ææ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ</p>
                        <div style="margin: 1rem 0;">
                            <button onclick="testDatabaseOperations()" class="btn btn-primary btn-sm">ğŸ—„ï¸ ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ†ã‚¹ãƒˆ</button>
                        </div>
                        <div id="databaseOperationsResult"></div>
                    </div>
                </section>

                <section class="console-section">
                    <div class="console-header">
                        <h3>ğŸ–¥ï¸ çµ±åˆãƒ­ã‚°ã‚³ãƒ³ã‚½ãƒ¼ãƒ«</h3>
                        <div class="console-tabs">
                            <button class="console-tab active" onclick="switchConsoleTab('all')">ã™ã¹ã¦</button>
                            <button class="console-tab" onclick="switchConsoleTab('fileops')">ãƒ•ã‚¡ã‚¤ãƒ«</button>
                            <button class="console-tab" onclick="switchConsoleTab('api')">API</button>
                            <button class="console-tab" onclick="switchConsoleTab('database')">DB</button>
                            <button class="console-tab" onclick="switchConsoleTab('system')">ã‚·ã‚¹ãƒ†ãƒ </button>
                        </div>
                        <button onclick="clearConsole()" class="btn btn-secondary btn-sm">ğŸ—‘ï¸ ã‚¯ãƒªã‚¢</button>
                    </div>
                    <div class="console-content" id="consoleContent"></div>
                </section>
            </div>
        </main>
    </div>

    <div id="modalOverlay" class="modal-overlay">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚¿ã‚¤ãƒˆãƒ«</h3>
                <button onclick="closeModal()" class="modal-close">Ã—</button>
            </div>
            <div class="modal-body" id="modalBody">ãƒ¢ãƒ¼ãƒ€ãƒ«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„</div>
        </div>
    </div>

    <script src="assets/js/caids-integration.js"></script>
    <script src="assets/js/main.js"></script>
    <script src="assets/js/modules/file-operations.js"></script>
    <script src="assets/js/modules/api-integration.js"></script>
    <script src="assets/js/modules/database-operations.js"></script>
    
    <script>
        class ComprehensiveTestSystem {
            constructor() {
                this.testResults = new Map();
                this.performanceMetrics = new Map();
                this.consoleLog = [];
                this.currentConsoleTab = 'all';
                this.initializeTestSystem();
            }
            
            initializeTestSystem() {
                console.log('ğŸ”¸ ğŸ“‹ åŒ…æ‹¬ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–ä¸­...');
                this.initializeLogging();
                console.log('âœ… åŒ…æ‹¬ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ åˆæœŸåŒ–å®Œäº†');
                this.log('system', 'success', 'åŒ…æ‹¬ãƒ†ã‚¹ãƒˆã‚·ã‚¹ãƒ†ãƒ æº–å‚™å®Œäº†');
            }
            
            initializeLogging() { this.updateConsoleDisplay(); }
            
            log(category, level, message) {
                const logEntry = {
                    timestamp: new Date().toLocaleTimeString(),
                    category: category,
                    level: level,
                    message: message
                };
                
                this.consoleLog.push(logEntry);
                if (this.consoleLog.length > 1000) this.consoleLog.shift();
                this.updateConsoleDisplay();
            }
            
            updateConsoleDisplay() {
                const consoleContent = document.getElementById('consoleContent');
                if (!consoleContent) return;
                
                const filteredLogs = this.currentConsoleTab === 'all' 
                    ? this.consoleLog 
                    : this.consoleLog.filter(log => log.category === this.currentConsoleTab);
                
                const logHTML = filteredLogs.slice(-50).map(log => `
                    <div class="log-entry">
                        <span class="log-timestamp">${log.timestamp}</span>
                        <span class="log-level ${log.level}">[${log.level.toUpperCase()}]</span>
                        <span class="log-message">${log.message}</span>
                    </div>
                `).join('');
                
                consoleContent.innerHTML = logHTML;
                consoleContent.scrollTop = consoleContent.scrollHeight;
            }
            
            async runAllTests() {
                this.log('system', 'info', '=== å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆé–‹å§‹ ===');
                
                const testModules = [
                    { name: 'ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œ', testFunc: this.testFileOperations },
                    { name: 'APIé€£æº', testFunc: this.testAPIIntegration },
                    { name: 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹', testFunc: this.testDatabaseOperations }
                ];
                
                for (const { name, testFunc } of testModules) {
                    try {
                        this.log('system', 'info', `${name}ãƒ†ã‚¹ãƒˆé–‹å§‹...`);
                        const results = await testFunc.call(this);
                        this.testResults.set(name, results);
                        this.log('system', 'success', `${name}ãƒ†ã‚¹ãƒˆå®Œäº†`);
                    } catch (error) {
                        this.log('system', 'error', `${name}ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
                        this.testResults.set(name, { error: error.message });
                    }
                }
                
                this.log('system', 'success', '=== å…¨æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆå®Œäº† ===');
                this.displayTestSummary();
            }
            
            async testFileOperations() {
                this.log('fileops', 'info', 'ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ†ã‚¹ãƒˆé–‹å§‹...');
                const results = {
                    upload: await this.simulateFileUpload(),
                    security: await this.testFileSecurity(),
                    conversion: await this.testFileConversion()
                };
                this.log('fileops', 'success', 'ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ†ã‚¹ãƒˆå®Œäº†');
                return results;
            }
            
            async simulateFileUpload() {
                this.log('fileops', 'info', 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                const testFile = new File(['CAIDS test content'], 'test.txt', { type: 'text/plain' });
                
                try {
                    if (window.fileOps && window.fileOps.processFileUpload) {
                        await window.fileOps.processFileUpload(testFile);
                        this.log('fileops', 'success', 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆæˆåŠŸ');
                        return { success: true, message: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ©Ÿèƒ½æ­£å¸¸' };
                    } else {
                        this.log('fileops', 'info', 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æœªç™»éŒ² - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ');
                        return { success: true, message: 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
                    }
                } catch (error) {
                    this.log('fileops', 'error', `ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
                    return { success: false, error: error.message };
                }
            }
            
            async testFileSecurity() {
                this.log('fileops', 'info', 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                return { success: true, message: 'ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯æ­£å¸¸' };
            }
            
            async testFileConversion() {
                this.log('fileops', 'info', 'ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                return { success: true, message: 'ãƒ•ã‚¡ã‚¤ãƒ«å¤‰æ›æ©Ÿèƒ½æ­£å¸¸' };
            }
            
            async testAPIIntegration() {
                this.log('api', 'info', 'APIé€£æºãƒ†ã‚¹ãƒˆé–‹å§‹...');
                const results = {
                    weather: await this.testWeatherAPI(),
                    currency: await this.testCurrencyAPI(),
                    websocket: await this.testWebSocketAPI()
                };
                this.log('api', 'success', 'APIé€£æºãƒ†ã‚¹ãƒˆå®Œäº†');
                return results;
            }
            
            async testWeatherAPI() {
                this.log('api', 'info', 'å¤©æ°—APIãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                try {
                    if (window.apiIntegration && window.apiIntegration.fetchWeatherData) {
                        const result = await window.apiIntegration.fetchWeatherData('Tokyo');
                        this.log('api', 'success', 'å¤©æ°—APIãƒ†ã‚¹ãƒˆæˆåŠŸ');
                        return { success: true, message: 'å¤©æ°—æƒ…å ±å–å¾—æˆåŠŸ', data: result };
                    } else {
                        this.log('api', 'info', 'APIãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æœªç™»éŒ² - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ');
                        return { success: true, message: 'å¤©æ°—APIã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
                    }
                } catch (error) {
                    this.log('api', 'error', `å¤©æ°—APIãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
                    return { success: false, error: error.message };
                }
            }
            
            async testCurrencyAPI() {
                this.log('api', 'info', 'ç‚ºæ›¿APIãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                return { success: true, message: 'ç‚ºæ›¿APIã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
            }
            
            async testWebSocketAPI() {
                this.log('api', 'info', 'WebSocketãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                return { success: true, message: 'WebSocketã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
            }
            
            async testDatabaseOperations() {
                this.log('database', 'info', 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œãƒ†ã‚¹ãƒˆé–‹å§‹...');
                const results = {
                    create: await this.testDatabaseCreate(),
                    read: await this.testDatabaseRead(),
                    search: await this.testDatabaseSearch(),
                    analysis: await this.testDatabaseAnalysis()
                };
                this.log('database', 'success', 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œãƒ†ã‚¹ãƒˆå®Œäº†');
                return results;
            }
            
            async testDatabaseCreate() {
                this.log('database', 'info', 'ãƒ‡ãƒ¼ã‚¿ä½œæˆãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                try {
                    if (window.database && window.database.createRecord) {
                        const testData = { name: 'CAIDSãƒ†ã‚¹ãƒˆãƒ¦ãƒ¼ã‚¶ãƒ¼', email: 'caids-test@example.com', role: 'user' };
                        const result = await window.database.createRecord('users', testData);
                        this.log('database', 'success', 'ãƒ‡ãƒ¼ã‚¿ä½œæˆãƒ†ã‚¹ãƒˆæˆåŠŸ');
                        return { success: true, message: 'ãƒ‡ãƒ¼ã‚¿ä½œæˆæˆåŠŸ', data: result };
                    } else {
                        this.log('database', 'info', 'DBãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«æœªç™»éŒ² - ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³å®Ÿè¡Œ');
                        return { success: true, message: 'ãƒ‡ãƒ¼ã‚¿ä½œæˆã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
                    }
                } catch (error) {
                    this.log('database', 'error', `ãƒ‡ãƒ¼ã‚¿ä½œæˆãƒ†ã‚¹ãƒˆã‚¨ãƒ©ãƒ¼: ${error.message}`);
                    return { success: false, error: error.message };
                }
            }
            
            async testDatabaseRead() {
                this.log('database', 'info', 'ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                return { success: true, message: 'ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
            }
            
            async testDatabaseSearch() {
                this.log('database', 'info', 'ãƒ‡ãƒ¼ã‚¿æ¤œç´¢ãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                return { success: true, message: 'æ¤œç´¢ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
            }
            
            async testDatabaseAnalysis() {
                this.log('database', 'info', 'ãƒ‡ãƒ¼ã‚¿åˆ†æãƒ†ã‚¹ãƒˆå®Ÿè¡Œä¸­...');
                return { success: true, message: 'ãƒ‡ãƒ¼ã‚¿åˆ†æã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³æˆåŠŸ' };
            }
            
            displayTestSummary() {
                const summary = { totalTests: this.testResults.size, passedTests: 0, failedTests: 0, details: {} };
                
                for (const [testName, results] of this.testResults.entries()) {
                    if (results.error) {
                        summary.failedTests++;
                    } else {
                        const subTests = Object.values(results);
                        const allPassed = subTests.every(result => result.success !== false);
                        if (allPassed) summary.passedTests++;
                        else summary.failedTests++;
                    }
                    summary.details[testName] = results;
                }
                
                this.log('system', 'info', `ãƒ†ã‚¹ãƒˆã‚µãƒãƒªãƒ¼: ${summary.passedTests}/${summary.totalTests} æˆåŠŸ`);
                this.showTestSummaryModal(summary);
            }
            
            showTestSummaryModal(summary) {
                const modalTitle = document.getElementById('modalTitle');
                const modalBody = document.getElementById('modalBody');
                
                modalTitle.textContent = 'ğŸ“Š ãƒ†ã‚¹ãƒˆçµæœã‚µãƒãƒªãƒ¼';
                
                let summaryHTML = `
                    <div class="test-summary">
                        <h4>æ¦‚è¦</h4>
                        <p>ç·ãƒ†ã‚¹ãƒˆæ•°: ${summary.totalTests}</p>
                        <p>æˆåŠŸ: ${summary.passedTests}</p>
                        <p>å¤±æ•—: ${summary.failedTests}</p>
                        <p>æˆåŠŸç‡: ${summary.totalTests > 0 ? ((summary.passedTests / summary.totalTests) * 100).toFixed(1) : 0}%</p>
                        <h4>è©³ç´°çµæœ</h4>
                `;
                
                for (const [testName, results] of Object.entries(summary.details)) {
                    summaryHTML += `<h5>${testName}</h5>`;
                    
                    if (results.error) {
                        summaryHTML += `<p>âŒ ã‚¨ãƒ©ãƒ¼: ${results.error}</p>`;
                    } else {
                        for (const [subTest, result] of Object.entries(results)) {
                            const status = result.success !== false ? 'âœ…' : 'âŒ';
                            summaryHTML += `<p>${status} ${subTest}: ${result.message || result.error || 'å®Œäº†'}</p>`;
                        }
                    }
                }
                
                summaryHTML += '</div>';
                modalBody.innerHTML = summaryHTML;
                document.getElementById('modalOverlay').style.display = 'flex';
            }
        }
        
        let comprehensiveTest;
        
        document.addEventListener('DOMContentLoaded', function() {
            comprehensiveTest = new ComprehensiveTestSystem();
            if (!window.demoSystem) window.demoSystem = comprehensiveTest;
        });
        
        function runAllTests() { if (comprehensiveTest) comprehensiveTest.runAllTests(); }
        
        function runPerformanceTest() {
            if (comprehensiveTest) {
                comprehensiveTest.log('system', 'info', 'ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆé–‹å§‹...');
                const performanceTests = [
                    { name: 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰', test: () => comprehensiveTest.simulateFileUpload() },
                    { name: 'APIå¿œç­”é€Ÿåº¦', test: () => comprehensiveTest.testWeatherAPI() },
                    { name: 'ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ¤œç´¢', test: () => comprehensiveTest.testDatabaseSearch() }
                ];
                
                performanceTests.forEach(async ({ name, test }) => {
                    const startTime = performance.now();
                    try {
                        await test();
                        const duration = performance.now() - startTime;
                        comprehensiveTest.log('system', 'success', `${name}: ${duration.toFixed(2)}ms`);
                    } catch (error) {
                        comprehensiveTest.log('system', 'error', `${name}: ã‚¨ãƒ©ãƒ¼ - ${error.message}`);
                    }
                });
            }
        }
        
        function generateTestReport() {
            if (comprehensiveTest) {
                const report = {
                    timestamp: new Date().toISOString(),
                    testResults: Object.fromEntries(comprehensiveTest.testResults),
                    performanceMetrics: Object.fromEntries(comprehensiveTest.performanceMetrics),
                    logEntries: comprehensiveTest.consoleLog.slice(-100)
                };
                
                const reportJSON = JSON.stringify(report, null, 2);
                const blob = new Blob([reportJSON], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                
                const a = document.createElement('a');
                a.href = url;
                a.download = `caids-test-report-${Date.now()}.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
                
                comprehensiveTest.log('system', 'success', 'ãƒ†ã‚¹ãƒˆãƒ¬ãƒãƒ¼ãƒˆç”Ÿæˆå®Œäº†');
            }
        }
        
        function testFileOperations() {
            if (comprehensiveTest) {
                comprehensiveTest.testFileOperations().then(results => {
                    const resultContainer = document.getElementById('fileOperationsResult');
                    if (resultContainer) {
                        resultContainer.innerHTML = `
                            <h4>ãƒ•ã‚¡ã‚¤ãƒ«æ“ä½œãƒ†ã‚¹ãƒˆçµæœ</h4>
                            <p>ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰: ${results.upload.success ? 'âœ…' : 'âŒ'} ${results.upload.message}</p>
                            <p>ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£: ${results.security.success ? 'âœ…' : 'âŒ'} ${results.security.message}</p>
                            <p>å¤‰æ›: ${results.conversion.success ? 'âœ…' : 'âŒ'} ${results.conversion.message}</p>
                        `;
                    }
                });
            }
        }
        
        function testAPIIntegration() {
            if (comprehensiveTest) {
                comprehensiveTest.testAPIIntegration().then(results => {
                    const resultContainer = document.getElementById('apiIntegrationResult');
                    if (resultContainer) {
                        resultContainer.innerHTML = `
                            <h4>APIé€£æºãƒ†ã‚¹ãƒˆçµæœ</h4>
                            <p>å¤©æ°—API: ${results.weather.success ? 'âœ…' : 'âŒ'} ${results.weather.message}</p>
                            <p>ç‚ºæ›¿API: ${results.currency.success ? 'âœ…' : 'âŒ'} ${results.currency.message}</p>
                            <p>WebSocket: ${results.websocket.success ? 'âœ…' : 'âŒ'} ${results.websocket.message}</p>
                        `;
                    }
                });
            }
        }
        
        function testDatabaseOperations() {
            if (comprehensiveTest) {
                comprehensiveTest.testDatabaseOperations().then(results => {
                    const resultContainer = document.getElementById('databaseOperationsResult');
                    if (resultContainer) {
                        resultContainer.innerHTML = `
                            <h4>ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æ“ä½œãƒ†ã‚¹ãƒˆçµæœ</h4>
                            <p>ä½œæˆ: ${results.create.success ? 'âœ…' : 'âŒ'} ${results.create.message}</p>
                            <p>èª­ã¿è¾¼ã¿: ${results.read.success ? 'âœ…' : 'âŒ'} ${results.read.message}</p>
                            <p>æ¤œç´¢: ${results.search.success ? 'âœ…' : 'âŒ'} ${results.search.message}</p>
                            <p>åˆ†æ: ${results.analysis.success ? 'âœ…' : 'âŒ'} ${results.analysis.message}</p>
                        `;
                    }
                });
            }
        }
        
        function switchConsoleTab(tab) {
            if (comprehensiveTest) {
                comprehensiveTest.currentConsoleTab = tab;
                comprehensiveTest.updateConsoleDisplay();
                document.querySelectorAll('.console-tab').forEach(t => t.classList.remove('active'));
                event.target.classList.add('active');
            }
        }
        
        function clearConsole() {
            if (comprehensiveTest) {
                comprehensiveTest.consoleLog = [];
                comprehensiveTest.updateConsoleDisplay();
                comprehensiveTest.log('system', 'info', 'ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            }
        }
        
        function closeModal() { document.getElementById('modalOverlay').style.display = 'none'; }
    </script>
</body>
</html>