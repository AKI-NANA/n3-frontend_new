<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>eBayカテゴリー自動判定システム - デモ版</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/ebay_category_tool.css">
    
    <!-- 基本CSS変数 -->
    <style>
        :root {
            --primary-color: #3b82f6;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --info-color: #06b6d4;
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-tertiary: #f1f5f9;
            --text-primary: #1e293b;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border-color: #e2e8f0;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --radius-md: 0.375rem;
            --radius-lg: 0.5rem;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            padding: var(--space-md);
        }
        
        .demo-container {
            max-width: 1200px;
            margin: 0 auto;
            background: var(--bg-secondary);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            overflow: hidden;
        }
        
        .demo-header {
            background: linear-gradient(135deg, var(--primary-color), #6366f1);
            color: white;
            padding: var(--space-xl);
            text-align: center;
        }
        
        .demo-header h1 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: var(--space-sm);
        }
        
        .demo-status {
            background: var(--bg-tertiary);
            padding: var(--space-md);
            border-bottom: 1px solid var(--border-color);
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: var(--space-md);
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-sm);
            background: var(--bg-secondary);
            border-radius: var(--radius-md);
            box-shadow: var(--shadow-sm);
        }
        
        .status-icon {
            font-size: 1.25rem;
        }
        
        .status-completed {
            color: var(--success-color);
        }
        
        .status-pending {
            color: var(--warning-color);
        }
        
        .demo-content {
            padding: var(--space-lg);
        }
        
        .section {
            margin-bottom: var(--space-xl);
        }
        
        .section-header {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
            padding-bottom: var(--space-sm);
            border-bottom: 2px solid var(--bg-tertiary);
        }
        
        .section-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .demo-notice {
            background: #fff3cd;
            border: 1px solid #fbbf24;
            color: #92400e;
            padding: var(--space-md);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-lg);
        }
    </style>
</head>

<body>
    <div class="demo-container">
        <!-- ヘッダー -->
        <div class="demo-header">
            <h1><i class="fas fa-tags"></i> eBayカテゴリー自動判定システム</h1>
            <p>デモ版 - フロントエンド実装完了</p>
        </div>

        <!-- 開発状況 -->
        <div class="demo-status">
            <div class="status-item">
                <i class="fas fa-check-circle status-icon status-completed"></i>
                <div>
                    <strong>フロントエンド（Claude）</strong><br>
                    <small>UI/JavaScript実装完成</small>
                </div>
            </div>
            <div class="status-item">
                <i class="fas fa-cog fa-spin status-icon status-pending"></i>
                <div>
                    <strong>バックエンド（Gemini）</strong><br>
                    <small>PHP API開発待ち</small>
                </div>
            </div>
            <div class="status-item">
                <i class="fas fa-clock status-icon status-pending"></i>
                <div>
                    <strong>統合テスト</strong><br>
                    <small>バックエンド完成後</small>
                </div>
            </div>
        </div>

        <!-- メインコンテンツ -->
        <div class="demo-content">
            
            <!-- デモ通知 -->
            <div class="demo-notice">
                <i class="fas fa-info-circle"></i>
                <strong>デモ版について:</strong> 
                現在はフロントエンド機能のみ動作します。実際のカテゴリー判定はバックエンドAPI実装後に機能します。
            </div>

            <!-- eBayカテゴリーシステムを読み込み -->
            <div id="ebay-category" class="tab-content">
                <div class="section">
                    <!-- ヘッダー -->
                    <div class="section-header">
                        <i class="fas fa-tags"></i>
                        <h3 class="section-title">eBayカテゴリー自動判定システム</h3>
                        <div style="margin-left: auto; display: flex; gap: var(--space-sm);">
                            <button class="btn btn-info" onclick="showHelp()">
                                <i class="fas fa-question-circle"></i> ヘルプ
                            </button>
                            <button class="btn btn-success" onclick="showSampleCSV()">
                                <i class="fas fa-file-csv"></i> サンプルCSV
                            </button>
                        </div>
                    </div>

                    <!-- 機能説明 -->
                    <div class="notification info" style="margin-bottom: var(--space-lg);">
                        <i class="fas fa-info-circle"></i>
                        <div>
                            <strong>自動カテゴリー判定システム</strong><br>
                            商品タイトルから最適なeBayカテゴリーを自動選択し、必須項目（Item Specifics）を生成します。<br>
                            CSVファイルをアップロードして一括処理が可能です。
                        </div>
                    </div>

                    <!-- CSVアップロードセクション -->
                    <div class="category-detection-section">
                        <div class="section-header">
                            <h4 style="margin: 0; display: flex; align-items: center; gap: var(--space-sm);">
                                <i class="fas fa-upload"></i>
                                CSVファイルアップロード
                            </h4>
                        </div>

                        <div class="csv-upload-container" id="csvUploadContainer">
                            <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
                            
                            <div class="upload-icon">
                                <i class="fas fa-cloud-upload-alt"></i>
                            </div>
                            
                            <div class="upload-text">CSVファイルをドラッグ&ドロップ</div>
                            <div class="upload-subtitle">または、クリックしてファイルを選択</div>
                            
                            <div class="supported-formats">
                                <span class="format-tag">.CSV</span>
                                <span class="format-tag">最大5MB</span>
                                <span class="format-tag">最大10,000行</span>
                            </div>
                            
                            <button class="btn btn-primary" id="csvUploadButton" style="margin-top: var(--space-md);">
                                <i class="fas fa-folder-open"></i> ファイルを選択
                            </button>
                        </div>

                        <!-- 必須CSV形式説明 -->
                        <div class="notification warning" style="margin-top: var(--space-md);">
                            <i class="fas fa-exclamation-triangle"></i>
                            <div>
                                <strong>必須CSV形式:</strong><br>
                                <code>title,price,description,yahoo_category,image_url</code><br>
                                各列にはそれぞれ商品タイトル、価格、説明、Yahooカテゴリ、画像URLを記載してください。
                            </div>
                        </div>
                    </div>

                    <!-- 処理進行状況 -->
                    <div class="processing-progress" id="processingProgress">
                        <div class="progress-header">
                            <div class="progress-icon">
                                <i class="fas fa-cog fa-spin"></i>
                            </div>
                            <div>
                                <div class="progress-title">カテゴリー判定処理中...</div>
                                <div style="color: var(--text-secondary); font-size: 0.875rem;">
                                    商品データを解析してeBayカテゴリーを自動判定しています
                                </div>
                            </div>
                        </div>
                        
                        <div class="progress-bar-container">
                            <div class="progress-bar" id="progressBar" style="width: 0%"></div>
                        </div>
                        <div class="progress-text" id="progressText">処理開始...</div>
                    </div>

                    <!-- 単一商品テストセクション -->
                    <div class="category-detection-section" style="background: var(--bg-secondary);">
                        <div class="section-header">
                            <h4 style="margin: 0; display: flex; align-items: center; gap: var(--space-sm);">
                                <i class="fas fa-search"></i>
                                単一商品テスト（デモ機能）
                            </h4>
                        </div>
                        
                        <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-md); align-items: end;">
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">商品タイトル</label>
                                <input 
                                    type="text" 
                                    id="singleTestTitle" 
                                    placeholder="例: iPhone 14 Pro 128GB Space Black"
                                    style="width: 100%; padding: var(--space-sm); border: 1px solid var(--border-color); border-radius: var(--radius-md);"
                                >
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">価格（USD）</label>
                                <input 
                                    type="number" 
                                    id="singleTestPrice" 
                                    placeholder="999.99"
                                    step="0.01"
                                    min="0"
                                    style="width: 100%; padding: var(--space-sm); border: 1px solid var(--border-color); border-radius: var(--radius-md);"
                                >
                            </div>
                        </div>
                        
                        <div style="margin-top: var(--space-md); text-align: center;">
                            <button class="btn btn-primary" onclick="testSingleProduct()" style="padding: var(--space-sm) var(--space-xl);">
                                <i class="fas fa-magic"></i> カテゴリー判定テスト（デモ）
                            </button>
                        </div>
                        
                        <div id="singleTestResult" style="margin-top: var(--space-md); display: none;">
                            <div style="background: var(--bg-tertiary); border-radius: var(--radius-md); padding: var(--space-md);">
                                <h5 style="margin-bottom: var(--space-sm);">判定結果（デモ）:</h5>
                                <div id="singleTestResultContent"></div>
                            </div>
                        </div>
                    </div>

                    <!-- 実装状況表示 -->
                    <div class="notification info" style="margin-top: var(--space-xl);">
                        <i class="fas fa-code"></i>
                        <div>
                            <strong>実装完了状況:</strong><br>
                            ✅ <strong>UI/UXデザイン:</strong> レスポンシブ・アニメーション完成<br>
                            ✅ <strong>ドラッグ&ドロップ:</strong> ファイルアップロード機能完成<br>
                            ✅ <strong>JavaScript機能:</strong> 状態管理・API連携準備完成<br>
                            ✅ <strong>既存システム統合:</strong> Yahoo Auction Tool統合準備完成<br>
                            🚧 <strong>バックエンド:</strong> Gemini実装待ち（PHP API・データベース・カテゴリー判定ロジック）
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- JavaScript -->
    <script>
        // デモ版のJavaScript機能
        let demoSystem = {
            currentData: [],
            processingInProgress: false
        };

        // CSVアップロード機能（デモ版）
        document.getElementById('csvUploadButton').addEventListener('click', () => {
            document.getElementById('csvFileInput').click();
        });

        document.getElementById('csvFileInput').addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                processDemoCSV(file);
            }
        });

        // ドラッグ&ドロップ
        const uploadContainer = document.getElementById('csvUploadContainer');
        
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
            uploadContainer.addEventListener(eventName, preventDefaults, false);
        });

        function preventDefaults(e) {
            e.preventDefault();
            e.stopPropagation();
        }

        ['dragenter', 'dragover'].forEach(eventName => {
            uploadContainer.addEventListener(eventName, () => {
                uploadContainer.classList.add('drag-over');
            }, false);
        });

        ['dragleave', 'drop'].forEach(eventName => {
            uploadContainer.addEventListener(eventName, () => {
                uploadContainer.classList.remove('drag-over');
            }, false);
        });

        uploadContainer.addEventListener('drop', (e) => {
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                processDemoCSV(files[0]);
            }
        }, false);

        // デモCSV処理
        function processDemoCSV(file) {
            console.log('デモCSV処理開始:', file.name);
            
            // バリデーション
            if (!file.name.toLowerCase().endsWith('.csv')) {
                alert('CSVファイルを選択してください');
                return;
            }
            
            if (file.size > 5 * 1024 * 1024) {
                alert('ファイルサイズが5MBを超えています');
                return;
            }
            
            // プログレス表示
            showProcessingProgress(true);
            
            // デモ用プログレス
            simulateProgress(() => {
                showProcessingProgress(false);
                showMessage('デモ処理完了！実際の処理はバックエンドAPI実装後に動作します。', 'success');
            });
        }

        // プログレス表示
        function showProcessingProgress(show) {
            const progressDiv = document.getElementById('processingProgress');
            progressDiv.style.display = show ? 'block' : 'none';
            demoSystem.processingInProgress = show;
        }

        // プログレスシミュレーション
        function simulateProgress(callback) {
            let progress = 0;
            const progressBar = document.getElementById('progressBar');
            const progressText = document.getElementById('progressText');
            
            const interval = setInterval(() => {
                progress += Math.random() * 15 + 5;
                
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                    progressText.textContent = '処理完了';
                    setTimeout(callback, 1000);
                }
                
                progressBar.style.width = `${progress}%`;
                progressText.textContent = `処理中... ${Math.round(progress)}%`;
            }, 300);
        }

        // 単一商品テスト（デモ版）
        function testSingleProduct() {
            const title = document.getElementById('singleTestTitle').value.trim();
            const price = document.getElementById('singleTestPrice').value;
            
            if (!title) {
                alert('商品タイトルを入力してください');
                return;
            }
            
            const resultDiv = document.getElementById('singleTestResult');
            const contentDiv = document.getElementById('singleTestResultContent');
            
            resultDiv.style.display = 'block';
            contentDiv.innerHTML = `
                <div style="text-align: center; padding: var(--space-lg);">
                    <i class="fas fa-spinner fa-spin" style="font-size: 2rem; color: var(--primary-color); margin-bottom: var(--space-sm);"></i><br>
                    カテゴリーを判定中...
                </div>
            `;
            
            // デモ用判定結果生成
            setTimeout(() => {
                const mockResult = generateMockResult(title, price);
                displayMockResult(mockResult);
            }, 2000);
        }

        // モック結果生成
        function generateMockResult(title, price) {
            const titleLower = title.toLowerCase();
            
            let category = { id: '99999', name: 'その他' };
            let confidence = 30;
            let itemSpecifics = 'Brand=Unknown■Condition=Used';
            
            if (titleLower.includes('iphone') || titleLower.includes('スマホ') || titleLower.includes('smartphone')) {
                category = { id: '9355', name: 'Cell Phones & Smartphones' };
                confidence = 95;
                itemSpecifics = 'Brand=Apple■Model=iPhone 14 Pro■Storage=128GB■Color=Space Black■Condition=Used';
            } else if (titleLower.includes('camera') || titleLower.includes('カメラ')) {
                category = { id: '625', name: 'Cameras & Photo' };
                confidence = 90;
                itemSpecifics = 'Brand=Canon■Type=Mirrorless■Model=EOS R6■Condition=Used';
            } else if (titleLower.includes('pokemon') || titleLower.includes('ポケモン')) {
                category = { id: '2536', name: 'Trading Card Games' };
                confidence = 88;
                itemSpecifics = 'Game=Pokémon■Card Type=Promo■Condition=Near Mint';
            } else if (titleLower.includes('watch') || titleLower.includes('時計')) {
                category = { id: '31387', name: 'Wristwatches' };
                confidence = 85;
                itemSpecifics = 'Brand=Apple■Type=Smart Watch■Model=Series 9■Condition=Used';
            }
            
            return { category, confidence, itemSpecifics };
        }

        // モック結果表示
        function displayMockResult(result) {
            const contentDiv = document.getElementById('singleTestResultContent');
            const confidenceLevel = result.confidence >= 80 ? 'high' : result.confidence >= 50 ? 'medium' : 'low';
            const confidenceColor = result.confidence >= 80 ? '#10b981' : result.confidence >= 50 ? '#f59e0b' : '#ef4444';
            
            contentDiv.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-md); margin-bottom: var(--space-md);">
                    <div>
                        <h6 style="color: var(--text-secondary); margin-bottom: var(--space-xs);">判定カテゴリー</h6>
                        <div style="padding: 0.25rem 0.5rem; background: #dcfce7; color: #166534; border-radius: 0.25rem; font-size: 0.75rem; font-weight: 600; display: inline-block;">
                            ${result.category.name}
                        </div>
                        <div style="font-size: 0.8rem; color: var(--text-muted); margin-top: var(--space-xs);">
                            ID: ${result.category.id}
                        </div>
                    </div>
                    
                    <div>
                        <h6 style="color: var(--text-secondary); margin-bottom: var(--space-xs);">判定精度</h6>
                        <div style="display: flex; align-items: center; gap: 0.25rem;">
                            <div style="width: 80px; height: 6px; background: #f1f5f9; border-radius: 3px; overflow: hidden;">
                                <div style="width: ${result.confidence}%; height: 100%; background: ${confidenceColor}; border-radius: 3px;"></div>
                            </div>
                            <span style="font-weight: 600;">${result.confidence}%</span>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: var(--space-md);">
                    <h6 style="color: var(--text-secondary); margin-bottom: var(--space-xs);">生成された必須項目</h6>
                    <div style="background: var(--bg-tertiary); border-radius: var(--radius-md); padding: var(--space-sm); font-family: monospace; font-size: 0.75rem; color: var(--text-secondary);">
                        ${result.itemSpecifics.replace(/■/g, ' | ')}
                    </div>
                </div>
                
                <div style="background: #dbeafe; border: 1px solid #93c5fd; color: #1e40af; padding: var(--space-sm); border-radius: var(--radius-md);">
                    <i class="fas fa-info-circle"></i>
                    <strong>デモ結果:</strong> 実際の高精度判定はGemini実装のバックエンドAPI完成後に動作します。
                </div>
            `;
        }

        // ヘルプ表示
        function showHelp() {
            alert(`eBayカテゴリー自動判定システム

【機能概要】
商品タイトルから最適なeBayカテゴリーを自動判定し、必須項目を生成します。

【現在の状況】
✅ フロントエンド: 完成（Claude担当）
🚧 バックエンド: 開発中（Gemini担当）

【使用方法】
1. CSVファイルをアップロード
2. 自動でカテゴリー判定・必須項目生成
3. 結果確認・修正
4. CSV出力

現在はデモ版のみ動作します。`);
        }

        // サンプルCSV表示
        function showSampleCSV() {
            const sampleContent = `title,price,description,yahoo_category,image_url
"iPhone 14 Pro 128GB Space Black",999.99,"美品のiPhone 14 Pro","携帯電話","https://example.com/iphone.jpg"
"Canon EOS R6 ミラーレスカメラ",2499.99,"プロ仕様のミラーレスカメラ","カメラ","https://example.com/camera.jpg"
"ポケモンカード ピカチュウ プロモ",149.99,"限定プロモーションカード","トレーディングカード","https://example.com/pokemon.jpg"`;
            
            const blob = new Blob([sampleContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            
            if (link.download !== undefined) {
                const url = URL.createObjectURL(blob);
                link.setAttribute('href', url);
                link.setAttribute('download', 'ebay_category_sample.csv');
                link.style.visibility = 'hidden';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
            }
            
            showMessage('サンプルCSVをダウンロードしました', 'success');
        }

        // メッセージ表示
        function showMessage(text, type = 'info') {
            const alertClass = type === 'success' ? 'alert-success' : type === 'error' ? 'alert-error' : 'alert-info';
            
            const message = document.createElement('div');
            message.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 1rem;
                background: ${type === 'success' ? '#dcfce7' : type === 'error' ? '#fee2e2' : '#dbeafe'};
                color: ${type === 'success' ? '#166534' : type === 'error' ? '#991b1b' : '#1e40af'};
                border: 1px solid ${type === 'success' ? '#86efac' : type === 'error' ? '#fca5a5' : '#93c5fd'};
                border-radius: 0.5rem;
                box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
                max-width: 400px;
                z-index: 1000;
                opacity: 0;
                transform: translateX(100%);
                transition: all 0.3s ease;
            `;
            
            message.innerHTML = `
                <div style="display: flex; align-items: center; gap: 0.5rem;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'}"></i>
                    <span>${text}</span>
                </div>
            `;
            
            document.body.appendChild(message);
            
            setTimeout(() => {
                message.style.opacity = '1';
                message.style.transform = 'translateX(0)';
            }, 100);
            
            setTimeout(() => {
                message.style.opacity = '0';
                message.style.transform = 'translateX(100%)';
                setTimeout(() => {
                    document.body.removeChild(message);
                }, 300);
            }, 5000);
        }

        console.log('✅ eBayカテゴリー自動判定システム デモ版 初期化完了');
    </script>
</body>
</html>