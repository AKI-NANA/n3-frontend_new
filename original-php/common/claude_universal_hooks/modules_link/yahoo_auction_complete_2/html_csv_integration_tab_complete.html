<!-- üéØ HTML„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ ‚Üí CSVËá™ÂãïÁµ±Âêà„Çø„ÉñÔºàÂÆåÂÖ®ÁâàÔºâ -->

<!-- „Çø„Éñ„Éä„Éì„Ç≤„Éº„Ç∑„Éß„É≥ËøΩÂä†Ôºà„Éá„Éº„ÇøÂèñÂæó„ÅÆÈö£Ôºâ -->
<button class="tab-btn" data-tab="html-csv-integration" onclick="switchTab('html-csv-integration')">
    <i class="fas fa-code"></i>
    HTMLÁ∑®ÈõÜ
</button>

<!-- HTML„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ ‚Üí CSVËá™ÂãïÁµ±Âêà„Çø„Éñ„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
<div id="html-csv-integration" class="tab-content">
    <div class="section">
        <div class="section-header">
            <h3 class="section-title">
                <i class="fas fa-code"></i>
                HTML ‚Üí CSVËá™ÂãïÁµ±Âêà„Ç∑„Çπ„ÉÜ„É†
            </h3>
            <div style="display: flex; gap: var(--space-sm);">
                <button class="btn btn-success" onclick="processAllProductsWithHTML()">
                    <i class="fas fa-magic"></i> ÂÖ®ÂïÜÂìÅ‰∏ÄÊã¨Âá¶ÁêÜ
                </button>
                <button class="btn btn-info" onclick="downloadHTMLUpdatedCSV()">
                    <i class="fas fa-download"></i> HTMLÁµ±ÂêàCSVÂèñÂæó
                </button>
                <button class="btn btn-warning" onclick="resetHTMLProcessing()">
                    <i class="fas fa-undo"></i> „É™„Çª„ÉÉ„Éà
                </button>
            </div>
        </div>

        <!-- Âá¶ÁêÜÁä∂Ê≥Å„ÉÄ„ÉÉ„Ç∑„É•„Éú„Éº„Éâ -->
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: var(--space-md); margin-bottom: var(--space-lg);">
            <div class="card" style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: 700; color: var(--primary-color);" id="totalProductsHTML">0</div>
                <div style="color: var(--text-muted); font-size: 0.8rem;">Á∑èÂïÜÂìÅÊï∞</div>
            </div>
            <div class="card" style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: 700; color: var(--success-color);" id="processedProductsHTML">0</div>
                <div style="color: var(--text-muted); font-size: 0.8rem;">HTMLÁîüÊàêÊ∏à„Åø</div>
            </div>
            <div class="card" style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: 700; color: var(--warning-color);" id="templateUploadedCount">0</div>
                <div style="color: var(--text-muted); font-size: 0.8rem;">„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁôªÈå≤</div>
            </div>
            <div class="card" style="text-align: center;">
                <div style="font-size: 1.5rem; font-weight: 700; color: var(--info-color);" id="csvReadyCount">0</div>
                <div style="color: var(--text-muted); font-size: 0.8rem;">CSVÂá∫ÂäõÊ∫ñÂÇôÂÆå‰∫Ü</div>
            </div>
        </div>

        <!-- HTML„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ„Çª„ÇØ„Ç∑„Éß„É≥ -->
        <div style="background: var(--bg-tertiary); padding: var(--space-lg); border-radius: var(--radius-lg); margin-bottom: var(--space-lg);">
            <h4 style="margin-bottom: var(--space-md);">
                <i class="fas fa-palette"></i> HTML„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ
            </h4>
            
            <!-- HTML„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ -->
            <div style="display: grid; grid-template-columns: 2fr 1fr; gap: var(--space-lg); margin-bottom: var(--space-md);">
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                        <i class="fas fa-upload"></i> HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„Çí„Ç¢„ÉÉ„Éó„É≠„Éº„Éâ„ÉªÁ∑®ÈõÜ
                    </label>
                    <div style="position: relative;">
                        <textarea 
                            id="htmlTemplateInput" 
                            placeholder="<!DOCTYPE html>
<html>
<head>
    <title>{{PRODUCT_TITLE}}</title>
</head>
<body>
    <h1>{{PRODUCT_TITLE}}</h1>
    <div>‰æ°Ê†º: {{PRICE_USD}}</div>
    <div>„Éñ„É©„É≥„Éâ: {{IF_HAS_BRAND}}{{BRAND_NAME}}{{ELSE}}‰∏çÊòé{{END_IF}}</div>
    
    <!-- ÁîªÂÉè„ÇÆ„É£„É©„É™„Éº -->
    {{IMAGE_GALLERY}}
    
    <!-- ‰ªïÊßòË°® -->
    {{SPECIFICATIONS_TABLE}}
    
    <!-- ÈÖçÈÄÅÊÉÖÂ†± -->
    {{SHIPPING_INFO}}
</body>
</html>"
                            style="width: 100%; min-height: 250px; padding: var(--space-sm); border: 1px solid var(--border-color); border-radius: var(--radius-md); font-family: 'Courier New', monospace; font-size: 0.85rem; resize: vertical; background: #1e293b; color: #e2e8f0;"
                        ></textarea>
                        <div style="position: absolute; top: 10px; right: 10px; display: flex; gap: 0.5rem;">
                            <button class="btn btn-secondary" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;" onclick="formatHTML()">
                                <i class="fas fa-magic"></i> Êï¥ÂΩ¢
                            </button>
                            <button class="btn btn-info" style="font-size: 0.75rem; padding: 0.25rem 0.5rem;" onclick="clearHTMLTemplate()">
                                <i class="fas fa-eraser"></i> „ÇØ„É™„Ç¢
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- Â∑Æ„ÅóËæº„Åø„ÉØ„Éº„Éâ‰∏ÄË¶ß -->
                <div>
                    <label style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                        <i class="fas fa-tags"></i> Â∑Æ„ÅóËæº„Åø„ÉØ„Éº„Éâ‰∏ÄË¶ßÔºà„ÇØ„É™„ÉÉ„ÇØ„ÅßÊåøÂÖ•Ôºâ
                    </label>
                    <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--radius-md); padding: var(--space-sm); max-height: 250px; overflow-y: auto;">
                        
                        <!-- Âü∫Êú¨ÊÉÖÂ†± -->
                        <div style="margin-bottom: var(--space-sm);">
                            <div style="font-weight: 600; font-size: 0.8rem; color: var(--primary-color); margin-bottom: 0.25rem;">Âü∫Êú¨ÊÉÖÂ†±</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                <span class="variable-tag" onclick="insertVariable('{{PRODUCT_TITLE}}')">{{PRODUCT_TITLE}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{PRICE_USD}}')">{{PRICE_USD}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{BRAND_NAME}}')">{{BRAND_NAME}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{MODEL_NAME}}')">{{MODEL_NAME}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{CONDITION}}')">{{CONDITION}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{CATEGORY}}')">{{CATEGORY}}</span>
                            </div>
                        </div>
                        
                        <!-- ÁîªÂÉè„Éª„ÇÆ„É£„É©„É™„Éº -->
                        <div style="margin-bottom: var(--space-sm);">
                            <div style="font-weight: 600; font-size: 0.8rem; color: var(--success-color); margin-bottom: 0.25rem;">ÁîªÂÉè„Éª„ÇÆ„É£„É©„É™„Éº</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                <span class="variable-tag" onclick="insertVariable('{{MAIN_IMAGE}}')">{{MAIN_IMAGE}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{IMAGE_GALLERY}}')">{{IMAGE_GALLERY}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{IMAGE_COUNT}}')">{{IMAGE_COUNT}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{IMAGE_1}}')">{{IMAGE_1}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{IMAGE_2}}')">{{IMAGE_2}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{IMAGE_3}}')">{{IMAGE_3}}</span>
                            </div>
                        </div>
                        
                        <!-- ÂïÜÂìÅË©≥Á¥∞„Éª‰ªïÊßò -->
                        <div style="margin-bottom: var(--space-sm);">
                            <div style="font-weight: 600; font-size: 0.8rem; color: var(--warning-color); margin-bottom: 0.25rem;">ÂïÜÂìÅË©≥Á¥∞„Éª‰ªïÊßò</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                <span class="variable-tag" onclick="insertVariable('{{SPECIFICATIONS_TABLE}}')">{{SPECIFICATIONS_TABLE}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{DESCRIPTION_TEXT}}')">{{DESCRIPTION_TEXT}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{WEIGHT}}')">{{WEIGHT}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{DIMENSIONS}}')">{{DIMENSIONS}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{COLOR}}')">{{COLOR}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{SIZE}}')">{{SIZE}}</span>
                            </div>
                        </div>
                        
                        <!-- ÈÖçÈÄÅ„ÉªÂèñÂºï -->
                        <div style="margin-bottom: var(--space-sm);">
                            <div style="font-weight: 600; font-size: 0.8rem; color: var(--info-color); margin-bottom: 0.25rem;">ÈÖçÈÄÅ„ÉªÂèñÂºï</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                <span class="variable-tag" onclick="insertVariable('{{SHIPPING_INFO}}')">{{SHIPPING_INFO}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{HANDLING_TIME}}')">{{HANDLING_TIME}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{RETURN_POLICY}}')">{{RETURN_POLICY}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{PAYMENT_METHODS}}')">{{PAYMENT_METHODS}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{SHIP_FROM_COUNTRY}}')">{{SHIP_FROM_COUNTRY}}</span>
                            </div>
                        </div>
                        
                        <!-- Êù°‰ª∂ÂàÜÂ≤ê -->
                        <div>
                            <div style="font-weight: 600; font-size: 0.8rem; color: var(--danger-color); margin-bottom: 0.25rem;">Êù°‰ª∂ÂàÜÂ≤ê</div>
                            <div style="display: flex; flex-wrap: wrap; gap: 0.25rem;">
                                <span class="variable-tag" onclick="insertVariable('{{IF_HAS_BRAND}}')">{{IF_HAS_BRAND}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{ELSE}}')">{{ELSE}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{END_IF}}')">{{END_IF}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{IF_NEW_CONDITION}}')">{{IF_NEW_CONDITION}}</span>
                                <span class="variable-tag" onclick="insertVariable('{{IF_HAS_IMAGES}}')">{{IF_HAS_IMAGES}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà‰øùÂ≠ò -->
            <div style="display: flex; gap: var(--space-sm); align-items: center; margin-bottom: var(--space-md);">
                <input 
                    type="text" 
                    id="templateNameInput" 
                    placeholder="„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂêçÔºà‰æã: premium_templateÔºâ" 
                    style="flex: 1; padding: var(--space-sm); border: 1px solid var(--border-color); border-radius: var(--radius-md);"
                >
                <button class="btn btn-primary" onclick="saveHTMLTemplate()">
                    <i class="fas fa-save"></i> „ÉÜ„É≥„Éó„É¨„Éº„Éà‰øùÂ≠ò
                </button>
            </div>
        </div>

        <!-- „É™„Ç¢„É´„Çø„Ç§„É†HTML„Éó„É¨„Éì„É•„Éº -->
        <div style="background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: var(--radius-lg); padding: var(--space-lg); margin-bottom: var(--space-lg);">
            <h4 style="margin-bottom: var(--space-md);">
                <i class="fas fa-eye"></i> „É™„Ç¢„É´„Çø„Ç§„É†„Éó„É¨„Éì„É•„Éº
            </h4>
            
            <!-- „Çµ„É≥„Éó„É´„Éá„Éº„ÇøÈÅ∏Êäû -->
            <div style="display: flex; gap: var(--space-sm); margin-bottom: var(--space-md);">
                <button class="btn btn-secondary" onclick="loadSampleData('iphone')">
                    <i class="fas fa-mobile"></i> iPhone „Çµ„É≥„Éó„É´
                </button>
                <button class="btn btn-secondary" onclick="loadSampleData('camera')">
                    <i class="fas fa-camera"></i> „Ç´„É°„É© „Çµ„É≥„Éó„É´
                </button>
                <button class="btn btn-secondary" onclick="loadSampleData('watch')">
                    <i class="fas fa-clock"></i> ÊôÇË®à „Çµ„É≥„Éó„É´
                </button>
                <button class="btn btn-info" onclick="generateHTMLPreview()">
                    <i class="fas fa-sync"></i> „Éó„É¨„Éì„É•„ÉºÊõ¥Êñ∞
                </button>
            </div>
            
            <!-- „Éó„É¨„Éì„É•„ÉºË°®Á§∫ -->
            <div id="htmlPreviewArea" style="border: 2px solid var(--border-color); border-radius: var(--radius-md); background: white; min-height: 200px; overflow: auto; max-height: 400px;">
                <div style="padding: var(--space-lg); text-align: center; color: var(--text-muted);">
                    <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: var(--space-sm);"></i>
                    <div>HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Äå„Éó„É¨„Éì„É•„ÉºÊõ¥Êñ∞„Äç„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
                </div>
            </div>
        </div>

        <!-- ‰øùÂ≠òÊ∏à„ÅøHTML„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ -->
        <div style="background: var(--bg-tertiary); padding: var(--space-lg); border-radius: var(--radius-lg);">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--space-md);">
                <h4>
                    <i class="fas fa-folder"></i> ‰øùÂ≠òÊ∏à„ÅøHTML„ÉÜ„É≥„Éó„É¨„Éº„Éà
                </h4>
                <button class="btn btn-info" onclick="loadSavedTemplates()">
                    <i class="fas fa-sync"></i> ‰∏ÄË¶ßÊõ¥Êñ∞
                </button>
            </div>
            
            <!-- „ÉÜ„É≥„Éó„É¨„Éº„Éà‰∏ÄË¶ß„ÉÜ„Éº„Éñ„É´ -->
            <div style="overflow-x: auto;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂêç</th>
                            <th>‰ΩúÊàêÊó•</th>
                            <th>‰ΩøÁî®ÂõûÊï∞</th>
                            <th>Ë™¨Êòé</th>
                            <th>Êìç‰Ωú</th>
                        </tr>
                    </thead>
                    <tbody id="savedTemplatesBody">
                        <tr>
                            <td colspan="5" style="text-align: center; padding: var(--space-lg); color: var(--text-muted);">
                                „Äå‰∏ÄË¶ßÊõ¥Êñ∞„Äç„ÇíÊäº„Åó„Å¶„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíË°®Á§∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<!-- CSS „Çπ„Çø„Ç§„É´ËøΩÂä† -->
<style>
.variable-tag {
    background: var(--bg-tertiary);
    border: 1px solid var(--border-color);
    border-radius: var(--radius-sm);
    padding: 0.25rem 0.5rem;
    font-size: 0.7rem;
    font-family: 'Courier New', monospace;
    cursor: pointer;
    transition: all 0.2s ease;
    color: var(--primary-color);
    font-weight: 600;
    display: inline-block;
}

.variable-tag:hover {
    background: var(--primary-color);
    color: white;
    transform: translateY(-1px);
    box-shadow: var(--shadow-sm);
}

.data-table {
    width: 100%;
    border-collapse: collapse;
    background: var(--bg-secondary);
    border-radius: var(--radius-lg);
    overflow: hidden;
    box-shadow: var(--shadow-sm);
}

.data-table th,
.data-table td {
    padding: var(--space-sm);
    text-align: left;
    border-bottom: 1px solid var(--border-color);
    font-size: 0.8rem;
}

.data-table th {
    background: var(--bg-tertiary);
    font-weight: 600;
    color: var(--text-primary);
}
</style>

<!-- JavaScript Ê©üËÉΩËøΩÂä† -->
<script>
// HTML„ÉÜ„É≥„Éó„É¨„Éº„ÉàÁÆ°ÁêÜ„Ç∑„Çπ„ÉÜ„É†
let currentSampleData = {};
let savedTemplates = [];

// Â∑Æ„ÅóËæº„Åø„ÉØ„Éº„ÉâÊåøÂÖ•Ê©üËÉΩ
function insertVariable(variable) {
    const textarea = document.getElementById('htmlTemplateInput');
    const startPos = textarea.selectionStart;
    const endPos = textarea.selectionEnd;
    const currentValue = textarea.value;
    
    // „Ç´„Éº„ÇΩ„É´‰ΩçÁΩÆ„Å´Â§âÊï∞„ÇíÊåøÂÖ•
    const newValue = currentValue.substring(0, startPos) + variable + currentValue.substring(endPos);
    textarea.value = newValue;
    
    // „Ç´„Éº„ÇΩ„É´‰ΩçÁΩÆ„ÇíË™øÊï¥
    const newCursorPos = startPos + variable.length;
    textarea.setSelectionRange(newCursorPos, newCursorPos);
    textarea.focus();
    
    console.log('Â§âÊï∞ÊåøÂÖ•:', variable);
}

// HTMLÊï¥ÂΩ¢Ê©üËÉΩ
function formatHTML() {
    const textarea = document.getElementById('htmlTemplateInput');
    let html = textarea.value;
    
    // Á∞°Âçò„Å™HTMLÊï¥ÂΩ¢ÔºàÂÆüÈöõ„ÅÆ„Éó„É≠„ÉÄ„ÇØ„Ç∑„Éß„É≥„Åß„ÅØ„Çà„ÇäÈ´òÂ∫¶„Å™„É©„Ç§„Éñ„É©„É™„Çí‰ΩøÁî®Ôºâ
    html = html.replace(/></g, '>\n<');
    html = html.replace(/^\s+|\s+$/gm, '');
    
    // „Ç§„É≥„Éá„É≥„ÉàËøΩÂä†
    const lines = html.split('\n');
    let indentLevel = 0;
    const formattedLines = [];
    
    lines.forEach(line => {
        if (line.trim() === '') return;
        
        if (line.includes('</') && !line.includes('</'+ line.match(/<(\w+)/)?.[1] + '>')) {
            indentLevel--;
        }
        
        formattedLines.push('  '.repeat(Math.max(0, indentLevel)) + line.trim());
        
        if (line.includes('<') && !line.includes('</') && !line.endsWith('/>')) {
            indentLevel++;
        }
    });
    
    textarea.value = formattedLines.join('\n');
    console.log('HTMLÊï¥ÂΩ¢ÂÆå‰∫Ü');
}

// HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇØ„É™„Ç¢
function clearHTMLTemplate() {
    if (confirm('HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„Çí„ÇØ„É™„Ç¢„Åó„Åæ„Åô„ÅãÔºü')) {
        document.getElementById('htmlTemplateInput').value = '';
        document.getElementById('htmlPreviewArea').innerHTML = `
            <div style="padding: var(--space-lg); text-align: center; color: var(--text-muted);">
                <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: var(--space-sm);"></i>
                <div>HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Äå„Éó„É¨„Éì„É•„ÉºÊõ¥Êñ∞„Äç„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
            </div>
        `;
    }
}

// „Çµ„É≥„Éó„É´„Éá„Éº„ÇøË™≠„ÅøËæº„Åø
function loadSampleData(type) {
    const sampleDataSets = {
        iphone: {
            PRODUCT_TITLE: 'Apple iPhone 14 Pro 128GB Deep Purple - Unlocked',
            PRICE_USD: '899.00',
            BRAND_NAME: 'Apple',
            MODEL_NAME: 'iPhone 14 Pro',
            CONDITION: 'New',
            CATEGORY: 'Cell Phones & Smartphones',
            MAIN_IMAGE: 'https://example.com/iphone14pro.jpg',
            IMAGE_COUNT: '8',
            DESCRIPTION_TEXT: 'Brand new iPhone 14 Pro with Dynamic Island, A16 Bionic chip, and Pro camera system.',
            WEIGHT: '7.27 oz (206g)',
            DIMENSIONS: '6.07 x 2.81 x 0.31 inches',
            COLOR: 'Deep Purple',
            SIZE: '128GB'
        },
        camera: {
            PRODUCT_TITLE: 'Canon EOS R5 Mirrorless Camera Body',
            PRICE_USD: '2,499.00',
            BRAND_NAME: 'Canon',
            MODEL_NAME: 'EOS R5',
            CONDITION: 'Used - Excellent',
            CATEGORY: 'Digital Cameras',
            MAIN_IMAGE: 'https://example.com/canon-r5.jpg',
            IMAGE_COUNT: '12',
            DESCRIPTION_TEXT: 'Professional mirrorless camera with 45MP sensor and 8K video capability.',
            WEIGHT: '1.62 lbs (738g)',
            DIMENSIONS: '5.39 x 3.76 x 3.46 inches',
            COLOR: 'Black',
            SIZE: 'Body Only'
        },
        watch: {
            PRODUCT_TITLE: 'Vintage Seiko Automatic Watch 1970s',
            PRICE_USD: '295.00',
            BRAND_NAME: 'Seiko',
            MODEL_NAME: 'Automatic',
            CONDITION: 'Used - Very Good',
            CATEGORY: 'Watches',
            MAIN_IMAGE: 'https://example.com/seiko-vintage.jpg',
            IMAGE_COUNT: '6',
            DESCRIPTION_TEXT: 'Beautifully preserved vintage Seiko automatic watch from the 1970s.',
            WEIGHT: '0.25 lbs (115g)',
            DIMENSIONS: '1.57 x 1.57 x 0.39 inches',
            COLOR: 'Silver',
            SIZE: 'One Size'
        }
    };
    
    currentSampleData = sampleDataSets[type] || {};
    
    console.log('„Çµ„É≥„Éó„É´„Éá„Éº„ÇøË™≠„ÅøËæº„Åø:', type, currentSampleData);
    
    // „Éó„É¨„Éì„É•„Éº„ÇíËá™ÂãïÊõ¥Êñ∞
    generateHTMLPreview();
}

// HTML„Éó„É¨„Éì„É•„ÉºÁîüÊàê
function generateHTMLPreview() {
    const htmlTemplate = document.getElementById('htmlTemplateInput').value;
    const previewArea = document.getElementById('htmlPreviewArea');
    
    if (!htmlTemplate.trim()) {
        previewArea.innerHTML = `
            <div style="padding: var(--space-lg); text-align: center; color: var(--text-muted);">
                <i class="fas fa-info-circle" style="font-size: 2rem; margin-bottom: var(--space-sm);"></i>
                <div>HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ</div>
            </div>
        `;
        return;
    }
    
    // Â∑Æ„ÅóËæº„Åø„ÉØ„Éº„Éâ„ÇíÁΩÆÊèõ
    let processedHTML = htmlTemplate;
    
    // Âü∫Êú¨ÁöÑ„Å™ÁΩÆÊèõ
    Object.entries(currentSampleData).forEach(([key, value]) => {
        const regex = new RegExp(`{{${key}}}`, 'g');
        processedHTML = processedHTML.replace(regex, value);
    });
    
    // Êù°‰ª∂ÂàÜÂ≤êÂá¶ÁêÜÔºàÁ∞°ÊòìÁâàÔºâ
    processedHTML = processedHTML.replace(/{{IF_HAS_BRAND}}(.*?){{ELSE}}(.*?){{END_IF}}/gs, (match, ifContent, elseContent) => {
        return currentSampleData.BRAND_NAME ? ifContent : elseContent;
    });
    
    processedHTML = processedHTML.replace(/{{IF_HAS_BRAND}}(.*?){{END_IF}}/gs, (match, content) => {
        return currentSampleData.BRAND_NAME ? content : '';
    });
    
    // ÁâπÂà•„Å™Ë¶ÅÁ¥†„ÅÆÁîüÊàê
    processedHTML = processedHTML.replace(/{{IMAGE_GALLERY}}/g, `
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; margin: 20px 0;">
            <img src="${currentSampleData.MAIN_IMAGE || 'https://via.placeholder.com/150'}" style="width: 100%; border-radius: 8px;" alt="ÂïÜÂìÅÁîªÂÉè">
            <img src="https://via.placeholder.com/150" style="width: 100%; border-radius: 8px;" alt="ÂïÜÂìÅÁîªÂÉè">
            <img src="https://via.placeholder.com/150" style="width: 100%; border-radius: 8px;" alt="ÂïÜÂìÅÁîªÂÉè">
        </div>
    `);
    
    processedHTML = processedHTML.replace(/{{SPECIFICATIONS_TABLE}}/g, `
        <table style="width: 100%; border-collapse: collapse; margin: 20px 0;">
            <tr style="background: #f5f5f5;"><td style="padding: 8px; border: 1px solid #ddd;"><strong>„Éñ„É©„É≥„Éâ</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${currentSampleData.BRAND_NAME || '-'}</td></tr>
            <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>„É¢„Éá„É´</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${currentSampleData.MODEL_NAME || '-'}</td></tr>
            <tr style="background: #f5f5f5;"><td style="padding: 8px; border: 1px solid #ddd;"><strong>Áä∂ÊÖã</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${currentSampleData.CONDITION || '-'}</td></tr>
            <tr><td style="padding: 8px; border: 1px solid #ddd;"><strong>ÈáçÈáè</strong></td><td style="padding: 8px; border: 1px solid #ddd;">${currentSampleData.WEIGHT || '-'}</td></tr>
        </table>
    `);
    
    processedHTML = processedHTML.replace(/{{SHIPPING_INFO}}/g, `
        <div style="background: #e8f5e8; padding: 15px; border-radius: 8px; margin: 20px 0;">
            <h4 style="margin: 0 0 10px 0; color: #2d5a2d;">üöö ÈÖçÈÄÅÊÉÖÂ†±</h4>
            <p style="margin: 5px 0;">üì¶ Âá¶ÁêÜÊó•Êï∞: 1-2Âñ∂Ê•≠Êó•</p>
            <p style="margin: 5px 0;">üåç ÈÖçÈÄÅÂÖà: ‰∏ñÁïåÂêÑÂõΩ</p>
            <p style="margin: 5px 0;">üí∞ ÈÄÅÊñô: $15.00ÔºàÁÑ°ÊñôÈÖçÈÄÅ„Éó„É≠„É¢„Éº„Ç∑„Éß„É≥ÂÆüÊñΩ‰∏≠Ôºâ</p>
        </div>
    `);
    
    // „Éó„É¨„Éì„É•„ÉºË°®Á§∫
    previewArea.innerHTML = processedHTML;
    
    console.log('HTML„Éó„É¨„Éì„É•„ÉºÁîüÊàêÂÆå‰∫Ü');
}

// HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà‰øùÂ≠ò
function saveHTMLTemplate() {
    const templateName = document.getElementById('templateNameInput').value.trim();
    const htmlContent = document.getElementById('htmlTemplateInput').value.trim();
    
    if (!templateName) {
        alert('„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
    }
    
    if (!htmlContent) {
        alert('HTML„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
    }
    
    // „Éá„Éº„Çø„Éô„Éº„Çπ„Å´‰øùÂ≠òÔºàÂÆüÈöõ„ÅÆAPIÂëº„Å≥Âá∫„ÅóÔºâ
    const formData = new FormData();
    formData.append('action', 'save_html_template');
    formData.append('template_name', templateName);
    formData.append('html_content', htmlContent);
    
    fetch('/modules/yahoo_auction_complete/database_csv_handler_ebay_complete.php', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        console.log('„ÉÜ„É≥„Éó„É¨„Éº„Éà‰øùÂ≠òÁµêÊûú:', data);
        
        if (data.success) {
            alert('HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅåÊ≠£Â∏∏„Å´‰øùÂ≠ò„Åï„Çå„Åæ„Åó„ÅüÔºÅ');
            document.getElementById('templateNameInput').value = '';
            updateTemplateUploadCount();
            loadSavedTemplates();
        } else {
            alert('‰øùÂ≠ò„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + (data.error || '‰∏çÊòé„Å™„Ç®„É©„Éº'));
        }
    })
    .catch(error => {
        console.error('„ÉÜ„É≥„Éó„É¨„Éº„Éà‰øùÂ≠ò„Ç®„É©„Éº:', error);
        alert('‰øùÂ≠ò‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: ' + error.message);
    });
}

// ‰øùÂ≠òÊ∏à„Åø„ÉÜ„É≥„Éó„É¨„Éº„Éà‰∏ÄË¶ßË™≠„ÅøËæº„Åø
function loadSavedTemplates() {
    fetch('/modules/yahoo_auction_complete/database_csv_handler_ebay_complete.php?action=get_html_templates')
        .then(response => response.json())
        .then(data => {
            console.log('‰øùÂ≠òÊ∏à„Åø„ÉÜ„É≥„Éó„É¨„Éº„Éà:', data);
            
            if (data.success) {
                displaySavedTemplates(data.data || []);
                savedTemplates = data.data || [];
            } else {
                console.error('„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂèñÂæó„Ç®„É©„Éº:', data.error);
            }
        })
        .catch(error => {
            console.error('„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂèñÂæó„Ç®„É©„Éº:', error);
        });
}

// ‰øùÂ≠òÊ∏à„Åø„ÉÜ„É≥„Éó„É¨„Éº„ÉàË°®Á§∫
function displaySavedTemplates(templates) {
    const tbody = document.getElementById('savedTemplatesBody');
    
    if (templates.length === 0) {
        tbody.innerHTML = `
            <tr>
                <td colspan="5" style="text-align: center; padding: var(--space-lg); color: var(--text-muted);">
                    ‰øùÂ≠ò„Åï„Çå„ÅüHTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì
                </td>
            </tr>
        `;
        return;
    }
    
    tbody.innerHTML = templates.map(template => `
        <tr>
            <td style="font-weight: 600;">${template.template_name}</td>
            <td>${template.created_at}</td>
            <td>${template.usage_count || 0}</td>
            <td>${template.description || '-'}</td>
            <td>
                <button class="btn btn-info" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; margin: 0 0.25rem;" onclick="loadTemplate('${template.template_name}')">Ë™≠„ÅøËæº„Åø</button>
                <button class="btn btn-warning" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; margin: 0 0.25rem;" onclick="editTemplate('${template.template_name}')">Á∑®ÈõÜ</button>
                <button class="btn btn-danger" style="font-size: 0.75rem; padding: 0.25rem 0.5rem; margin: 0 0.25rem;" onclick="deleteTemplate('${template.template_name}')">ÂâäÈô§</button>
            </td>
        </tr>
    `).join('');
}

// „ÉÜ„É≥„Éó„É¨„Éº„ÉàË™≠„ÅøËæº„Åø
function loadTemplate(templateName) {
    const template = savedTemplates.find(t => t.template_name === templateName);
    if (template) {
        document.getElementById('htmlTemplateInput').value = template.html_content || '';
        document.getElementById('templateNameInput').value = templateName;
        generateHTMLPreview();
        console.log('„ÉÜ„É≥„Éó„É¨„Éº„ÉàË™≠„ÅøËæº„Åø:', templateName);
    }
}

// „ÉÜ„É≥„Éó„É¨„Éº„ÉàÁ∑®ÈõÜ
function editTemplate(templateName) {
    loadTemplate(templateName);
    alert('„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÇíË™≠„ÅøËæº„Åø„Åæ„Åó„Åü„ÄÇÁ∑®ÈõÜÂæå„Å´„Äå„ÉÜ„É≥„Éó„É¨„Éº„Éà‰øùÂ≠ò„Äç„ÇíÊäº„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ');
}

// „ÉÜ„É≥„Éó„É¨„Éº„ÉàÂâäÈô§
function deleteTemplate(templateName) {
    if (!confirm(`„ÉÜ„É≥„Éó„É¨„Éº„Éà„Äå${templateName}„Äç„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü`)) {
        return;
    }
    
    const formData = new FormData();
    formData.append('action', 'delete_html_template');
    formData.append('template_name', templateName);
    
    fetch('/modules/yahoo_auction_complete/database_csv_handler_ebay_complete.php', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        console.log('„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂâäÈô§ÁµêÊûú:', data);
        
        if (data.success) {
            alert('HTML„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅåÂâäÈô§„Åï„Çå„Åæ„Åó„Åü');
            loadSavedTemplates();
        } else {
            alert('ÂâäÈô§„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + (data.error || '‰∏çÊòé„Å™„Ç®„É©„Éº'));
        }
    })
    .catch(error => {
        console.error('„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂâäÈô§„Ç®„É©„Éº:', error);
        alert('ÂâäÈô§‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: ' + error.message);
    });
}

// ÂÖ®ÂïÜÂìÅ‰∏ÄÊã¨HTMLÂá¶ÁêÜ
function processAllProductsWithHTML() {
    if (!confirm('ÂÖ®ÂïÜÂìÅ„Å´HTML„ÇíÈÅ©Áî®„Åó„Å¶„ÄÅCSV„ÅÆebay_description_html„Éï„Ç£„Éº„É´„Éâ„Å´Ëá™ÂãïÊåøÂÖ•„Åó„Åæ„Åô„ÄÇÁ∂öË°å„Åó„Åæ„Åô„ÅãÔºü')) {
        return;
    }
    
    const templateName = document.getElementById('templateNameInput').value.trim();
    if (!templateName) {
        alert('‰ΩøÁî®„Åô„Çã„ÉÜ„É≥„Éó„É¨„Éº„ÉàÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
        return;
    }
    
    // Âá¶ÁêÜÈñãÂßã
    const formData = new FormData();
    formData.append('action', 'process_all_products_html');
    formData.append('template_name', templateName);
    
    fetch('/modules/yahoo_auction_complete/database_csv_handler_ebay_complete.php', {
        method: 'POST',
        body: formData
    })
    .then(response => response.json())
    .then(data => {
        console.log('‰∏ÄÊã¨HTMLÂá¶ÁêÜÁµêÊûú:', data);
        
        if (data.success) {
            alert(`ÊàêÂäüÔºÅ${data.processed_count}‰ª∂„ÅÆÂïÜÂìÅ„Å´HTML„ÅåÈÅ©Áî®„Åï„Çå„Åæ„Åó„Åü„ÄÇ`);
            updateHTMLProcessingStats();
        } else {
            alert('‰∏ÄÊã¨Âá¶ÁêÜ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü: ' + (data.error || '‰∏çÊòé„Å™„Ç®„É©„Éº'));
        }
    })
    .catch(error => {
        console.error('‰∏ÄÊã¨HTMLÂá¶ÁêÜ„Ç®„É©„Éº:', error);
        alert('Âá¶ÁêÜ‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü: ' + error.message);
    });
}

// HTMLÁµ±ÂêàÊ∏à„ÅøCSV„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
function downloadHTMLUpdatedCSV() {
    window.open('/modules/yahoo_auction_complete/database_csv_handler_ebay_complete.php?action=export_ebay_csv&html_ready=true', '_blank');
}

// Âá¶ÁêÜÁµ±Ë®àÊõ¥Êñ∞
function updateHTMLProcessingStats() {
    // ÂÆüÈöõ„ÅÆAPI„ÅßÁµ±Ë®à„ÇíÂèñÂæó„Åó„Å¶Êõ¥Êñ∞
    fetch('/modules/yahoo_auction_complete/database_csv_handler_ebay_complete.php?action=get_html_processing_stats')
        .then(response => response.json())
        .then(data => {
            if (data.success && data.stats) {
                document.getElementById('totalProductsHTML').textContent = data.stats.total_products || '0';
                document.getElementById('processedProductsHTML').textContent = data.stats.html_generated || '0';
                document.getElementById('templateUploadedCount').textContent = data.stats.templates_count || '0';
                document.getElementById('csvReadyCount').textContent = data.stats.csv_ready || '0';
            }
        })
        .catch(error => {
            console.error('Áµ±Ë®àÊõ¥Êñ∞„Ç®„É©„Éº:', error);
        });
}

function updateTemplateUploadCount() {
    updateHTMLProcessingStats();
}

function resetHTMLProcessing() {
    if (confirm('HTMLÂá¶ÁêÜ„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºüÂÖ®„Å¶„ÅÆÁîüÊàêÊ∏à„ÅøHTML„ÅåÂâäÈô§„Åï„Çå„Åæ„Åô„ÄÇ')) {
        // „É™„Çª„ÉÉ„ÉàÂá¶ÁêÜ
        console.log('HTMLÂá¶ÁêÜ„É™„Çª„ÉÉ„Éà');
        // APIÂëº„Å≥Âá∫„Åó„ÇíÂÆüË£Ö
    }
}

// ÂàùÊúüÂåñ
document.addEventListener('DOMContentLoaded', function() {
    // „Çø„ÉñÂàá„ÇäÊõø„ÅàÊôÇ„Å´HTML„Çø„Éñ„Åå„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å´„Å™„Å£„ÅüÂ†¥Âêà„ÅÆÂá¶ÁêÜ
    const htmlTab = document.querySelector('[data-tab="html-csv-integration"]');
    if (htmlTab) {
        htmlTab.addEventListener('click', function() {
            setTimeout(() => {
                loadSavedTemplates();
                updateHTMLProcessingStats();
            }, 100);
        });
    }
});

console.log('‚úÖ HTML‚ÜíCSVÁµ±Âêà„Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñÂÆå‰∫Ü');
</script>