<!DOCTYPE html>
<html lang="ja" data-theme="light">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>📊 記帳自動化ツール - NAGANO-3</title>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <style>
      /* =====================================
           🎯 NAGANO-3 共通CSS完全インライン実装
           共通CSS（style.css, common.css, layout.css, themes-pure.css）を統合
           ===================================== */

      /* === CSS Reset & Base === */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html {
        font-size: 16px;
        line-height: 1.6;
      }

      /* =====================================
           🔧 重要：基本文字色・背景色の強制指定
           ===================================== */
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Roboto",
          "Oxygen", "Ubuntu", "Cantarell", sans-serif;
        /* 🔧 基本色を強制指定 */
        color: #111827 !important; /* 濃い黒文字 */
        background-color: #ffffff !important; /* 白背景 */
        transition: color 0.3s ease, background-color 0.3s ease;
        line-height: 1.6;
      }

      /* 🔧 統計カード（強制色指定） */
      .dashboard__stat-card {
        /* 🔧 統計カード背景 */
        background-color: #f9fafb !important; /* 薄グレー背景 */
        border: 1px solid #e5e7eb; /* グレーボーダー */
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-sm);
        transition: var(--transition-fast);
      }

      .dashboard__stat-card__title {
        font-size: var(--font-sm);
        font-weight: var(--font-semibold);
        /* 🔧 統計タイトル色 */
        color: #6b7280 !important; /* グレー文字 */
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .dashboard__stat-card__value {
        font-size: 1.75rem;
        font-weight: var(--font-bold);
        /* 🔧 統計値色 */
        color: #111827 !important; /* 濃い黒 */
        margin-bottom: var(--spacing-sm);
      }

      .dashboard__stat-card__trend {
        font-size: var(--font-sm);
        /* 🔧 トレンド色 */
        color: #6b7280 !important; /* グレー文字 */
      }

      .dashboard__stat-card__icon {
        width: 32px;
        height: 32px;
        /* 🔧 アイコン背景 */
        background-color: #f3f4f6 !important; /* 薄グレー2 */
        border-radius: var(--border-radius);
        display: flex;
        align-items: center;
        justify-content: center;
        /* 🔧 アイコン色 */
        color: #8b5cf6 !important; /* 紫色 */
      }

      /* === NAGANO-3 共通CSS変数（推測実装） === */
      :root {
        /* 📁 Base Colors */
        --primary-color: #3b82f6;
        --secondary-color: #6b7280;
        --success-color: #10b981;
        --warning-color: #f59e0b;
        --error-color: #ef4444;
        --info-color: #0ea5e9;

        /* 📁 Accent Colors */
        --accent-blue: #8b5cf6;
        --accent-purple: #a855f7;
        --accent-green: #10b981;
        --accent-yellow: #f59e0b;
        --accent-red: #ef4444;

        /* 📁 Background Colors */
        --bg-primary: #ffffff;
        --bg-secondary: #f9fafb;
        --bg-tertiary: #f3f4f6;
        --bg-quaternary: #e5e7eb;

        /* 📁 Text Colors */
        --text-primary: #111827;
        --text-secondary: #6b7280;
        --text-muted: #9ca3af;
        --text-light: #d1d5db;
        --text-white: #ffffff;

        /* 📁 Border & Shadow */
        --border-color: #d1d5db;
        --border-light: #e5e7eb;
        --border-dark: #9ca3af;
        --border-radius: 0.375rem;
        --border-radius-sm: 0.25rem;
        --border-radius-lg: 0.5rem;
        --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);

        /* 📁 Spacing */
        --spacing-xs: 0.25rem;
        --spacing-sm: 0.5rem;
        --spacing-md: 1rem;
        --spacing-lg: 1.5rem;
        --spacing-xl: 2rem;
        --spacing-2xl: 3rem;

        /* 📁 Font Sizes */
        --font-xs: 0.75rem;
        --font-sm: 0.875rem;
        --font-base: 1rem;
        --font-lg: 1.125rem;
        --font-xl: 1.25rem;
        --font-2xl: 1.5rem;
        --font-3xl: 1.875rem;

        /* 📁 Font Weights */
        --font-normal: 400;
        --font-medium: 500;
        --font-semibold: 600;
        --font-bold: 700;

        /* 📁 Transitions */
        --transition-fast: all 0.15s ease;
        --transition-normal: all 0.3s ease;
        --transition-slow: all 0.5s ease;

        /* 📁 Z-index */
        --z-dropdown: 1000;
        --z-sticky: 1020;
        --z-modal: 1050;
        --z-tooltip: 1070;
      }

      /* === Dark Theme Support === */
      [data-theme="dark"] {
        --bg-primary: #1f2937;
        --bg-secondary: #374151;
        --bg-tertiary: #4b5563;
        --bg-quaternary: #6b7280;

        --text-primary: #f9fafb;
        --text-secondary: #d1d5db;
        --text-muted: #9ca3af;
        --text-light: #6b7280;

        --border-color: #4b5563;
        --border-light: #6b7280;
        --border-dark: #374151;
      }

      /* === Basic Layout Components === */
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 var(--spacing-md);
      }

      .grid {
        display: grid;
        gap: var(--spacing-md);
      }

      .flex {
        display: flex;
      }

      .flex-col {
        flex-direction: column;
      }

      .items-center {
        align-items: center;
      }

      .justify-between {
        justify-content: space-between;
      }

      .gap-sm {
        gap: var(--spacing-sm);
      }

      .gap-md {
        gap: var(--spacing-md);
      }

      .gap-lg {
        gap: var(--spacing-lg);
      }

      /* === Button System === */
      .btn {
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-sm);
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
        border: 1px solid transparent;
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: var(--transition-fast);
        text-decoration: none;
        white-space: nowrap;
        line-height: 1.5;
      }

      .btn:hover {
        transform: translateY(-1px);
      }

      .btn--primary {
        background: var(--primary-color);
        color: var(--text-white);
        border-color: var(--primary-color);
      }

      .btn--primary:hover {
        background: #2563eb;
        border-color: #2563eb;
      }

      .btn--secondary {
        background: var(--bg-primary);
        color: var(--text-primary);
        border-color: var(--border-color);
      }

      .btn--secondary:hover {
        background: var(--bg-secondary);
      }

      .btn--success {
        background: var(--success-color);
        color: var(--text-white);
        border-color: var(--success-color);
      }

      .btn--success:hover {
        background: #059669;
        border-color: #059669;
      }

      .btn--info {
        background: var(--info-color);
        color: var(--text-white);
        border-color: var(--info-color);
      }

      .btn--info:hover {
        background: #0284c7;
        border-color: #0284c7;
      }

      .btn--warning {
        background: var(--warning-color);
        color: var(--text-white);
        border-color: var(--warning-color);
      }

      .btn--warning:hover {
        background: #d97706;
        border-color: #d97706;
      }

      .btn--danger {
        background: var(--error-color);
        color: var(--text-white);
        border-color: var(--error-color);
      }

      .btn--danger:hover {
        background: #dc2626;
        border-color: #dc2626;
      }

      .btn--small {
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: var(--font-xs);
      }

      .btn--large {
        padding: var(--spacing-md) var(--spacing-lg);
        font-size: var(--font-lg);
      }

      .btn--full {
        width: 100%;
        justify-content: center;
      }

      /* === Form System === */
      .form-group {
        margin-bottom: var(--spacing-md);
      }

      .form-label {
        display: block;
        margin-bottom: var(--spacing-sm);
        font-size: var(--font-sm);
        font-weight: var(--font-semibold);
        color: var(--text-primary);
      }

      .form-input,
      .form-select,
      .form-textarea {
        width: 100%;
        padding: var(--spacing-sm) var(--spacing-md);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        font-size: var(--font-base);
        background: var(--bg-primary);
        color: var(--text-primary);
        transition: var(--transition-fast);
      }

      .form-input:focus,
      .form-select:focus,
      .form-textarea:focus {
        outline: none;
        border-color: var(--primary-color);
        box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
      }

      /* === Card System === */
      .card {
        background: var(--bg-secondary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        box-shadow: var(--shadow-sm);
        overflow: hidden;
        transition: var(--transition-fast);
      }

      .card:hover {
        box-shadow: var(--shadow-md);
      }

      .card-header {
        padding: var(--spacing-lg);
        border-bottom: 1px solid var(--border-light);
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        flex-wrap: wrap;
        gap: var(--spacing-md);
      }

      .card-body {
        padding: var(--spacing-lg);
      }

      .card-title {
        font-size: var(--font-lg);
        font-weight: var(--font-bold);
        color: var(--text-primary);
        margin: 0;
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .card-subtitle {
        font-size: var(--font-sm);
        color: var(--text-secondary);
        margin-top: var(--spacing-xs);
      }

      /* === Table System === */
      .table {
        width: 100%;
        border-collapse: collapse;
        background: var(--bg-primary);
        border-radius: var(--border-radius);
        overflow: hidden;
        box-shadow: var(--shadow-sm);
      }

      .table th {
        background: var(--bg-secondary);
        padding: var(--spacing-md);
        text-align: left;
        font-weight: var(--font-semibold);
        color: var(--text-primary);
        border-bottom: 2px solid var(--border-color);
      }

      .table td {
        padding: var(--spacing-md);
        border-bottom: 1px solid var(--border-light);
        color: var(--text-primary);
      }

      .table tr:hover {
        background: var(--bg-tertiary);
      }

      /* =====================================
           🎯 記帳ツール専用CSS
           ===================================== */

      /* =====================================
           🔧 記帳ツール専用変数（直接色指定で確実に表示）
           ===================================== */
      :root {
        /* 記帳ツール専用色（直接指定で確実表示） */
        --kicho-primary: #8b5cf6; /* 紫色 - メインカラー */
        --kicho-secondary: #a855f7; /* 薄紫色 - サブカラー */
        --kicho-danger: #ef4444; /* 赤色 - エラー・削除 */
        --kicho-success: #10b981; /* 緑色 - 成功・承認 */
        --kicho-warning: #f59e0b; /* 黄色 - 警告・待機 */
        --kicho-info: #3b82f6; /* 青色 - 情報・MF */

        /* 統一アイコンカラー（直接指定） */
        --icon-mf: #1e40af; /* MFクラウド - 濃青 */
        --icon-csv: #059669; /* CSV - 濃緑 */
        --icon-ai: #ea580c; /* AI - オレンジ */
        --icon-system: #4b5563; /* システム - グレー */
        --icon-rule: #7c3aed; /* ルール管理 - 濃紫 */
        --icon-approval: #10b981; /* 承認 - 緑 */
      }

      /* 統一アイコンシステム */
      .icon--mf {
        color: var(--icon-mf);
      }
      .icon--csv {
        color: var(--icon-csv);
      }
      .icon--ai {
        color: var(--icon-ai);
      }
      .icon--system {
        color: var(--icon-system);
      }
      .icon--rule {
        color: var(--icon-rule);
      }
      .icon--approval {
        color: var(--icon-approval);
      }

      /* =====================================
           記帳ツール基本レイアウト
           ===================================== */
      .kicho__container {
        max-width: 1200px;
        margin: 0 auto;
        padding: var(--spacing-lg);
      }

      .kicho__header {
        background: var(--bg-secondary);
        border-bottom: 2px solid var(--border-light);
        padding: var(--spacing-lg);
        margin: calc(-1 * var(--spacing-lg)) calc(-1 * var(--spacing-lg))
          var(--spacing-xl);
        display: flex;
        justify-content: space-between;
        align-items: center;
        flex-wrap: wrap;
        gap: var(--spacing-md);
      }

      .kicho__header-left {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
      }

      .kicho__page-title {
        font-size: var(--font-2xl);
        font-weight: var(--font-bold);
        color: var(--kicho-primary);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin: 0;
      }

      .kicho__page-icon {
        color: var(--icon-mf);
      }

      .kicho__system-status {
        display: flex;
        gap: var(--spacing-lg);
        font-size: var(--font-sm);
        color: var(--text-secondary);
      }

      .kicho__status-item {
        display: flex;
        align-items: center;
        gap: var(--spacing-xs);
      }

      .kicho__status-item--active i {
        color: var(--kicho-success);
      }

      .kicho__header-actions {
        display: flex;
        gap: var(--spacing-sm);
      }

      /* =====================================
           統計ダッシュボード
           ===================================== */
      .dashboard__stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-lg);
        margin-bottom: var(--spacing-xl);
      }

      .dashboard__stat-card {
        background: var(--bg-secondary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-sm);
        transition: var(--transition-fast);
      }

      .dashboard__stat-card:hover {
        box-shadow: var(--shadow-md);
        transform: translateY(-2px);
      }

      .dashboard__stat-card__header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: var(--spacing-md);
      }

      .dashboard__stat-card__title {
        font-size: var(--font-sm);
        font-weight: var(--font-semibold);
        color: var(--text-secondary);
        text-transform: uppercase;
        letter-spacing: 0.05em;
      }

      .dashboard__stat-card__icon {
        width: 32px;
        height: 32px;
        background: var(--bg-tertiary);
        border-radius: var(--border-radius);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--kicho-primary);
      }

      .dashboard__stat-card__value {
        font-size: 1.75rem;
        font-weight: var(--font-bold);
        color: var(--text-primary);
        margin-bottom: var(--spacing-sm);
      }

      .dashboard__stat-card__trend {
        font-size: var(--font-sm);
        color: var(--text-secondary);
      }

      /* =====================================
           セクション
           ===================================== */
      .kicho__section {
        background: var(--bg-secondary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        margin-bottom: var(--spacing-xl);
        box-shadow: var(--shadow-sm);
      }

      .kicho__section__header {
        padding: var(--spacing-lg);
        border-bottom: 1px solid var(--border-light);
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        flex-wrap: wrap;
        gap: var(--spacing-md);
      }

      .kicho__section__title {
        font-size: var(--font-xl);
        font-weight: var(--font-bold);
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin: 0;
      }

      .kicho__section__subtitle {
        font-size: var(--font-sm);
        color: var(--text-secondary);
        margin-top: var(--spacing-xs);
      }

      .kicho__section__actions {
        display: flex;
        gap: var(--spacing-sm);
        flex-wrap: wrap;
      }

      /* =====================================
           カード
           ===================================== */
      .kicho__overview-section {
        padding: var(--spacing-lg);
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: var(--spacing-lg);
      }

      .kicho__card {
        background: var(--bg-tertiary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
      }

      .kicho__card__header {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-lg);
      }

      .kicho__card__header h3 {
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
        color: var(--text-primary);
        margin: 0;
      }

      /* =====================================
           フォーム
           ===================================== */
      .kicho__form-group {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-md);
      }

      .kicho__form-label {
        font-size: var(--font-sm);
        font-weight: var(--font-semibold);
        color: var(--text-primary);
      }

      .kicho__form-input {
        padding: var(--spacing-sm) var(--spacing-md);
        border: 1px solid var(--border-color);
        border-radius: var(--border-radius);
        font-size: var(--font-base);
        transition: var(--transition-fast);
        background: var(--bg-primary);
        color: var(--text-primary);
      }

      .kicho__form-input:focus {
        outline: none;
        border-color: var(--kicho-primary);
        box-shadow: 0 0 0 3px rgba(139, 92, 246, 0.1);
      }

      /* =====================================
           🔧 記帳ツール専用ボタン（色を強制指定）
           ===================================== */
      .kicho__btn {
        display: inline-flex;
        align-items: center;
        gap: var(--spacing-xs);
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: var(--font-sm);
        font-weight: var(--font-medium);
        border: 1px solid transparent;
        border-radius: var(--border-radius);
        cursor: pointer;
        transition: var(--transition-fast);
        text-decoration: none;
        white-space: nowrap;
        /* 🔧 強制色指定でボタンを確実に表示 */
        background-color: #6b7280 !important; /* デフォルトグレー */
        color: #ffffff !important; /* 白文字 */
        border-color: #6b7280 !important; /* グレーボーダー */
      }

      .kicho__btn--primary {
        /* 🔧 プライマリボタン - 確実に表示 */
        background-color: #8b5cf6 !important; /* 紫色 */
        color: #ffffff !important; /* 白文字 */
        border-color: #8b5cf6 !important; /* 紫ボーダー */
      }

      .kicho__btn--primary:hover {
        background-color: #7c3aed !important; /* 濃紫 */
        border-color: #7c3aed !important;
      }

      .kicho__btn--secondary {
        /* 🔧 セカンダリボタン - 確実に表示 */
        background-color: #ffffff !important; /* 白背景 */
        color: #111827 !important; /* 黒文字 */
        border-color: #d1d5db !important; /* グレーボーダー */
      }

      .kicho__btn--secondary:hover {
        background-color: #f3f4f6 !important; /* 薄グレー */
      }

      .kicho__btn--success {
        /* 🔧 成功ボタン - 確実に表示 */
        background-color: #10b981 !important; /* 緑色 */
        color: #ffffff !important; /* 白文字 */
        border-color: #10b981 !important; /* 緑ボーダー */
      }

      .kicho__btn--info {
        /* 🔧 インフォボタン - 確実に表示 */
        background-color: #3b82f6 !important; /* 青色 */
        color: #ffffff !important; /* 白文字 */
        border-color: #3b82f6 !important; /* 青ボーダー */
      }

      .kicho__btn--warning {
        /* 🔧 警告ボタン - 確実に表示 */
        background-color: #f59e0b !important; /* 黄色 */
        color: #ffffff !important; /* 白文字 */
        border-color: #f59e0b !important; /* 黄ボーダー */
      }

      .kicho__btn--danger {
        /* 🔧 危険ボタン - 確実に表示 */
        background-color: #ef4444 !important; /* 赤色 */
        color: #ffffff !important; /* 白文字 */
        border-color: #ef4444 !important; /* 赤ボーダー */
      }

      .kicho__btn--full {
        width: 100%;
        justify-content: center;
      }

      .kicho__btn--small {
        padding: var(--spacing-xs) var(--spacing-sm);
        font-size: var(--font-xs);
      }

      /* =====================================
           アップロードエリア
           ===================================== */
      .kicho__upload-area {
        border: 2px dashed var(--border-color);
        border-radius: var(--border-radius);
        padding: var(--spacing-xl);
        text-align: center;
        cursor: pointer;
        transition: var(--transition-fast);
        background: var(--bg-primary);
      }

      .kicho__upload-area:hover {
        border-color: var(--kicho-primary);
        background: rgba(139, 92, 246, 0.05);
      }

      .kicho__upload-area__icon {
        font-size: 2rem;
        color: var(--text-muted);
        margin-bottom: var(--spacing-sm);
      }

      .kicho__upload-area__text {
        font-weight: var(--font-semibold);
        color: var(--text-primary);
        margin-bottom: var(--spacing-xs);
      }

      .kicho__upload-area__subtext {
        font-size: var(--font-sm);
        color: var(--text-muted);
      }

      /* =====================================
           取り込み済みデータ一覧
           ===================================== */
      .kicho__imported-data-section {
        background: var(--bg-tertiary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        margin: var(--spacing-xl) 0;
        box-shadow: var(--shadow-sm);
      }

      .kicho__imported-data__header {
        padding: var(--spacing-lg);
        border-bottom: 1px solid var(--border-light);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .kicho__imported-data__header h3 {
        font-size: var(--font-xl);
        font-weight: var(--font-bold);
        color: var(--text-primary);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin: 0;
      }

      .kicho__imported-data__summary {
        display: flex;
        gap: var(--spacing-lg);
        font-size: var(--font-sm);
        color: var(--text-muted);
      }

      .kicho__imported-data__summary span {
        white-space: nowrap;
      }

      .kicho__imported-data__controls {
        padding: var(--spacing-md) var(--spacing-lg);
        border-bottom: 1px solid var(--border-light);
        display: flex;
        gap: var(--spacing-sm);
        flex-wrap: wrap;
      }

      .kicho__imported-data__list {
        padding: var(--spacing-lg);
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
      }

      .kicho__data-item {
        background: var(--bg-primary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-md);
        transition: var(--transition-fast);
      }

      .kicho__data-item:hover {
        box-shadow: var(--shadow-sm);
      }

      .kicho__data-checkbox {
        width: 16px;
        height: 16px;
        cursor: pointer;
      }

      .kicho__data-info {
        flex: 1;
      }

      .kicho__data-title {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        margin-bottom: var(--spacing-xs);
      }

      .kicho__data-name {
        font-weight: var(--font-semibold);
        color: var(--text-primary);
      }

      .kicho__data-count {
        font-size: var(--font-sm);
        color: var(--text-muted);
        background: var(--bg-tertiary);
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--border-radius);
      }

      .kicho__data-details {
        font-size: var(--font-sm);
        color: var(--text-muted);
      }

      /* =====================================
           MF接続ステータス
           ===================================== */
      .kicho__mf-status {
        background: var(--bg-tertiary);
        border-radius: var(--border-radius);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .kicho__mf-status__indicator {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-weight: var(--font-semibold);
        color: var(--kicho-success);
      }

      .kicho__mf-status__details {
        font-size: var(--font-sm);
        color: var(--text-muted);
        text-align: right;
      }

      /* =====================================
           AI学習ステータス
           ===================================== */
      .kicho__ai-status {
        background: var(--bg-tertiary);
        border-radius: var(--border-radius);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .kicho__ai-status__stage {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: var(--spacing-xs);
        font-size: var(--font-sm);
        color: var(--text-muted);
      }

      .kicho__ai-status__stage i {
        font-size: var(--font-xl);
        color: var(--border-color);
      }

      .kicho__ai-status__stage--completed i {
        color: var(--kicho-success);
      }

      /* =====================================
           CSV・学習オプション
           ===================================== */
      .kicho__csv-options,
      .kicho__learning-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--spacing-md);
        margin: var(--spacing-md) 0;
      }

      .kicho__csv-options .kicho__form-input,
      .kicho__learning-options .kicho__form-input {
        min-width: 0;
        width: 100%;
        font-size: var(--font-sm);
      }

      .kicho__button-group {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
      }

      .kicho__button-group .kicho__btn--small {
        margin-top: var(--spacing-sm);
      }

      /* =====================================
           統合AI学習セクション
           ===================================== */
      .kicho__integrated-ai-learning {
        margin: var(--spacing-xl) 0;
      }

      .kicho__ai-learning__container {
        background: var(--bg-secondary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        box-shadow: var(--shadow-sm);
      }

      .kicho__ai-learning__header {
        text-align: center;
        margin-bottom: var(--spacing-lg);
      }

      .kicho__ai-learning__title {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: var(--spacing-md);
        margin-bottom: var(--spacing-sm);
      }

      .kicho__ai-learning__title i {
        font-size: 2rem;
        color: var(--icon-ai);
      }

      .kicho__ai-learning__title h3 {
        font-size: var(--font-2xl);
        font-weight: var(--font-bold);
        margin: 0;
      }

      .kicho__ai-learning__description {
        font-size: var(--font-base);
        opacity: 0.9;
        max-width: 600px;
        margin: 0 auto;
        line-height: 1.6;
      }

      .kicho__ai-learning__settings {
        background: var(--bg-tertiary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        margin-bottom: var(--spacing-lg);
      }
      .kicho__ai-learning__settings .kicho__form-label {
        color: var(--text-primary);
        font-weight: var(--font-semibold);
      }

      .kicho__ai-learning__settings .kicho__form-input {
        background: var(--bg-primary);
        border: 1px solid var(--border-color);
        color: var(--text-primary);
      }

      .kicho__ai-learning__data-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--spacing-md);
        margin-top: var(--spacing-lg);
      }

      .kicho__data-summary__item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-sm);
        background: rgba(255, 255, 255, 0.1);
        border-radius: var(--border-radius);
      }

      .kicho__data-summary__label {
        font-size: var(--font-sm);
        opacity: 0.8;
      }

      .kicho__data-summary__value {
        font-weight: var(--font-semibold);
        font-size: var(--font-base);
      }

      .kicho__ai-learning__actions {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--spacing-md);
      }

      .kicho__ai-learning__actions .kicho__btn {
        padding: var(--spacing-md) var(--spacing-lg);
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
      }

      .kicho__ai-learning__actions .kicho__btn--success {
        background: var(--icon-ai);
        color: var(--text-white);
        border: 2px solid var(--icon-ai);
        animation: pulse-glow 2s infinite;
      }

      .kicho__ai-learning__actions .kicho__btn--success:hover {
        background: #e55a2b;
        border-color: #e55a2b;
      }

      /* =====================================
           ルール保存・承認機能
           ===================================== */
      .kicho__rule-save-section {
        background: rgba(139, 92, 246, 0.1);
        border: 2px solid var(--kicho-primary);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        margin-top: var(--spacing-md);
      }

      .kicho__rule-save__title {
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
        color: var(--kicho-primary);
        margin-bottom: var(--spacing-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .kicho__rule-options {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
        margin: var(--spacing-md) 0;
      }

      .kicho__rule-options label {
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
        font-size: var(--font-sm);
        color: var(--text-primary);
        cursor: pointer;
      }

      .kicho__approval-section {
        background: rgba(16, 185, 129, 0.1);
        border: 2px solid var(--kicho-success);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        margin-top: var(--spacing-md);
      }

      .kicho__approval__title {
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
        color: var(--kicho-success);
        margin-bottom: var(--spacing-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .kicho__approval-summary {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: var(--spacing-md);
        margin-top: var(--spacing-md);
      }

      .kicho__summary-item {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: var(--spacing-sm);
        background: rgba(255, 255, 255, 0.8);
        border-radius: var(--border-radius);
      }

      .kicho__summary-label {
        font-size: var(--font-sm);
        color: var(--text-muted);
      }

      .kicho__summary-value {
        font-weight: var(--font-semibold);
        font-size: var(--font-base);
        color: var(--text-primary);
      }

      /* =====================================
           保存済みルール・承認データ表示
           ===================================== */
      .kicho__saved-rules-section {
        background: rgba(124, 58, 237, 0.1);
        border: 1px solid var(--icon-rule);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        margin: var(--spacing-xl) 0;
      }

      .kicho__saved-rules__title {
        font-size: var(--font-xl);
        font-weight: var(--font-bold);
        color: var(--icon-rule);
        margin-bottom: var(--spacing-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .kicho__saved-rules__list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        max-height: 300px;
        overflow-y: auto;
      }

      .kicho__saved-rule-item {
        background: var(--bg-primary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-md);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .kicho__saved-rule__info {
        flex: 1;
      }

      .kicho__saved-rule__name {
        font-weight: var(--font-semibold);
        color: var(--text-primary);
        margin-bottom: var(--spacing-xs);
      }

      .kicho__saved-rule__details {
        font-size: var(--font-sm);
        color: var(--text-secondary);
      }

      .kicho__saved-rule__actions {
        display: flex;
        gap: var(--spacing-sm);
      }

      .kicho__approved-transactions-section {
        background: rgba(5, 150, 105, 0.1);
        border: 1px solid var(--icon-approval);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
        margin: var(--spacing-xl) 0;
      }

      .kicho__approved-transactions__title {
        font-size: var(--font-xl);
        font-weight: var(--font-bold);
        color: var(--icon-approval);
        margin-bottom: var(--spacing-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .kicho__approved-transactions__list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-md);
        max-height: 300px;
        overflow-y: auto;
      }

      .kicho__approved-transaction-item {
        background: var(--bg-primary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-md);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .kicho__approved-transaction__info {
        flex: 1;
      }

      .kicho__approved-transaction__name {
        font-weight: var(--font-semibold);
        color: var(--text-primary);
        margin-bottom: var(--spacing-xs);
      }

      .kicho__approved-transaction__details {
        font-size: var(--font-sm);
        color: var(--text-secondary);
      }

      .kicho__approved-transaction__actions {
        display: flex;
        gap: var(--spacing-sm);
      }

      /* =====================================
           AI学習履歴システム
           ===================================== */
      .kicho__learning-history {
        background: var(--bg-primary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-lg);
      }

      .kicho__learning-history h4 {
        font-size: var(--font-lg);
        font-weight: var(--font-semibold);
        color: var(--text-primary);
        margin-bottom: var(--spacing-md);
        display: flex;
        align-items: center;
        gap: var(--spacing-sm);
      }

      .kicho__session-list {
        display: flex;
        flex-direction: column;
        gap: var(--spacing-sm);
        max-height: 250px;
        overflow-y: auto;
      }

      .kicho__session-item {
        background: var(--bg-tertiary);
        border: 1px solid var(--border-light);
        border-radius: var(--border-radius);
        padding: var(--spacing-md);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .kicho__session-datetime {
        font-size: var(--font-sm);
        color: var(--text-primary);
        font-weight: var(--font-medium);
      }

      .kicho__session-status--success {
        background: var(--kicho-success);
        color: var(--text-white);
        padding: var(--spacing-xs) var(--spacing-sm);
        border-radius: var(--border-radius);
        font-size: var(--font-xs);
        font-weight: var(--font-medium);
      }

      /* アニメーション */
      @keyframes pulse-glow {
        0%,
        100% {
          box-shadow: 0 0 10px rgba(234, 88, 12, 0.3);
        }
        50% {
          box-shadow: 0 0 20px rgba(234, 88, 12, 0.6);
        }
      }

      /* =====================================
           レスポンシブ対応
           ===================================== */
      @media (max-width: 1024px) {
        .kicho__overview-section {
          grid-template-columns: 1fr;
        }
      }

      @media (max-width: 768px) {
        .kicho__container {
          padding: var(--spacing-md);
        }

        .kicho__header {
          flex-direction: column;
          align-items: stretch;
          text-align: center;
          margin: calc(-1 * var(--spacing-md)) calc(-1 * var(--spacing-md))
            var(--spacing-lg);
        }

        .kicho__header-left,
        .kicho__header-actions {
          width: 100%;
        }

        .kicho__header-actions {
          justify-content: center;
        }

        .dashboard__stats-grid {
          grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
          gap: var(--spacing-md);
        }

        .kicho__section__header {
          flex-direction: column;
          align-items: stretch;
        }

        .kicho__section__actions {
          justify-content: center;
        }

        .kicho__mf-status {
          flex-direction: column;
          gap: var(--spacing-sm);
          text-align: center;
        }

        .kicho__mf-status__details {
          text-align: center;
        }

        .kicho__ai-status {
          flex-direction: column;
          gap: var(--spacing-md);
        }

        .kicho__csv-options,
        .kicho__learning-options {
          grid-template-columns: 1fr;
        }

        .kicho__ai-learning__title {
          flex-direction: column;
          gap: var(--spacing-sm);
        }

        .kicho__ai-learning__title i {
          font-size: 3rem;
        }

        .kicho__data-summary__item {
          flex-direction: column;
          text-align: center;
          gap: var(--spacing-xs);
        }

        .kicho__imported-data__header {
          flex-direction: column;
          align-items: stretch;
          gap: var(--spacing-sm);
        }

        .kicho__imported-data__summary {
          justify-content: space-between;
          text-align: center;
        }

        .kicho__imported-data__controls {
          justify-content: center;
        }
      }

      @media (max-width: 480px) {
        .dashboard__stats-grid {
          grid-template-columns: 1fr;
        }

        .kicho__btn {
          font-size: var(--font-sm);
          padding: var(--spacing-md);
        }

        .dashboard__stat-card__value {
          font-size: 1.5rem;
        }

        .kicho__page-title {
          font-size: var(--font-xl);
        }

        .kicho__imported-data__summary {
          flex-direction: column;
          gap: var(--spacing-sm);
          text-align: center;
        }

        .kicho__ai-learning__data-summary {
          grid-template-columns: 1fr;
        }
      }

      /* =====================================
           テーマ対応（ダークモード）
           ===================================== */
      [data-theme="dark"] .kicho__ai-learning__container {
        background: linear-gradient(135deg, #6d28d9, #7e22ce);
      }

      [data-theme="dark"] .kicho__upload-area:hover {
        background: rgba(139, 92, 246, 0.1);
      }

      [data-theme="dark"] .kicho__rule-save-section {
        background: rgba(139, 92, 246, 0.2);
      }

      [data-theme="dark"] .kicho__approval-section {
        background: rgba(16, 185, 129, 0.2);
      }

      [data-theme="dark"] .kicho__saved-rules-section {
        background: rgba(124, 58, 237, 0.2);
      }

      [data-theme="dark"] .kicho__approved-transactions-section {
        background: rgba(5, 150, 105, 0.2);
      }
    </style>
  <script>
// CAIDS error_handling Hook

// CAIDS エラー処理Hook - 完全実装
window.CAIDS_ERROR_HANDLER = {
    isActive: true,
    errorCount: 0,
    errorHistory: [],
    
    initialize: function() {
        this.setupGlobalErrorHandler();
        this.setupUnhandledPromiseRejection();
        this.setupNetworkErrorHandler();
        console.log('⚠️ CAIDS エラーハンドリングシステム完全初期化');
    },
    
    setupGlobalErrorHandler: function() {
        window.addEventListener('error', (event) => {
            this.handleError({
                type: 'JavaScript Error',
                message: event.message,
                filename: event.filename,
                lineno: event.lineno,
                colno: event.colno,
                stack: event.error?.stack
            });
        });
    },
    
    setupUnhandledPromiseRejection: function() {
        window.addEventListener('unhandledrejection', (event) => {
            this.handleError({
                type: 'Unhandled Promise Rejection',
                message: event.reason?.message || String(event.reason),
                stack: event.reason?.stack
            });
        });
    },
    
    setupNetworkErrorHandler: function() {
        const originalFetch = window.fetch;
        window.fetch = async function(...args) {
            try {
                const response = await originalFetch.apply(this, args);
                if (!response.ok) {
                    window.CAIDS_ERROR_HANDLER.handleError({
                        type: 'Network Error',
                        message: `HTTP ${response.status}: ${response.statusText}`,
                        url: args[0]
                    });
                }
                return response;
            } catch (error) {
                window.CAIDS_ERROR_HANDLER.handleError({
                    type: 'Network Fetch Error',
                    message: error.message,
                    url: args[0]
                });
                throw error;
            }
        };
    },
    
    handleError: function(errorInfo) {
        this.errorCount++;
        this.errorHistory.push({...errorInfo, timestamp: new Date().toISOString()});
        
        console.error('🚨 CAIDS Error Handler:', errorInfo);
        this.showErrorNotification(errorInfo);
        this.reportError(errorInfo);
    },
    
    showErrorNotification: function(errorInfo) {
        const errorDiv = document.createElement('div');
        errorDiv.style.cssText = `
            position: fixed; top: 10px; right: 10px; z-index: 999999;
            background: linear-gradient(135deg, #ff4444, #cc0000);
            color: white; padding: 15px 20px; border-radius: 8px;
            max-width: 350px; box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            font-size: 13px; font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            border: 2px solid #ff6666; animation: caids-error-shake 0.5s ease-in-out;
        `;
        errorDiv.innerHTML = `
            <div style="display: flex; align-items: center; gap: 10px;">
                <span style="font-size: 18px;">🚨</span>
                <div>
                    <strong>エラーが発生しました</strong><br>
                    <small style="opacity: 0.9;">${errorInfo.type}: ${errorInfo.message}</small>
                </div>
            </div>
        `;
        
        // CSS Animation
        if (!document.getElementById('caids-error-styles')) {
            const style = document.createElement('style');
            style.id = 'caids-error-styles';
            style.textContent = `
                @keyframes caids-error-shake {
                    0%, 100% { transform: translateX(0); }
                    25% { transform: translateX(-5px); }
                    75% { transform: translateX(5px); }
                }
            `;
            document.head.appendChild(style);
        }
        
        document.body.appendChild(errorDiv);
        setTimeout(() => errorDiv.remove(), 7000);
    },
    
    reportError: function(errorInfo) {
        // エラーレポート生成・送信（将来の拡張用）
        const report = {
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent,
            url: window.location.href,
            errorCount: this.errorCount,
            sessionId: this.getSessionId(),
            ...errorInfo
        };
        
        console.log('📋 CAIDS Error Report:', report);
        localStorage.setItem('caids_last_error', JSON.stringify(report));
    },
    
    getSessionId: function() {
        let sessionId = sessionStorage.getItem('caids_session_id');
        if (!sessionId) {
            sessionId = 'caids_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
            sessionStorage.setItem('caids_session_id', sessionId);
        }
        return sessionId;
    },
    
    getErrorStats: function() {
        return {
            totalErrors: this.errorCount,
            recentErrors: this.errorHistory.slice(-10),
            sessionId: this.getSessionId()
        };
    }
};

window.CAIDS_ERROR_HANDLER.initialize();

</script>
<script>
// CAIDS user_feedback Hook
// CAIDS user_feedback Hook - 基本実装
console.log('✅ user_feedback Hook loaded');
</script>
<script>
// CAIDS character_limit Hook
// CAIDS character_limit Hook - 基本実装
console.log('✅ character_limit Hook loaded');
</script>
<script>
// CAIDS character_monitoring Hook
// CAIDS character_monitoring Hook - 基本実装
console.log('✅ character_monitoring Hook loaded');
</script>
<script>
// CAIDS emergency_accumulation Hook
// CAIDS emergency_accumulation Hook - 基本実装
console.log('✅ emergency_accumulation Hook loaded');
</script>
<script>
// CAIDS processing_capacity_monitoring Hook
// CAIDS processing_capacity_monitoring Hook - 基本実装
console.log('✅ processing_capacity_monitoring Hook loaded');
</script>
<script>
// CAIDS pre_analysis_enforcement Hook
// CAIDS pre_analysis_enforcement Hook - 基本実装
console.log('✅ pre_analysis_enforcement Hook loaded');
</script>
<script>
// CAIDS user_approval_required Hook
// CAIDS user_approval_required Hook - 基本実装
console.log('✅ user_approval_required Hook loaded');
</script>
<script>
// CAIDS timeout_management Hook
// CAIDS timeout_management Hook - 基本実装
console.log('✅ timeout_management Hook loaded');
</script>
<script>
// CAIDS development_control Hook
// CAIDS development_control Hook - 基本実装
console.log('✅ development_control Hook loaded');
</script>
<script>
// CAIDS natural_explanation Hook
// CAIDS natural_explanation Hook - 基本実装
console.log('✅ natural_explanation Hook loaded');
</script>
</head>
  <body data-page="kicho">
    <div class="kicho__container">
      <!-- ページヘッダー -->
      <div class="kicho__header">
        <div class="kicho__header-left">
          <h1 class="kicho__page-title">
            <i class="fas fa-calculator kicho__page-icon"></i>
            記帳自動化ツール
          </h1>
          <div class="kicho__system-status">
            <div
              class="kicho__status-item kicho__status-item--active"
              id="systemStatus"
            >
              <i class="fas fa-circle"></i>
              <span>システム稼働中</span>
            </div>
            <div class="kicho__status-item" id="lastUpdateDisplay">
              <i class="fas fa-clock"></i>
              <span
                >最終更新:
                <span id="lastUpdateTime">2025-07-07 15:30</span></span
              >
            </div>
          </div>
        </div>
        <div class="kicho__header-actions">
          <button
            class="kicho__btn kicho__btn--secondary"
            data-action="refresh-all"
          >
            <i class="fas fa-sync-alt"></i>
            全データ更新
          </button>
          <button
            class="kicho__btn kicho__btn--success"
            data-action="toggle-auto-refresh"
          >
            <i class="fas fa-play"></i>
            自動更新開始
          </button>
        </div>
      </div>

      <!-- リアルタイム統計ダッシュボード -->
      <div class="dashboard__stats-grid">
        <div class="dashboard__stat-card">
          <div class="dashboard__stat-card__header">
            <span class="dashboard__stat-card__title">承認待ち</span>
            <div class="dashboard__stat-card__icon">
              <i class="fas fa-check-circle"></i>
            </div>
          </div>
          <div class="dashboard__stat-card__value" id="pending-count">23件</div>
          <div class="dashboard__stat-card__trend" id="pending-trend">
            <span>前回より +3件</span>
          </div>
        </div>

        <div class="dashboard__stat-card">
          <div class="dashboard__stat-card__header">
            <span class="dashboard__stat-card__title">確定ルール</span>
            <div class="dashboard__stat-card__icon">
              <i class="fas fa-robot"></i>
            </div>
          </div>
          <div class="dashboard__stat-card__value" id="confirmed-rules">
            158件
          </div>
          <div class="dashboard__stat-card__trend" id="rules-trend">
            <span>今月 +12件</span>
          </div>
        </div>

        <div class="dashboard__stat-card">
          <div class="dashboard__stat-card__header">
            <span class="dashboard__stat-card__title">AI自動化率</span>
            <div class="dashboard__stat-card__icon">
              <i class="fas fa-percentage"></i>
            </div>
          </div>
          <div class="dashboard__stat-card__value" id="automation-rate">
            92%
          </div>
          <div class="dashboard__stat-card__trend" id="automation-trend">
            <span>目標達成</span>
          </div>
        </div>

        <div class="dashboard__stat-card">
          <div class="dashboard__stat-card__header">
            <span class="dashboard__stat-card__title">処理中エラー</span>
            <div class="dashboard__stat-card__icon">
              <i class="fas fa-exclamation-triangle"></i>
            </div>
          </div>
          <div class="dashboard__stat-card__value" id="error-count">2件</div>
          <div class="dashboard__stat-card__trend" id="error-trend">
            <span>軽微な問題</span>
          </div>
        </div>

        <div class="dashboard__stat-card">
          <div class="dashboard__stat-card__header">
            <span class="dashboard__stat-card__title">今月処理件数</span>
            <div class="dashboard__stat-card__icon">
              <i class="fas fa-chart-line"></i>
            </div>
          </div>
          <div class="dashboard__stat-card__value" id="monthly-count">
            1,247件
          </div>
          <div class="dashboard__stat-card__trend" id="monthly-trend">
            <span>計画通り</span>
          </div>
        </div>
      </div>

      <!-- データ取り込みセクション【拡張版】 -->
      <section class="kicho__section" id="data-import">
        <div class="kicho__section__header">
          <div>
            <h2 class="kicho__section__title">
              <i class="fas fa-upload"></i>
              データ取り込み【拡張版】
            </h2>
            <p class="kicho__section__subtitle">
              MFクラウド連携・CSV重複防止・AI学習
            </p>
          </div>
          <div class="kicho__section__actions">
            <button
              class="kicho__btn kicho__btn--info"
              data-action="show-import-history"
            >
              <i class="fas fa-history"></i>
              取り込み履歴
            </button>
          </div>
        </div>

        <div class="kicho__overview-section">
          <!-- MFクラウド連携【履歴管理】 -->
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-cloud icon--mf"></i>
              <h3>MFクラウド連携【履歴管理】</h3>
            </div>

            <!-- MF接続ステータス -->
            <div class="kicho__mf-status">
              <div class="kicho__mf-status__indicator">
                <i class="fas fa-wifi"></i>
                <span>connected</span>
              </div>
              <div class="kicho__mf-status__details">
                <div>前回同期: 2025-07-07 04:46:47</div>
                <div>エラー数: 2</div>
              </div>
            </div>

            <form data-form="mf-import">
              <div class="kicho__form-group">
                <label class="kicho__form-label">取得期間</label>
                <div
                  style="
                    display: flex;
                    gap: var(--spacing-sm);
                    align-items: center;
                  "
                >
                  <input
                    type="date"
                    class="kicho__form-input"
                    value="2025-01-01"
                    id="mfStartDate"
                    style="flex: 1; min-width: 120px"
                  />
                  <span
                    style="
                      color: var(--text-muted);
                      font-size: var(--font-sm);
                      white-space: nowrap;
                    "
                    >〜</span
                  >
                  <input
                    type="date"
                    class="kicho__form-input"
                    value="2025-07-07"
                    id="mfEndDate"
                    style="flex: 1; min-width: 120px"
                  />
                </div>
              </div>

              <div class="kicho__form-group">
                <label class="kicho__form-label">取り込み目的</label>
                <select class="kicho__form-input" id="mfPurpose">
                  <option value="processing" selected>
                    記帳処理用（日常業務）
                  </option>
                  <option value="learning">AI学習用（過去データ分析）</option>
                  <option value="both">両方</option>
                </select>
              </div>

              <div class="kicho__button-group">
                <button
                  type="button"
                  class="kicho__btn kicho__btn--primary kicho__btn--full"
                  data-action="execute-mf-import"
                >
                  <i class="fas fa-download"></i>
                  MFクラウドから取得
                </button>
                <button
                  type="button"
                  class="kicho__btn kicho__btn--info kicho__btn--small"
                  data-action="show-mf-history"
                >
                  <i class="fas fa-list"></i>
                  MF連携履歴
                </button>
                <button
                  type="button"
                  class="kicho__btn kicho__btn--warning kicho__btn--small"
                  data-action="execute-mf-recovery"
                >
                  <i class="fas fa-first-aid"></i>
                  自動復旧実行
                </button>
              </div>
            </form>
          </div>

          <!-- CSVアップロード【重複防止】 -->
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-file-csv icon--csv"></i>
              <h3>CSVアップロード【重複防止】</h3>
            </div>

            <form data-form="csv-upload">
              <div class="kicho__upload-area" data-action="csv-upload">
                <i class="fas fa-cloud-upload-alt kicho__upload-area__icon"></i>
                <p class="kicho__upload-area__text">
                  CSVファイルをドラッグ&ドロップ
                </p>
                <p class="kicho__upload-area__subtext">
                  重複検出・自動解決機能付き
                </p>
                <input
                  type="file"
                  id="csvFileInput"
                  accept=".csv"
                  style="display: none"
                />
              </div>

              <div class="kicho__csv-options">
                <div class="kicho__form-group">
                  <label class="kicho__form-label">重複検出方式</label>
                  <select class="kicho__form-input" id="duplicateStrategy">
                    <option value="transaction_no">取引No完全一致</option>
                    <option value="date_amount_desc">日付+金額+摘要</option>
                    <option value="hash_match">データハッシュ一致</option>
                  </select>
                </div>
                <div class="kicho__form-group">
                  <label class="kicho__form-label">解決方法</label>
                  <select class="kicho__form-input" id="resolutionStrategy">
                    <option value="skip">重複をスキップ</option>
                    <option value="replace">重複を置き換え</option>
                    <option value="merge">インテリジェントマージ</option>
                    <option value="suffix">サフィックス付きで保存</option>
                  </select>
                </div>
              </div>

              <div class="kicho__button-group">
                <button
                  type="button"
                  class="kicho__btn kicho__btn--secondary kicho__btn--full"
                  data-action="process-csv-upload"
                >
                  <i class="fas fa-upload"></i>
                  重複チェック&アップロード
                </button>
                <button
                  type="button"
                  class="kicho__btn kicho__btn--info kicho__btn--small"
                  data-action="show-duplicate-history"
                >
                  <i class="fas fa-shield-alt"></i>
                  重複処理履歴
                </button>
              </div>
            </form>
          </div>

          <!-- AIテキスト学習【履歴分析】 -->
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-brain icon--ai"></i>
              <h3>AIテキスト学習【履歴分析】</h3>
            </div>

            <!-- AI学習ステータス -->
            <div class="kicho__ai-status">
              <div class="kicho__ai-status__stage">
                <i class="fas fa-brain"></i>
                <span>テキスト解析</span>
              </div>
              <div class="kicho__ai-status__stage">
                <i class="fas fa-cogs"></i>
                <span>ルール生成</span>
              </div>
              <div
                class="kicho__ai-status__stage kicho__ai-status__stage--completed"
              >
                <i class="fas fa-check"></i>
                <span>検証完了</span>
              </div>
            </div>

            <form data-form="ai-text-learning">
              <div class="kicho__form-group">
                <label class="kicho__form-label">学習テキスト入力</label>
                <textarea
                  class="kicho__form-input"
                  id="aiTextInput"
                  rows="4"
                  placeholder="複数ルールを同時学習可能&#10;&#10;例：&#10;Amazon購入 → 消耗品費 (課税仕入10%)&#10;Google広告 → 広告宣伝費 (課税仕入10%)&#10;電車代5000円未満 → 旅費交通費"
                >
Amazonは消耗品費として処理
交通費で5000円以下は旅費交通費として処理
Google Adsは広告宣伝費に計上</textarea
                >
              </div>

              <div class="kicho__learning-options">
                <div class="kicho__form-group">
                  <label class="kicho__form-label">学習モード</label>
                  <select class="kicho__form-input" id="learningMode">
                    <option value="incremental">インクリメンタル学習</option>
                    <option value="batch">バッチ学習</option>
                    <option value="reinforcement">強化学習</option>
                  </select>
                </div>
                <div class="kicho__form-group">
                  <label class="kicho__form-label">ルールカテゴリ</label>
                  <select class="kicho__form-input" id="ruleCategory">
                    <option value="expense">経費処理</option>
                    <option value="sales">売上処理</option>
                    <option value="asset">資産処理</option>
                    <option value="general">一般処理</option>
                  </select>
                </div>
              </div>

              <div class="kicho__button-group">
                <button
                  type="button"
                  class="kicho__btn kicho__btn--secondary kicho__btn--full"
                  data-action="add-text-to-learning"
                >
                  <i class="fas fa-plus"></i>
                  学習データに追加
                </button>
                <button
                  type="button"
                  class="kicho__btn kicho__btn--info kicho__btn--small"
                  data-action="show-ai-learning-history"
                >
                  <i class="fas fa-chart-line"></i>
                  学習履歴・分析
                </button>
                <button
                  type="button"
                  class="kicho__btn kicho__btn--warning kicho__btn--small"
                  data-action="show-optimization-suggestions"
                >
                  <i class="fas fa-lightbulb"></i>
                  最適化提案
                </button>
              </div>
            </form>
          </div>
        </div>

        <!-- 取り込み済みデータ一覧 -->
        <div class="kicho__imported-data-section">
          <div class="kicho__imported-data__header">
            <h3>
              <i class="fas fa-database"></i>
              取り込み済みデータ一覧
            </h3>
            <div class="kicho__imported-data__summary">
              <span>MFデータ: <strong id="mfDataCount">2</strong>件</span>
              <span>CSVデータ: <strong id="csvDataCount">3</strong>件</span>
              <span>学習テキスト: <strong id="textDataCount">4</strong>件</span>
              <span>選択中: <strong id="selectedDataCount">0</strong>件</span>
            </div>
          </div>

          <div class="kicho__imported-data__controls">
            <button
              class="kicho__btn kicho__btn--small kicho__btn--secondary"
              data-action="select-all-imported-data"
            >
              <i class="fas fa-check-square"></i>
              全選択
            </button>
            <button
              class="kicho__btn kicho__btn--small kicho__btn--secondary"
              data-action="select-by-date-range"
            >
              <i class="fas fa-calendar"></i>
              期間選択
            </button>
            <button
              class="kicho__btn kicho__btn--small kicho__btn--info"
              data-action="select-by-source"
              data-source="mf"
            >
              <i class="fas fa-cloud"></i>
              MFデータのみ
            </button>
            <button
              class="kicho__btn kicho__btn--small kicho__btn--info"
              data-action="select-by-source"
              data-source="csv"
            >
              <i class="fas fa-file-csv"></i>
              CSVデータのみ
            </button>
            <button
              class="kicho__btn kicho__btn--small kicho__btn--warning"
              data-action="select-by-source"
              data-source="text"
            >
              <i class="fas fa-brain"></i>
              テキスト学習のみ
            </button>
            <button
              class="kicho__btn kicho__btn--small kicho__btn--danger"
              data-action="delete-selected-data"
            >
              <i class="fas fa-trash"></i>
              選択削除
            </button>
          </div>

          <div class="kicho__imported-data__list">
            <!-- MFデータ例 -->
            <div class="kicho__data-item" data-source="mf" data-item-id="mf-1">
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-cloud icon--mf"></i>
                  <span class="kicho__data-name"
                    >2025-01-01〜2025-01-07 MFデータ</span
                  >
                  <span class="kicho__data-count">(150件)</span>
                </div>
                <div class="kicho__data-details">
                  取得日: 2025-01-07 10:30 | 記帳処理用
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="mf-1"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <div class="kicho__data-item" data-source="mf" data-item-id="mf-2">
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-cloud icon--mf"></i>
                  <span class="kicho__data-name"
                    >2025-01-15〜2025-01-20 MFデータ</span
                  >
                  <span class="kicho__data-count">(89件)</span>
                </div>
                <div class="kicho__data-details">
                  取得日: 2025-01-20 15:45 | AI学習用
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="mf-2"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <!-- CSVデータ例 -->
            <div
              class="kicho__data-item"
              data-source="csv"
              data-item-id="csv-1"
            >
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-file-csv icon--csv"></i>
                  <span class="kicho__data-name">取引履歴_2025年1月.csv</span>
                  <span class="kicho__data-count">(45件)</span>
                </div>
                <div class="kicho__data-details">
                  アップロード: 2025-01-05 14:20 | 重複: 3件検出・解決済み
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="csv-1"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <div
              class="kicho__data-item"
              data-source="csv"
              data-item-id="csv-2"
            >
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-file-csv icon--csv"></i>
                  <span class="kicho__data-name">経費データ_Q1.csv</span>
                  <span class="kicho__data-count">(23件)</span>
                </div>
                <div class="kicho__data-details">
                  アップロード: 2025-01-03 09:15 | 重複なし
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="csv-2"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <div
              class="kicho__data-item"
              data-source="csv"
              data-item-id="csv-3"
            >
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-file-csv icon--csv"></i>
                  <span class="kicho__data-name">売上明細_202501.csv</span>
                  <span class="kicho__data-count">(67件)</span>
                </div>
                <div class="kicho__data-details">
                  アップロード: 2025-01-08 11:30 | 重複: 1件スキップ
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="csv-3"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <!-- AIテキスト学習例 -->
            <div
              class="kicho__data-item"
              data-source="text"
              data-item-id="text-1"
            >
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-brain icon--ai"></i>
                  <span class="kicho__data-name"
                    >学習セット001: Amazon・Google広告ルール</span
                  >
                </div>
                <div class="kicho__data-details">
                  作成日: 2025-01-07 16:20 | Amazon→消耗品費、Google
                  Ads→広告宣伝費
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="text-1"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <div
              class="kicho__data-item"
              data-source="text"
              data-item-id="text-2"
            >
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-brain icon--ai"></i>
                  <span class="kicho__data-name"
                    >学習セット002: 交通費処理ルール</span
                  >
                </div>
                <div class="kicho__data-details">
                  作成日: 2025-01-06 13:45 |
                  5000円未満→旅費交通費、5000円以上→出張費
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="text-2"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <div
              class="kicho__data-item"
              data-source="text"
              data-item-id="text-3"
            >
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-brain icon--ai"></i>
                  <span class="kicho__data-name"
                    >学習セット003: 税区分自動判定ルール</span
                  >
                </div>
                <div class="kicho__data-details">
                  作成日: 2025-01-04 10:30 |
                  課税仕入10%、軽減税率8%、非課税の自動判定
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="text-3"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>

            <div
              class="kicho__data-item"
              data-source="text"
              data-item-id="text-4"
            >
              <input
                type="checkbox"
                class="kicho__data-checkbox"
                data-checkbox="data-item"
              />
              <div class="kicho__data-info">
                <div class="kicho__data-title">
                  <i class="fas fa-brain icon--ai"></i>
                  <span class="kicho__data-name"
                    >学習セット004: 部門別振り分けルール</span
                  >
                </div>
                <div class="kicho__data-details">
                  作成日: 2025-01-02 14:15 |
                  営業部、開発部、管理部の自動振り分け
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-data-item"
                data-item-id="text-4"
              >
                <i class="fas fa-trash"></i>
              </button>
            </div>
          </div>

          <!-- 統合AI学習実行 -->
          <div class="kicho__integrated-ai-learning">
            <div class="kicho__ai-learning__container">
              <div class="kicho__ai-learning__header">
                <div class="kicho__ai-learning__title">
                  <i class="fas fa-brain"></i>
                  <h3>統合AI学習実行</h3>
                </div>
                <div class="kicho__ai-learning__description">
                  選択したデータを統合してAI学習を実行し、自動記帳ルールを生成・更新します
                </div>
              </div>

              <div class="kicho__ai-learning__settings">
                <div class="kicho__form-group">
                  <label class="kicho__form-label">学習モード</label>
                  <select class="kicho__form-input" id="integratedLearningMode">
                    <option value="incremental" selected>
                      インクリメンタル学習（既存ルール更新）
                    </option>
                    <option value="full">フル学習（全データ再学習）</option>
                    <option value="selective">選択データのみ学習</option>
                  </select>
                </div>

                <div class="kicho__ai-learning__data-summary">
                  <div class="kicho__data-summary__item">
                    <span class="kicho__data-summary__label">選択データ:</span>
                    <span
                      class="kicho__data-summary__value"
                      id="learningDataCount"
                      >0件選択中</span
                    >
                  </div>
                  <div class="kicho__data-summary__item">
                    <span class="kicho__data-summary__label"
                      >推定生成ルール:</span
                    >
                    <span class="kicho__data-summary__value" id="estimatedRules"
                      >0-0件</span
                    >
                  </div>
                  <div class="kicho__data-summary__item">
                    <span class="kicho__data-summary__label"
                      >推定処理時間:</span
                    >
                    <span class="kicho__data-summary__value" id="estimatedTime"
                      >未選択</span
                    >
                  </div>
                </div>
              </div>

              <div class="kicho__ai-learning__actions">
                <button
                  class="kicho__btn kicho__btn--success kicho__btn--full"
                  data-action="execute-integrated-ai-learning"
                >
                  <i class="fas fa-magic"></i>
                  統合AI学習実行
                </button>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- ルール管理セクション【保存機能追加】 -->
      <section class="kicho__section" id="rules-management">
        <div class="kicho__section__header">
          <div>
            <h2 class="kicho__section__title">
              <i class="fas fa-cogs icon--rule"></i>
              ルール管理
            </h2>
            <p class="kicho__section__subtitle">
              CSV出力で確認・修正してアップロード・保存
            </p>
          </div>
          <div class="kicho__section__actions">
            <button
              class="kicho__btn kicho__btn--info"
              data-action="download-rules-csv"
            >
              <i class="fas fa-download"></i>
              ルールCSV出力
            </button>
            <button
              class="kicho__btn kicho__btn--primary"
              data-action="create-new-rule"
            >
              <i class="fas fa-plus"></i>
              新規ルール
            </button>
          </div>
        </div>

        <div class="kicho__overview-section">
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-table icon--csv"></i>
              <h3>ルール一覧操作</h3>
            </div>
            <div
              style="
                margin-bottom: var(--spacing-md);
                font-size: var(--font-sm);
                color: var(--text-muted);
              "
            >
              総ルール数: <strong>158件</strong><br />
              承認待ち: <strong>12件</strong><br />
              確定済み: <strong>146件</strong>
            </div>

            <button
              class="kicho__btn kicho__btn--info kicho__btn--full"
              data-action="download-all-rules-csv"
            >
              <i class="fas fa-download"></i>
              全ルールCSV出力
            </button>

            <div
              style="
                margin: var(--spacing-md) 0;
                text-align: center;
                color: var(--text-muted);
                font-size: var(--font-sm);
              "
            >
              ↓ CSV編集・確認後 ↓
            </div>

            <div class="kicho__upload-area" data-action="rules-csv-upload">
              <i class="fas fa-file-csv kicho__upload-area__icon"></i>
              <p class="kicho__upload-area__text">
                編集済みルールCSVをアップロード
              </p>
              <p class="kicho__upload-area__subtext">
                修正・承認後のデータ反映
              </p>
              <input
                type="file"
                id="rulesCSVInput"
                accept=".csv"
                style="display: none"
              />
            </div>

            <!-- ルール保存機能 -->
            <div class="kicho__rule-save-section">
              <h4 class="kicho__rule-save__title">
                <i class="fas fa-database icon--rule"></i>
                アップロードデータをルールとして保存
              </h4>
              <div class="kicho__rule-options">
                <label>
                  <input
                    type="radio"
                    name="rule_save_mode"
                    value="merge"
                    checked
                  />
                  <span>重複ルールをマージ（推奨）</span>
                </label>
                <label>
                  <input type="radio" name="rule_save_mode" value="overwrite" />
                  <span>重複ルールを上書き</span>
                </label>
                <label>
                  <input type="radio" name="rule_save_mode" value="skip" />
                  <span>重複ルールをスキップ</span>
                </label>
                <label>
                  <input type="radio" name="rule_save_mode" value="rename" />
                  <span>重複ルールにサフィックス付与</span>
                </label>
              </div>
              <button
                class="kicho__btn kicho__btn--success kicho__btn--full"
                data-action="save-uploaded-rules-as-database"
              >
                <i class="fas fa-database"></i>
                ルールデータベースに保存
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- 保存済みルールデータ表示セクション -->
      <section class="kicho__saved-rules-section">
        <h3 class="kicho__saved-rules__title">
          <i class="fas fa-database icon--rule"></i>
          保存済みルールデータ（<span id="savedRulesCount">3</span>件）
        </h3>
        <div class="kicho__saved-rules__list" id="savedRulesList">
          <div class="kicho__saved-rule-item" data-rule-id="1">
            <div class="kicho__saved-rule__info">
              <div class="kicho__saved-rule__name">
                取引履歴_2025年1月.csv ルール
              </div>
              <div class="kicho__saved-rule__details">
                保存日: 2025-01-07 15:30 | ルール数: 12件 | 精度: 95%
              </div>
            </div>
            <div class="kicho__saved-rule__actions">
              <button
                class="kicho__btn kicho__btn--small kicho__btn--secondary"
                data-action="edit-saved-rule"
                data-rule-id="1"
              >
                <i class="fas fa-edit"></i>
                編集
              </button>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-saved-rule"
                data-rule-id="1"
              >
                <i class="fas fa-trash"></i>
                削除
              </button>
            </div>
          </div>

          <div class="kicho__saved-rule-item" data-rule-id="2">
            <div class="kicho__saved-rule__info">
              <div class="kicho__saved-rule__name">
                経費データ_Q1.csv ルール
              </div>
              <div class="kicho__saved-rule__details">
                保存日: 2025-01-06 14:20 | ルール数: 8件 | 精度: 88%
              </div>
            </div>
            <div class="kicho__saved-rule__actions">
              <button
                class="kicho__btn kicho__btn--small kicho__btn--secondary"
                data-action="edit-saved-rule"
                data-rule-id="2"
              >
                <i class="fas fa-edit"></i>
                編集
              </button>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-saved-rule"
                data-rule-id="2"
              >
                <i class="fas fa-trash"></i>
                削除
              </button>
            </div>
          </div>

          <div class="kicho__saved-rule-item" data-rule-id="3">
            <div class="kicho__saved-rule__info">
              <div class="kicho__saved-rule__name">
                売上明細_202501.csv ルール
              </div>
              <div class="kicho__saved-rule__details">
                保存日: 2025-01-05 11:15 | ルール数: 15件 | 精度: 92%
              </div>
            </div>
            <div class="kicho__saved-rule__actions">
              <button
                class="kicho__btn kicho__btn--small kicho__btn--secondary"
                data-action="edit-saved-rule"
                data-rule-id="3"
              >
                <i class="fas fa-edit"></i>
                編集
              </button>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-saved-rule"
                data-rule-id="3"
              >
                <i class="fas fa-trash"></i>
                削除
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- 承認待ち取引セクション【一括承認機能追加】 -->
      <section class="kicho__section" id="pending-transactions">
        <div class="kicho__section__header">
          <div>
            <h2 class="kicho__section__title">
              <i class="fas fa-clipboard-check icon--approval"></i>
              承認待ち取引
            </h2>
            <p class="kicho__section__subtitle">
              CSV出力で確認・承認・一括保存
            </p>
          </div>
          <div class="kicho__section__actions">
            <button
              class="kicho__btn kicho__btn--info"
              data-action="download-pending-csv"
            >
              <i class="fas fa-download"></i>
              承認待ちCSV出力
            </button>
          </div>
        </div>

        <div class="kicho__overview-section">
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-check-double icon--approval"></i>
              <h3>承認待ち取引操作</h3>
            </div>
            <div
              style="
                margin-bottom: var(--spacing-md);
                font-size: var(--font-sm);
                color: var(--text-muted);
              "
            >
              承認待ち: <strong>23件</strong><br />
              高信頼度(90%+): <strong>15件</strong><br />
              要確認(90%未満): <strong>8件</strong>
            </div>

            <button
              class="kicho__btn kicho__btn--info kicho__btn--full"
              data-action="download-pending-transactions-csv"
            >
              <i class="fas fa-download"></i>
              承認待ち取引CSV出力
            </button>

            <div
              style="
                margin: var(--spacing-md) 0;
                text-align: center;
                color: var(--text-muted);
                font-size: var(--font-sm);
              "
            >
              ↓ 承認欄に「承認」記載後 ↓
            </div>

            <div class="kicho__upload-area" data-action="approval-csv-upload">
              <i class="fas fa-check-circle kicho__upload-area__icon"></i>
              <p class="kicho__upload-area__text">承認済みCSVをアップロード</p>
              <p class="kicho__upload-area__subtext">
                承認欄記載でMF送信待ちに移動
              </p>
              <input
                type="file"
                id="approvalCSVInput"
                accept=".csv"
                style="display: none"
              />
            </div>

            <!-- 一括承認機能 -->
            <div class="kicho__approval-section">
              <h4 class="kicho__approval__title">
                <i class="fas fa-check-double icon--approval"></i>
                アップロードデータを一括承認として保存
              </h4>
              <div class="kicho__approval-summary">
                <div class="kicho__summary-item">
                  <span class="kicho__summary-label">承認対象:</span>
                  <strong class="kicho__summary-value" id="approvalCount"
                    >0件</strong
                  >
                </div>
                <div class="kicho__summary-item">
                  <span class="kicho__summary-label">MF送信予定:</span>
                  <strong class="kicho__summary-value" id="mfSendCount"
                    >0件</strong
                  >
                </div>
                <div class="kicho__summary-item">
                  <span class="kicho__summary-label">エラー予測:</span>
                  <strong class="kicho__summary-value" id="errorPrediction"
                    >0件</strong
                  >
                </div>
              </div>
              <button
                class="kicho__btn kicho__btn--success kicho__btn--full"
                data-action="bulk-approve-transactions"
              >
                <i class="fas fa-check-double"></i>
                一括承認として保存・MF送信待ちに追加
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- 承認済み取引データ表示セクション -->
      <section class="kicho__approved-transactions-section">
        <h3 class="kicho__approved-transactions__title">
          <i class="fas fa-check-circle icon--approval"></i>
          承認済み取引データ（<span id="approvedTransactionsCount">3</span>件）
        </h3>
        <div
          class="kicho__approved-transactions__list"
          id="approvedTransactionsList"
        >
          <div class="kicho__approved-transaction-item" data-transaction-id="1">
            <div class="kicho__approved-transaction__info">
              <div class="kicho__approved-transaction__name">
                取引履歴_2025年1月.csv データ
              </div>
              <div class="kicho__approved-transaction__details">
                承認日: 2025-01-07 16:45 | 取引数: 45件 | 状態: MF送信済み
              </div>
            </div>
            <div class="kicho__approved-transaction__actions">
              <button
                class="kicho__btn kicho__btn--small kicho__btn--info"
                data-action="view-transaction-details"
                data-transaction-id="1"
              >
                <i class="fas fa-eye"></i>
                詳細
              </button>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-approved-transaction"
                data-transaction-id="1"
              >
                <i class="fas fa-trash"></i>
                削除
              </button>
            </div>
          </div>

          <div class="kicho__approved-transaction-item" data-transaction-id="2">
            <div class="kicho__approved-transaction__info">
              <div class="kicho__approved-transaction__name">
                経費データ_Q1.csv データ
              </div>
              <div class="kicho__approved-transaction__details">
                承認日: 2025-01-07 14:30 | 取引数: 23件 | 状態: MF送信待ち
              </div>
            </div>
            <div class="kicho__approved-transaction__actions">
              <button
                class="kicho__btn kicho__btn--small kicho__btn--info"
                data-action="view-transaction-details"
                data-transaction-id="2"
              >
                <i class="fas fa-eye"></i>
                詳細
              </button>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-approved-transaction"
                data-transaction-id="2"
              >
                <i class="fas fa-trash"></i>
                削除
              </button>
            </div>
          </div>

          <div class="kicho__approved-transaction-item" data-transaction-id="3">
            <div class="kicho__approved-transaction__info">
              <div class="kicho__approved-transaction__name">
                売上明細_202501.csv データ
              </div>
              <div class="kicho__approved-transaction__details">
                承認日: 2025-01-06 13:15 | 取引数: 67件 | 状態: MF送信済み
              </div>
            </div>
            <div class="kicho__approved-transaction__actions">
              <button
                class="kicho__btn kicho__btn--small kicho__btn--info"
                data-action="view-transaction-details"
                data-transaction-id="3"
              >
                <i class="fas fa-eye"></i>
                詳細
              </button>
              <button
                class="kicho__btn kicho__btn--small kicho__btn--danger"
                data-action="delete-approved-transaction"
                data-transaction-id="3"
              >
                <i class="fas fa-trash"></i>
                削除
              </button>
            </div>
          </div>
        </div>
      </section>

      <!-- AI学習履歴セクション（簡素化 - 日時のみ） -->
      <section class="kicho__section" id="ai-learning-history">
        <div class="kicho__section__header">
          <div>
            <h2 class="kicho__section__title">
              <i class="fas fa-clock icon--ai"></i>
              AI学習実行履歴
            </h2>
            <p class="kicho__section__subtitle">AI学習実行日時の記録のみ</p>
          </div>
          <div class="kicho__section__actions">
            <button
              class="kicho__btn kicho__btn--secondary"
              data-action="refresh-ai-history"
            >
              <i class="fas fa-sync-alt"></i>
              履歴更新
            </button>
          </div>
        </div>

        <div style="padding: var(--spacing-lg)">
          <div class="kicho__learning-history">
            <h4>
              <i class="fas fa-history"></i>
              実行履歴（日時記録）
            </h4>
            <div class="kicho__session-list" id="aiSessionList">
              <div class="kicho__session-item">
                <span class="kicho__session-datetime">2025-01-07 14:30:15</span>
                <span class="kicho__session-status--success">完了</span>
              </div>

              <div class="kicho__session-item">
                <span class="kicho__session-datetime">2025-01-07 10:15:42</span>
                <span class="kicho__session-status--success">完了</span>
              </div>

              <div class="kicho__session-item">
                <span class="kicho__session-datetime">2025-01-06 16:45:28</span>
                <span class="kicho__session-status--success">完了</span>
              </div>

              <div class="kicho__session-item">
                <span class="kicho__session-datetime">2025-01-06 09:20:11</span>
                <span class="kicho__session-status--success">完了</span>
              </div>

              <div class="kicho__session-item">
                <span class="kicho__session-datetime">2025-01-05 15:30:55</span>
                <span class="kicho__session-status--success">完了</span>
              </div>
            </div>
            <button
              class="kicho__btn kicho__btn--small kicho__btn--secondary"
              data-action="load-more-sessions"
              style="margin-top: var(--spacing-md)"
            >
              <i class="fas fa-chevron-down"></i>
              もっと読み込む
            </button>
          </div>
        </div>
      </section>

      <!-- エクスポート・送信セクション -->
      <section class="kicho__section" id="export-section">
        <div class="kicho__section__header">
          <div>
            <h2 class="kicho__section__title">
              <i class="fas fa-paper-plane icon--mf"></i>
              MFクラウド送信・エクスポート
            </h2>
            <p class="kicho__section__subtitle">
              承認済み取引のMF送信とバックアップ
            </p>
          </div>
          <div class="kicho__section__actions">
            <button
              class="kicho__btn kicho__btn--success"
              data-action="execute-full-backup"
            >
              <i class="fas fa-database"></i>
              完全バックアップ
            </button>
          </div>
        </div>

        <div class="kicho__overview-section">
          <!-- MFクラウド送信 -->
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-cloud-upload-alt icon--mf"></i>
              <h3>MFクラウド送信【履歴管理】</h3>
            </div>
            <div
              style="
                margin-bottom: var(--spacing-md);
                font-size: var(--font-sm);
                color: var(--text-muted);
              "
            >
              送信待ち: <strong>47件</strong><br />
              最終送信: <strong>2025-01-07 09:30</strong><br />
              送信モード: <strong>差分送信</strong>
            </div>

            <div class="kicho__form-group">
              <label class="kicho__form-label">送信モード</label>
              <select class="kicho__form-input" id="exportMode">
                <option value="incremental" selected>差分送信（推奨）</option>
                <option value="append">追加送信</option>
                <option value="replace">上書き送信</option>
              </select>
            </div>

            <button
              class="kicho__btn kicho__btn--primary kicho__btn--full"
              data-action="export-to-mf"
            >
              <i class="fas fa-paper-plane"></i>
              MFクラウドに送信
            </button>
          </div>

          <!-- データバックアップ（世代管理） -->
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-database icon--system"></i>
              <h3>データバックアップ【世代管理】</h3>
            </div>
            <div
              style="
                margin-bottom: var(--spacing-md);
                font-size: var(--font-sm);
                color: var(--text-muted);
              "
            >
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: var(--spacing-sm);
                  margin-bottom: var(--spacing-sm);
                "
              >
                <i
                  class="fas fa-check-circle"
                  style="color: var(--kicho-success)"
                ></i>
                <div>
                  <div style="font-weight: var(--font-medium)">
                    取引データ（完全バックアップ）
                  </div>
                  <div style="font-size: var(--font-xs)">
                    2025-01-07 03:00 自動バックアップ
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: var(--spacing-sm);
                  margin-bottom: var(--spacing-sm);
                "
              >
                <i
                  class="fas fa-check-circle"
                  style="color: var(--kicho-success)"
                ></i>
                <div>
                  <div style="font-weight: var(--font-medium)">
                    ルールデータ（JSON形式）
                  </div>
                  <div style="font-size: var(--font-xs)">
                    2025-01-07 03:00 自動バックアップ
                  </div>
                </div>
              </div>
              <div
                style="
                  display: flex;
                  align-items: center;
                  gap: var(--spacing-sm);
                "
              >
                <i
                  class="fas fa-check-circle"
                  style="color: var(--kicho-success)"
                ></i>
                <div>
                  <div style="font-weight: var(--font-medium)">AI学習履歴</div>
                  <div style="font-size: var(--font-xs)">
                    2025-01-07 03:00 自動バックアップ
                  </div>
                </div>
              </div>
            </div>

            <div class="kicho__form-group">
              <label class="kicho__form-label">バックアップ形式</label>
              <select class="kicho__form-input" id="backupFormat">
                <option value="complete" selected>
                  完全バックアップ（全データ）
                </option>
                <option value="transactions">取引データのみ</option>
                <option value="rules">ルールデータのみ</option>
                <option value="ai_history">AI学習履歴のみ</option>
              </select>
            </div>

            <button
              class="kicho__btn kicho__btn--secondary kicho__btn--full"
              data-action="create-manual-backup"
            >
              <i class="fas fa-download"></i>
              手動バックアップ実行
            </button>
          </div>

          <!-- レポート出力（拡張版） -->
          <div class="kicho__card">
            <div class="kicho__card__header">
              <i class="fas fa-chart-line icon--system"></i>
              <h3>レポート出力【拡張版】</h3>
            </div>
            <form data-form="report-generation">
              <div class="kicho__form-group">
                <label class="kicho__form-label">期間</label>
                <div
                  style="
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: var(--spacing-sm);
                  "
                >
                  <input
                    type="date"
                    class="kicho__form-input"
                    value="2025-01-01"
                    id="reportStartDate"
                  />
                  <input
                    type="date"
                    class="kicho__form-input"
                    value="2025-01-07"
                    id="reportEndDate"
                  />
                </div>
              </div>

              <div class="kicho__form-group">
                <label class="kicho__form-label">レポート種類</label>
                <select class="kicho__form-input" id="reportType">
                  <option value="monthly_summary">月次処理サマリー</option>
                  <option value="ai_accuracy">AI精度レポート</option>
                  <option value="account_summary">勘定科目別集計</option>
                  <option value="error_analysis">エラー・例外処理分析</option>
                  <option value="rule_usage">ルール使用統計</option>
                  <option value="mf_sync_history">MF連携履歴レポート</option>
                  <option value="duplicate_analysis">重複処理分析</option>
                </select>
              </div>

              <div class="kicho__form-group">
                <label class="kicho__form-label">出力形式</label>
                <select class="kicho__form-input" id="reportFormat">
                  <option value="pdf">PDF形式</option>
                  <option value="excel">Excel形式</option>
                  <option value="csv">CSV形式</option>
                  <option value="html">HTML形式</option>
                </select>
              </div>

              <button
                type="button"
                class="kicho__btn kicho__btn--success kicho__btn--full"
                data-action="generate-advanced-report"
              >
                <i class="fas fa-file-alt"></i>
                拡張レポート生成
              </button>
            </form>
          </div>
        </div>
      </section>
    </div>
  </body>
</html>
