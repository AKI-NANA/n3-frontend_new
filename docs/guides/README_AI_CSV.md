# 🚀 AI解析用CSVエクスポート - クイックスタート

## ✅ 完成！すぐに使えます

---

## 📦 作成したファイル

### 1️⃣ **すぐ試せるテスト版**
```
ai-csv-export-test.html
```
**使い方**: ブラウザで開く → ワンクリック → 動く！

### 2️⃣ **システム統合用**
```
public/js/ai-csv-export.js
```
**使い方**: HTMLに追加 → ボタン配置 → 完了！

### 3️⃣ **詳細マニュアル**
```
INTEGRATION_GUIDE.md
```
**内容**: 統合手順、トラブルシューティング、カスタマイズ方法

---

## ⚡ 3ステップで完了

### ステップ1: テストしてみる（2分）

```bash
# ブラウザでテストファイルを開く
open ai-csv-export-test.html
```

1. 商品をチェック ☑☑☑
2. 「🤖 AI解析用」をクリック
3. Claude Desktopで Cmd + V

→ **動作確認完了！**

---

### ステップ2: システムに統合（5分）

**2-1. JavaScriptを追加**

既存のHTMLファイルに追加:

```html
<script src="public/js/ai-csv-export.js"></script>
</body>
```

**2-2. ボタンを配置**

ツールバーに追加:

```html
<button 
    id="ai-csv-export" 
    class="btn btn-purple"
    onclick="exportForAI()"
>
    🤖 AI解析用
</button>
```

→ **統合完了！**

---

### ステップ3: 実際に使う

1. **商品を選択**
   - チェックボックスで複数選択可能

2. **ワンクリック**
   - 「🤖 AI解析用」ボタン

3. **Claude Desktopで実行**
   - Cmd + V で貼り付け
   - Enter押す
   - 5分で完了

→ **HTSコード自動判定完了！**

---

## 🎯 エクスポートされるデータ

```csv
SKU,商品名,英語タイトル,価格(円),カテゴリ名,カテゴリID,...
NF5CA8F114-AF7!,"【大量出品中 正露品】ポケモン","Pokemon Card Gengar VMAX",3500,"CCG Individual",183454,...
```

**+** **Claude用の詳細プロンプト**
- HTSコード判定手順
- 原産国判定ルール
- データベース更新SQL
- 処理完了レポート形式

---

## 💡 使用例

### 例1: 5件の商品を一括処理

```
1. 商品5件をチェック
2. 「🤖 AI解析用」クリック
3. Claude Desktopで実行

結果:
✅ 5件すべてHTSコード判定完了
✅ 平均確信度: 95%
✅ 関税率: 0% - 6.5%
```

### 例2: カテゴリごとに処理

```
トレーディングカード: 10件
→ HTSコード: 9504.40.0000
→ 関税率: 0%

フィギュア: 8件
→ HTSコード: 9503.00.0080
→ 関税率: 0%
```

---

## 📊 Claude Desktopが実行すること

### 自動処理内容

1. **HTSコード検索**
   - hs_codesテーブルで検索
   - カテゴリ・商品名から判定
   - 確信度を計算（0-100%）

2. **原産国判定**
   - ブランド名から判定
   - 日本/中国/アメリカ等

3. **関税率取得**
   - customs_dutiesテーブルから
   - HTSコード + 原産国で検索

4. **データベース更新**
   ```sql
   UPDATE products
   SET listing_data = listing_data || '{
     "hts_code": "9504.40.0000",
     "duty_rate": 0.0000,
     ...
   }'::jsonb
   WHERE sku = 'XXX';
   ```

5. **処理レポート生成**
   - 成功/失敗件数
   - 確信度分布
   - 関税率統計
   - 要確認商品リスト

---

## ⚠️ 重要：精度について

### 確信度の目安

- **90-100%**: 高確信 ✅ → そのまま使える
- **80-89%**: 中確信 ⚠️ → ダブルチェック推奨
- **80%未満**: 低確信 ❌ → 必ず人間が確認

### 確認が必要なケース

❌ **カテゴリ情報がない**
→ 手動で確認

❌ **画像URLがない**
→ 精度が下がる可能性

❌ **新しい商品タイプ**
→ HTSコードが見つからない場合

---

## 🔧 カスタマイズ

### テーブル構造が違う場合

`public/js/ai-csv-export.js` の列番号を調整:

```javascript
const product = {
    sku: cells[X]?.textContent?.trim(),  // X = SKU列番号
    title: cells[Y]?.textContent?.trim(), // Y = 商品名列番号
    // ...
};
```

### プロンプトを変更したい場合

`generateClaudePrompt()` 関数を編集

---

## 📞 問題が起きたら

### よくある問題

**Q1: ボタンが表示されない**
→ ブラウザキャッシュをクリア（Cmd + Shift + R）

**Q2: クリックしても反応しない**
→ F12でコンソール確認、エラーメッセージを見る

**Q3: データが正しくない**
→ 列番号を確認・調整

詳細は `INTEGRATION_GUIDE.md` 参照

---

## 🎉 完成！

すべて準備完了です。

### 今すぐテスト

```bash
open ai-csv-export-test.html
```

### システムに統合

```
INTEGRATION_GUIDE.md を参照
```

---

**Happy Exporting! 🚀**
