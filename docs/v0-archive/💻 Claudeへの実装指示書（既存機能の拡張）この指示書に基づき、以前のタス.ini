💻 Claudeへの実装指示書（既存機能の拡張）この指示書に基づき、以前のタスク（AIリサーチのマルチプロンプト化）と今回のタスク（カテゴリーのバリエーション対応フラグ）のコードを、プロジェクトに組み込み、動作可能にしてください。1. 📂 ファイルの格納と修正（最優先）以下のファイルパスに、提供されたコードを新規作成または既存ファイルに追記・修正してください。ファイルパス修正/新規目的database/migrations/002_add_variation_support_to_ebay_categories.sql🆕 新規ebay_categoriesテーブルにsupports_variationsカラムを追加するSQLマイグレーションを実行する。/types/product.ts🔄 修正ResearchPromptTypeとEbayCategory型にsupports_variationsプロパティを追記する。/lib/gemini-api.ts🆕 新規マルチプロンプト実行のためのgenerateResearchPrompt関数を実装する。/lib/ebay-api.ts🔄 修正eBay APIを呼び出すcheckCategorySupportsVariations関数を追記する。/components/ProductModal/components/Tabs/TabData.tsx🔄 修正詳細モーダルのボタン群を、AIリサーチのドロップダウンメニューに置き換える。/app/api/gemini/run-prompt/route.ts🆕 新規AIリサーチ実行のAPIルートを実装し、プロンプトタイプに応じて処理を振り分ける。/app/api/products/[id]/get-details-and-update-category/route.ts🆕 新規詳細取得APIに連動し、カテゴリーのバリエーション対応フラグをDBに保存する。/app/api/ebay/variation-categories/route.ts🆕 新規バリエーション対応カテゴリーのみをUIに返すAPIを実装する。2. 🔗 依存関係と連携の確立インポートパスの確認: すべてのファイルで、@/types/product、@/lib/gemini-api、@/lib/ebay-api、@/lib/supabase などのインポートパスが正しく解決されているか確認し、必要に応じて修正してください。既存APIへの統合（重要）:/app/api/products/[id]/get-details-and-update-category/route.ts の処理が、既存の「3 詳細取得」ボタンのAPIの成功直後に呼び出されるように、フロントエンド側のロジック（TabData.tsxなど）を調整してください。3. 🚀 次のタスク（残タスク）この機能拡張を完全に動作させるため、以下のモックではない実装を進めてください。AIクライアント実装: /lib/gemini-api.ts でモックになっているGemini Vision APIやClaude MCPの呼び出しクライアントを、実際の外部サービスと連携するように実装する。DB更新ロジック: /app/api/gemini/run-prompt/route.ts において、AIから返されたJSON結果をパースし、products_master テーブルに正確に書き戻すロジックを実装する。✨ 追加される機能概要この一連の修正により、データ編集フローに以下の重要な機能が追加されます。1. 🤖 AIリサーチの高度化（マルチプロンプト）機能: 商品詳細モーダル（http://localhost:3000/tools/editing）のAI自動化フローに、単なる「市場調査」ではなく、目的別のAIリサーチを選択できるドロップダウンボタンが追加されます。効果: ユーザーは「画像からの最安値リサーチ」や「出品必須データのみ取得」など、具体的なタスクをAIに指示できるようになり、リサーチの精度と効率が大幅に向上します。2. 🏷️ カテゴリーのバリエーション対応フラグ管理機能: 「3 詳細取得」ボタンを押した際、確定したeBayカテゴリーIDについてバリエーション出品が可能かをeBay APIを通じて自動でチェックし、その結果（supports_variations）をDBに保存します。効果:データ精度: どのカテゴリーでセット品/バリエーションを作成できるかをシステムが把握できます。将来的な連携: 今後のバリエーション作成ツール（以前のタスク）で、「バリエーション対応可能なカテゴリー」に属するアイテムのみをリストアップするフィルタリング機能の実装が可能になります。